/*
 GNU Lesser General Public License: http://creativecommons.org/licenses/LGPL/2.1/
 @version 1.0.1
 2009/02/24
*/
var JSON;JSON||(JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var e,h,x,B,F=g,w,D=d[a];D&&("object"===typeof D&&"function"===typeof D.toJSON)&&(D=D.toJSON(a));"function"===typeof k&&(D=k.call(d,a,D));switch(typeof D){case "string":return b(D);case "number":return isFinite(D)?String(D):"null";case "boolean":case "null":return String(D);case "object":if(!D)return"null";
g+=i;w=[];if("[object Array]"===Object.prototype.toString.apply(D)){B=D.length;for(e=0;e<B;e+=1)w[e]=c(e,D)||"null";x=0===w.length?"[]":g?"[\n"+g+w.join(",\n"+g)+"\n"+F+"]":"["+w.join(",")+"]";g=F;return x}if(k&&"object"===typeof k){B=k.length;for(e=0;e<B;e+=1)"string"===typeof k[e]&&(h=k[e],(x=c(h,D))&&w.push(b(h)+(g?": ":":")+x))}else for(h in D)Object.prototype.hasOwnProperty.call(D,h)&&(x=c(h,D))&&w.push(b(h)+(g?": ":":")+x);x=0===w.length?"{}":g?"{\n"+g+w.join(",\n"+g)+"\n"+F+"}":"{"+w.join(",")+
"}";g=F;return x}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,i,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,d){var e;i=g="";if("number"===typeof d)for(e=0;e<d;e+=1)i+=" ";else"string"===typeof d&&(i=d);if((k=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function c(a,d){var e,h,g=a[d];if(g&&"object"===typeof g)for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&(h=c(g,e),void 0!==h?g[e]=h:delete g[e]);return b.call(a,d,g)}var e,a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");})})();
(function(a,b){function c(j){return f.isWindow(j)?j:9===j.nodeType?j.defaultView||j.parentWindow:!1}function d(j){if(!Xa[j]){var a=q.body,b=f("<"+j+">").appendTo(a),c=b.css("display");b.remove();if("none"===c||""===c){Z||(Z=q.createElement("iframe"),Z.frameBorder=Z.width=Z.height=0);a.appendChild(Z);if(!ja||!Z.createElement)ja=(Z.contentWindow||Z.contentDocument).document,ja.write(("CSS1Compat"===q.compatMode?"<!doctype html>":"")+"<html><body>"),ja.close();b=ja.createElement(j);ja.body.appendChild(b);
c=f.css(b,"display");a.removeChild(Z)}Xa[j]=c}return Xa[j]}function e(j,a){var b={};f.each(pb.concat.apply([],pb.slice(0,a)),function(){b[this]=j});return b}function g(){Ca=b}function i(){setTimeout(g,0);return Ca=f.now()}function h(){try{return new a.XMLHttpRequest}catch(j){}}function k(j,a,b,c){if(f.isArray(a))f.each(a,function(a,G){b||Xb.test(j)?c(j,G):k(j+"["+("object"==typeof G||f.isArray(G)?a:"")+"]",G,b,c)});else if(!b&&null!=a&&"object"==typeof a)for(var d in a)k(j+"["+d+"]",a[d],b,c);else c(j,
a)}function m(j,a){var L,c,d=f.ajaxSettings.flatOptions||{};for(L in a)a[L]!==b&&((d[L]?j:c||(c={}))[L]=a[L]);c&&f.extend(!0,j,c)}function n(j,a,L,f,c,d){c=c||a.dataTypes[0];d=d||{};d[c]=!0;for(var c=j[c],e=0,h=c?c.length:0,g=j===Ya,i;e<h&&(g||!i);e++)i=c[e](a,L,f),"string"==typeof i&&(!g||d[i]?i=b:(a.dataTypes.unshift(i),i=n(j,a,L,f,i,d)));(g||!i)&&!d["*"]&&(i=n(j,a,L,f,"*",d));return i}function s(j){return function(a,b){"string"!=typeof a&&(b=a,a="*");if(f.isFunction(b))for(var c=a.toLowerCase().split(qb),
d=0,e=c.length,h,g;d<e;d++)h=c[d],(g=/^\+/.test(h))&&(h=h.substr(1)||"*"),h=j[h]=j[h]||[],h[g?"unshift":"push"](b)}}function u(j,a,b){var c="width"===a?j.offsetWidth:j.offsetHeight,d="width"===a?Yb:Zb;if(0<c)return"border"!==b&&f.each(d,function(){b||(c-=parseFloat(f.css(j,"padding"+this))||0);"margin"===b?c+=parseFloat(f.css(j,b+this))||0:c-=parseFloat(f.css(j,"border"+this+"Width"))||0}),c+"px";c=ka(j,a,a);if(0>c||null==c)c=j.style[a]||0;c=parseFloat(c)||0;b&&f.each(d,function(){c+=parseFloat(f.css(j,
"padding"+this))||0;"padding"!==b&&(c+=parseFloat(f.css(j,"border"+this+"Width"))||0);"margin"===b&&(c+=parseFloat(f.css(j,b+this))||0)});return c+"px"}function x(j,a){a.src?f.ajax({url:a.src,async:!1,dataType:"script"}):f.globalEval((a.text||a.textContent||a.innerHTML||"").replace($b,"/*$0*/"));a.parentNode&&a.parentNode.removeChild(a)}function B(j){f.nodeName(j,"input")?F(j):"getElementsByTagName"in j&&f.grep(j.getElementsByTagName("input"),F)}function F(j){if("checkbox"===j.type||"radio"===j.type)j.defaultChecked=
j.checked}function w(j){return"getElementsByTagName"in j?j.getElementsByTagName("*"):"querySelectorAll"in j?j.querySelectorAll("*"):[]}function D(j,a){var b;if(1===a.nodeType){a.clearAttributes&&a.clearAttributes();a.mergeAttributes&&a.mergeAttributes(j);b=a.nodeName.toLowerCase();if("object"===b)a.outerHTML=j.outerHTML;else if("input"!==b||"checkbox"!==j.type&&"radio"!==j.type)if("option"===b)a.selected=j.defaultSelected;else{if("input"===b||"textarea"===b)a.defaultValue=j.defaultValue}else j.checked&&
(a.defaultChecked=a.checked=j.checked),a.value!==j.value&&(a.value=j.value);a.removeAttribute(f.expando)}}function K(j,a){if(1===a.nodeType&&f.hasData(j)){var b=f.expando,c=f.data(j),d=f.data(a,c);if(c=c[b]){var e=c.events,d=d[b]=f.extend({},c);if(e){delete d.handle;d.events={};for(var h in e){b=0;for(c=e[h].length;b<c;b++)f.event.add(a,h+(e[h][b].namespace?".":"")+e[h][b].namespace,e[h][b],e[h][b].data)}}}}}function O(j,a,b){a=a||0;if(f.isFunction(a))return f.grep(j,function(j,c){return!!a.call(j,
c,j)===b});if(a.nodeType)return f.grep(j,function(j){return j===a===b});if("string"==typeof a){var c=f.grep(j,function(j){return 1===j.nodeType});if(ac.test(a))return f.filter(a,c,!b);a=f.filter(a,c)}return f.grep(j,function(j){return 0<=f.inArray(j,a)===b})}function Q(j,a){return(j&&"*"!==j?j+".":"")+a.replace(bc,"`").replace(cc,"&")}function N(j){var a,b,c,d,e,h,g,i,k,m,p,A=[];d=[];e=f._data(this,"events");if(!(j.liveFired===this||!e||!e.live||j.target.disabled||j.button&&"click"===j.type)){j.namespace&&
(p=RegExp("(^|\\.)"+j.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)"));j.liveFired=this;var v=e.live.slice(0);for(g=0;g<v.length;g++)e=v[g],e.origType.replace(Za,"")===j.type?d.push(e.selector):v.splice(g--,1);d=f(j.target).closest(d,j.currentTarget);i=0;for(k=d.length;i<k;i++){m=d[i];for(g=0;g<v.length;g++)if(e=v[g],m.selector===e.selector&&(!p||p.test(e.namespace))&&!m.elem.disabled){h=m.elem;c=null;if("mouseenter"===e.preType||"mouseleave"===e.preType)j.type=e.preType,(c=f(j.relatedTarget).closest(e.selector)[0])&&
f.contains(h,c)&&(c=h);(!c||c!==h)&&A.push({elem:h,handleObj:e,level:m.level})}}i=0;for(k=A.length;i<k;i++){d=A[i];if(b&&d.level>b)break;j.currentTarget=d.elem;j.data=d.handleObj.data;j.handleObj=d.handleObj;p=d.handleObj.origHandler.apply(d.elem,arguments);if(!1===p||j.isPropagationStopped())if(b=d.level,!1===p&&(a=!1),j.isImmediatePropagationStopped())break}return a}}function R(j,a,c){var d=f.extend({},c[0]);d.type=j;d.originalEvent={};d.liveFired=b;f.event.handle.call(a,d);d.isDefaultPrevented()&&
c[0].preventDefault()}function M(){return!0}function H(){return!1}function S(j,a,c){var d=a+"defer",e=a+"queue",h=a+"mark",g=f.data(j,d,b,!0);g&&("queue"===c||!f.data(j,e,b,!0))&&("mark"===c||!f.data(j,h,b,!0))&&setTimeout(function(){!f.data(j,e,b,!0)&&!f.data(j,h,b,!0)&&(f.removeData(j,d,!0),g.resolve())},0)}function T(j){for(var a in j)if("toJSON"!==a)return!1;return!0}function y(j,a,c){if(c===b&&1===j.nodeType)if(c="data-"+a.replace(dc,"-$1").toLowerCase(),c=j.getAttribute(c),"string"==typeof c){try{c=
"true"===c?!0:"false"===c?!1:"null"===c?null:f.isNaN(c)?ec.test(c)?f.parseJSON(c):c:parseFloat(c)}catch(d){}f.data(j,a,c)}else c=b;return c}var q=a.document,P=a.location,f,v=function(){if(!t.isReady){try{q.documentElement.doScroll("left")}catch(j){setTimeout(v,1);return}t.ready()}},t=function(j,a){return new t.fn.init(j,a,U)},ta=a.jQuery,la=a.$,U,Da=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,ca=/\S/,A=/^\s+/,J=/\s+$/,p=/\d/,aa=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,ba=/^[\],:{}\s]*$/,da=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,
fc=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,gc=/(?:^|:|,)(?:\s*\[)+/g,hc=/(webkit)[ \/]([\w.]+)/,ic=/(opera)(?:.*version)?[ \/]([\w.]+)/,jc=/(msie) ([\w.]+)/,kc=/(mozilla)(?:.*? rv:([\w.]+))?/,lc=/-([a-z]|[0-9])/ig,mc=/^-ms-/,nc=function(j,a){return(a+"").toUpperCase()},oc=a.navigator.userAgent,Ea,Fa,ma,pc=Object.prototype.toString,$a=Object.prototype.hasOwnProperty,ab=Array.prototype.push,va=Array.prototype.slice,rb=String.prototype.trim,sb=Array.prototype.indexOf,tb={};
t.fn=t.prototype={constructor:t,init:function(j,a,c){var f,d;if(!j)return this;if(j.nodeType)return this.context=this[0]=j,this.length=1,this;if("body"===j&&!a&&q.body)return this.context=q,this[0]=q.body,this.selector=j,this.length=1,this;if("string"==typeof j){"<"!==j.charAt(0)||">"!==j.charAt(j.length-1)||3>j.length?f=Da.exec(j):f=[null,j,null];if(f&&(f[1]||!a)){if(f[1])return d=(a=a instanceof t?a[0]:a)?a.ownerDocument||a:q,(c=aa.exec(j))?t.isPlainObject(a)?(j=[q.createElement(c[1])],t.fn.attr.call(j,
a,!0)):j=[d.createElement(c[1])]:(c=t.buildFragment([f[1]],[d]),j=(c.cacheable?t.clone(c.fragment):c.fragment).childNodes),t.merge(this,j);if((a=q.getElementById(f[2]))&&a.parentNode){if(a.id!==f[2])return c.find(j);this.length=1;this[0]=a}this.context=q;this.selector=j;return this}return!a||a.jquery?(a||c).find(j):this.constructor(a).find(j)}if(t.isFunction(j))return c.ready(j);j.selector!==b&&(this.selector=j.selector,this.context=j.context);return t.makeArray(j,this)},selector:"",jquery:"1.6.4",
length:0,size:function(){return this.length},toArray:function(){return va.call(this,0)},get:function(j){return null==j?this.toArray():0>j?this[this.length+j]:this[j]},pushStack:function(j,a,b){var c=this.constructor();t.isArray(j)?ab.apply(c,j):t.merge(c,j);c.prevObject=this;c.context=this.context;"find"===a?c.selector=this.selector+(this.selector?" ":"")+b:a&&(c.selector=this.selector+"."+a+"("+b+")");return c},each:function(j,a){return t.each(this,j,a)},ready:function(j){t.bindReady();Fa.done(j);
return this},eq:function(j){return-1===j?this.slice(j):this.slice(j,+j+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(va.apply(this,arguments),"slice",va.call(arguments).join(","))},map:function(j){return this.pushStack(t.map(this,function(a,b){return j.call(a,b,a)}))},end:function(){return this.prevObject||this.constructor(null)},push:ab,sort:[].sort,splice:[].splice};t.fn.init.prototype=t.fn;t.extend=t.fn.extend=function(){var j,
a,c,f,d,e,h=arguments[0]||{},g=1,i=arguments.length,k=!1;"boolean"==typeof h&&(k=h,h=arguments[1]||{},g=2);"object"!=typeof h&&!t.isFunction(h)&&(h={});for(i===g&&(h=this,--g);g<i;g++)if(null!=(j=arguments[g]))for(a in j)c=h[a],f=j[a],h!==f&&(k&&f&&(t.isPlainObject(f)||(d=t.isArray(f)))?(d?(d=!1,e=c&&t.isArray(c)?c:[]):e=c&&t.isPlainObject(c)?c:{},h[a]=t.extend(k,e,f)):f!==b&&(h[a]=f));return h};t.extend({noConflict:function(j){a.$===t&&(a.$=la);j&&a.jQuery===t&&(a.jQuery=ta);return t},isReady:!1,
readyWait:1,holdReady:function(j){j?t.readyWait++:t.ready(!0)},ready:function(j){if(!0===j&&!--t.readyWait||!0!==j&&!t.isReady){if(!q.body)return setTimeout(t.ready,1);t.isReady=!0;!0!==j&&0<--t.readyWait||(Fa.resolveWith(q,[t]),t.fn.trigger&&t(q).trigger("ready").unbind("ready"))}},bindReady:function(){if(!Fa){Fa=t._Deferred();if("complete"===q.readyState)return setTimeout(t.ready,1);if(q.addEventListener)q.addEventListener("DOMContentLoaded",ma,!1),a.addEventListener("load",t.ready,!1);else if(q.attachEvent){q.attachEvent("onreadystatechange",
ma);a.attachEvent("onload",t.ready);var j=!1;try{j=null==a.frameElement}catch(b){}q.documentElement.doScroll&&j&&v()}}},isFunction:function(j){return"function"===t.type(j)},isArray:Array.isArray||function(j){return"array"===t.type(j)},isWindow:function(j){return j&&"object"==typeof j&&"setInterval"in j},isNaN:function(j){return null==j||!p.test(j)||isNaN(j)},type:function(j){return null==j?String(j):tb[pc.call(j)]||"object"},isPlainObject:function(j){if(!j||"object"!==t.type(j)||j.nodeType||t.isWindow(j))return!1;
try{if(j.constructor&&!$a.call(j,"constructor")&&!$a.call(j.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}for(var c in j);return c===b||$a.call(j,c)},isEmptyObject:function(j){for(var a in j)return!1;return!0},error:function(j){throw j;},parseJSON:function(j){if("string"!=typeof j||!j)return null;j=t.trim(j);if(a.JSON&&a.JSON.parse)return a.JSON.parse(j);if(ba.test(j.replace(da,"@").replace(fc,"]").replace(gc,"")))return(new Function("return "+j))();t.error("Invalid JSON: "+j)},
parseXML:function(j){var G,c;try{a.DOMParser?(c=new DOMParser,G=c.parseFromString(j,"text/xml")):(G=new ActiveXObject("Microsoft.XMLDOM"),G.async="false",G.loadXML(j))}catch(f){G=b}(!G||!G.documentElement||G.getElementsByTagName("parsererror").length)&&t.error("Invalid XML: "+j);return G},noop:function(){},globalEval:function(j){j&&ca.test(j)&&(a.execScript||function(j){a.eval.call(a,j)})(j)},camelCase:function(j){return j.replace(mc,"ms-").replace(lc,nc)},nodeName:function(j,a){return j.nodeName&&
j.nodeName.toUpperCase()===a.toUpperCase()},each:function(j,a,c){var f,d=0,e=j.length,h=e===b||t.isFunction(j);if(c)if(h)for(f in j){if(!1===a.apply(j[f],c))break}else for(;d<e&&!1!==a.apply(j[d++],c););else if(h)for(f in j){if(!1===a.call(j[f],f,j[f]))break}else for(;d<e&&!1!==a.call(j[d],d,j[d++]););return j},trim:rb?function(j){return null==j?"":rb.call(j)}:function(j){return null==j?"":(j+"").replace(A,"").replace(J,"")},makeArray:function(j,a){var b=a||[];if(null!=j){var c=t.type(j);null==j.length||
"string"===c||"function"===c||"regexp"===c||t.isWindow(j)?ab.call(b,j):t.merge(b,j)}return b},inArray:function(j,a){if(!a)return-1;if(sb)return sb.call(a,j);for(var b=0,c=a.length;b<c;b++)if(a[b]===j)return b;return-1},merge:function(j,a){var c=j.length,f=0;if("number"==typeof a.length)for(var d=a.length;f<d;f++)j[c++]=a[f];else for(;a[f]!==b;)j[c++]=a[f++];j.length=c;return j},grep:function(a,b,c){for(var f=[],d,c=!!c,e=0,h=a.length;e<h;e++)d=!!b(a[e],e),c!==d&&f.push(a[e]);return f},map:function(a,
G,c){var f,d,e=[],h=0,g=a.length;if(a instanceof t||g!==b&&"number"==typeof g&&(0<g&&a[0]&&a[g-1]||0===g||t.isArray(a)))for(;h<g;h++)f=G(a[h],h,c),null!=f&&(e[e.length]=f);else for(d in a)f=G(a[d],d,c),null!=f&&(e[e.length]=f);return e.concat.apply([],e)},guid:1,proxy:function(a,G){if("string"==typeof G)var c=a[G],G=a,a=c;if(!t.isFunction(a))return b;var f=va.call(arguments,2),c=function(){return a.apply(G,f.concat(va.call(arguments)))};c.guid=a.guid=a.guid||c.guid||t.guid++;return c},access:function(a,
G,c,f,d,e){var h=a.length;if("object"==typeof G){for(var g in G)t.access(a,g,G[g],f,d,c);return a}if(c!==b){f=!e&&f&&t.isFunction(c);for(g=0;g<h;g++)d(a[g],G,f?c.call(a[g],g,d(a[g],G)):c,e);return a}return h?d(a[0],G):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();a=hc.exec(a)||ic.exec(a)||jc.exec(a)||0>a.indexOf("compatible")&&kc.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},sub:function(){function a(b,G){return new a.fn.init(b,G)}t.extend(!0,a,this);
a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(c,f){f&&f instanceof t&&!(f instanceof a)&&(f=a(f));return t.fn.init.call(this,c,f,b)};a.fn.init.prototype=a.fn;var b=a(q);return a},browser:{}});t.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){tb["[object "+b+"]"]=b.toLowerCase()});Ea=t.uaMatch(oc);Ea.browser&&(t.browser[Ea.browser]=!0,t.browser.version=Ea.version);t.browser.webkit&&(t.browser.safari=!0);ca.test("\u00a0")&&
(A=/^[\s\xA0]+/,J=/[\s\xA0]+$/);U=t(q);q.addEventListener?ma=function(){q.removeEventListener("DOMContentLoaded",ma,!1);t.ready()}:q.attachEvent&&(ma=function(){"complete"===q.readyState&&(q.detachEvent("onreadystatechange",ma),t.ready())});f=t;var bb="done fail isResolved isRejected promise then always pipe".split(" "),ub=[].slice;f.extend({_Deferred:function(){var a=[],b,c,d,e={done:function(){if(!d){var c=arguments,L,h,g,i,k;b&&(k=b,b=0);L=0;for(h=c.length;L<h;L++)g=c[L],i=f.type(g),"array"===
i?e.done.apply(e,g):"function"===i&&a.push(g);k&&e.resolveWith(k[0],k[1])}return this},resolveWith:function(f,e){if(!d&&!b&&!c){e=e||[];c=1;try{for(;a[0];)a.shift().apply(f,e)}finally{b=[f,e],c=0}}return this},resolve:function(){e.resolveWith(this,arguments);return this},isResolved:function(){return!!c||!!b},cancel:function(){d=1;a=[];return this}};return e},Deferred:function(a){var b=f._Deferred(),c=f._Deferred(),d;f.extend(b,{then:function(a,j){b.done(a).fail(j);return this},always:function(){return b.done.apply(b,
arguments).fail.apply(this,arguments)},fail:c.done,rejectWith:c.resolveWith,reject:c.resolve,isRejected:c.isResolved,pipe:function(a,j){return f.Deferred(function(c){f.each({done:[a,"resolve"],fail:[j,"reject"]},function(a,j){var d=j[0],e=j[1],L;f.isFunction(d)?b[a](function(){(L=d.apply(this,arguments))&&f.isFunction(L.promise)?L.promise().then(c.resolve,c.reject):c[e+"With"](this===b?c:this,[L])}):b[a](c[e])})}).promise()},promise:function(a){if(null==a){if(d)return d;d=a={}}for(var j=bb.length;j--;)a[bb[j]]=
b[bb[j]];return a}});b.done(c.cancel).fail(b.cancel);delete b.cancel;a&&a.call(b,b);return b},when:function(a){function b(a){return function(j){c[a]=1<arguments.length?ub.call(arguments,0):j;--h||g.resolveWith(g,ub.call(c,0))}}var c=arguments,d=0,e=c.length,h=e,g=1>=e&&a&&f.isFunction(a.promise)?a:f.Deferred();if(1<e){for(;d<e;d++)c[d]&&f.isFunction(c[d].promise)?c[d].promise().then(b(d),g.reject):--h;h||g.resolveWith(g,c)}else g!==a&&g.resolveWith(g,e?[a]:[]);return g.promise()}});var qc=f,cb;var I=
q.createElement("div"),rc=q.documentElement,db,na,Ga,Ha,X,oa,V,Ia,wa,Ja,ea,Ka,xa,La,pa,ya;I.setAttribute("className","t");I.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";db=I.getElementsByTagName("*");na=I.getElementsByTagName("a")[0];if(!db||!db.length||!na)cb={};else{Ga=q.createElement("select");Ha=Ga.appendChild(q.createElement("option"));X=I.getElementsByTagName("input")[0];V={leadingWhitespace:3===I.firstChild.nodeType,
tbody:!I.getElementsByTagName("tbody").length,htmlSerialize:!!I.getElementsByTagName("link").length,style:/top/.test(na.getAttribute("style")),hrefNormalized:"/a"===na.getAttribute("href"),opacity:/^0.55$/.test(na.style.opacity),cssFloat:!!na.style.cssFloat,checkOn:"on"===X.value,optSelected:Ha.selected,getSetAttribute:"t"!==I.className,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0};X.checked=
!0;V.noCloneChecked=X.cloneNode(!0).checked;Ga.disabled=!0;V.optDisabled=!Ha.disabled;try{delete I.test}catch(cd){V.deleteExpando=!1}!I.addEventListener&&I.attachEvent&&I.fireEvent&&(I.attachEvent("onclick",function(){V.noCloneEvent=!1}),I.cloneNode(!0).fireEvent("onclick"));X=q.createElement("input");X.value="t";X.setAttribute("type","radio");V.radioValue="t"===X.value;X.setAttribute("checked","checked");I.appendChild(X);Ia=q.createDocumentFragment();Ia.appendChild(I.firstChild);V.checkClone=Ia.cloneNode(!0).cloneNode(!0).lastChild.checked;
I.innerHTML="";I.style.width=I.style.paddingLeft="1px";wa=q.getElementsByTagName("body")[0];ea=q.createElement(wa?"div":"body");Ka={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};wa&&f.extend(Ka,{position:"absolute",left:"-1000px",top:"-1000px"});for(pa in Ka)ea.style[pa]=Ka[pa];ea.appendChild(I);Ja=wa||rc;Ja.insertBefore(ea,Ja.firstChild);V.appendChecked=X.checked;V.boxModel=2===I.offsetWidth;"zoom"in I.style&&(I.style.display="inline",I.style.zoom=1,V.inlineBlockNeedsLayout=
2===I.offsetWidth,I.style.display="",I.innerHTML="<div style='width:4px;'></div>",V.shrinkWrapBlocks=2!==I.offsetWidth);I.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";xa=I.getElementsByTagName("td");ya=0===xa[0].offsetHeight;xa[0].style.display="";xa[1].style.display="none";V.reliableHiddenOffsets=ya&&0===xa[0].offsetHeight;I.innerHTML="";q.defaultView&&q.defaultView.getComputedStyle&&(oa=q.createElement("div"),oa.style.width="0",oa.style.marginRight=
"0",I.appendChild(oa),V.reliableMarginRight=0===(parseInt((q.defaultView.getComputedStyle(oa,null)||{marginRight:0}).marginRight,10)||0));ea.innerHTML="";Ja.removeChild(ea);if(I.attachEvent)for(pa in{submit:1,change:1,focusin:1})La="on"+pa,(ya=La in I)||(I.setAttribute(La,"return;"),ya="function"==typeof I[La]),V[pa+"Bubbles"]=ya;ea=Ia=Ga=Ha=wa=oa=I=X=null;cb=V}qc.support=cb;f.boxModel=f.support.boxModel;var ec=/^(?:\{.*\}|\[.*\])$/,dc=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+
Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!T(a)},data:function(a,G,c,d){if(f.acceptData(a)){var e,h=f.expando,g="string"==typeof G,i=a.nodeType,k=i?f.cache:a,m=i?a[f.expando]:a[f.expando]&&f.expando;if(m&&(!d||!m||!k[m]||k[m][h])||!(g&&c===b)){m||(i?a[f.expando]=m=++f.uuid:m=f.expando);k[m]||(k[m]={},i||(k[m].toJSON=f.noop));if("object"==typeof G||"function"==
typeof G)d?k[m][h]=f.extend(k[m][h],G):k[m]=f.extend(k[m],G);a=k[m];d&&(a[h]||(a[h]={}),a=a[h]);c!==b&&(a[f.camelCase(G)]=c);if("events"===G&&!a[G])return a[h]&&a[h].events;g?(e=a[G],null==e&&(e=a[f.camelCase(G)])):e=a;return e}}},removeData:function(a,b,c){if(f.acceptData(a)){var d,e=f.expando,h=a.nodeType,g=h?f.cache:a,i=h?a[f.expando]:f.expando;if(g[i]){if(b&&(d=c?g[i][e]:g[i]))if(d[b]||(b=f.camelCase(b)),delete d[b],!T(d))return;if(c&&(delete g[i][e],!T(g[i])))return;b=g[i][e];f.support.deleteExpando||
!g.setInterval?delete g[i]:g[i]=null;b?(g[i]={},h||(g[i].toJSON=f.noop),g[i][e]=b):h&&(f.support.deleteExpando?delete a[f.expando]:a.removeAttribute?a.removeAttribute(f.expando):a[f.expando]=null)}}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return!0!==b&&a.getAttribute("classid")===b}return!0}});f.fn.extend({data:function(a,c){var d=null;if("undefined"==typeof a){if(this.length&&(d=f.data(this[0]),1===this[0].nodeType))for(var e=
this[0].attributes,h,g=0,i=e.length;g<i;g++)h=e[g].name,0===h.indexOf("data-")&&(h=f.camelCase(h.substring(5)),y(this[0],h,d[h]));return d}if("object"==typeof a)return this.each(function(){f.data(this,a)});var k=a.split(".");k[1]=k[1]?"."+k[1]:"";return c===b?(d=this.triggerHandler("getData"+k[1]+"!",[k[0]]),d===b&&this.length&&(d=f.data(this[0],a),d=y(this[0],a,d)),d===b&&k[1]?this.data(k[0]):d):this.each(function(){var b=f(this),d=[k[0],c];b.triggerHandler("setData"+k[1]+"!",d);f.data(this,a,c);
b.triggerHandler("changeData"+k[1]+"!",d)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}});f.extend({_mark:function(a,c){a&&(c=(c||"fx")+"mark",f.data(a,c,(f.data(a,c,b,!0)||0)+1,!0))},_unmark:function(a,c,d){!0!==a&&(d=c,c=a,a=!1);if(c){var d=d||"fx",e=d+"mark";(a=a?0:(f.data(c,e,b,!0)||1)-1)?f.data(c,e,a,!0):(f.removeData(c,e,!0),S(c,d,"mark"))}},queue:function(a,c,d){if(a){var c=(c||"fx")+"queue",e=f.data(a,c,b,!0);d&&(!e||f.isArray(d)?e=f.data(a,c,f.makeArray(d),
!0):e.push(d));return e||[]}},dequeue:function(a,b){var b=b||"fx",c=f.queue(a,b),d=c.shift();"inprogress"===d&&(d=c.shift());d&&("fx"===b&&c.unshift("inprogress"),d.call(a,function(){f.dequeue(a,b)}));c.length||(f.removeData(a,b+"queue",!0),S(a,b,"queue"))}});f.fn.extend({queue:function(a,c){"string"!=typeof a&&(c=a,a="fx");return c===b?f.queue(this[0],a):this.each(function(){var b=f.queue(this,a,c);"fx"===a&&"inprogress"!==b[0]&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,
a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a;b=b||"fx";return this.queue(b,function(){var c=this;setTimeout(function(){f.dequeue(c,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a){function c(){--g||d.resolveWith(e,[e])}"string"!=typeof a&&(a=b);for(var a=a||"fx",d=f.Deferred(),e=this,h=e.length,g=1,i=a+"defer",k=a+"queue",a=a+"mark",m;h--;)if(m=f.data(e[h],i,b,!0)||(f.data(e[h],k,b,!0)||f.data(e[h],a,b,!0))&&f.data(e[h],i,f._Deferred(),!0))g++,m.done(c);
c();return d.promise()}});var vb=/[\n\t\r]/g,eb=/\s+/,sc=/\r/g,tc=/^(?:button|input)$/i,uc=/^(?:button|input|object|select|textarea)$/i,vc=/^a(?:rea)?$/i,wb=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,fa,xb;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=
f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,h,g,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&"string"==typeof a){b=a.split(eb);c=0;for(d=this.length;c<d;c++)if(e=this[c],1===e.nodeType)if(!e.className&&1===b.length)e.className=a;else{h=" "+e.className+" ";g=0;for(i=b.length;g<i;g++)~h.indexOf(" "+b[g]+" ")||(h+=b[g]+" ");e.className=f.trim(h)}}return this},removeClass:function(a){var c,
d,e,h,g,i,k;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&"string"==typeof a||a===b){c=(a||"").split(eb);d=0;for(e=this.length;d<e;d++)if(h=this[d],1===h.nodeType&&h.className)if(a){g=(" "+h.className+" ").replace(vb," ");i=0;for(k=c.length;i<k;i++)g=g.replace(" "+c[i]+" "," ");h.className=f.trim(g)}else h.className=""}return this},toggleClass:function(a,b){var c=typeof a,d="boolean"==typeof b;return f.isFunction(a)?this.each(function(c){f(this).toggleClass(a.call(this,
c,this.className,b),b)}):this.each(function(){if("string"===c)for(var e,h=0,g=f(this),i=b,k=a.split(eb);e=k[h++];)i=d?i:!g.hasClass(e),g[i?"addClass":"removeClass"](e);else if("undefined"===c||"boolean"===c)this.className&&f._data(this,"__className__",this.className),this.className=this.className||!1===a?"":f._data(this,"__className__")||""})},hasClass:function(a){for(var a=" "+a+" ",b=0,c=this.length;b<c;b++)if(1===this[b].nodeType&&-1<(" "+this[b].className+" ").replace(vb," ").indexOf(a))return!0;
return!1},val:function(a){var c,d,e=this[0];if(!arguments.length){if(e){if((c=f.valHooks[e.nodeName.toLowerCase()]||f.valHooks[e.type])&&"get"in c&&(d=c.get(e,"value"))!==b)return d;d=e.value;return"string"==typeof d?d.replace(sc,""):null==d?"":d}return b}var h=f.isFunction(a);return this.each(function(d){var e=f(this),L;if(1===this.nodeType&&(h?L=a.call(this,d,e.val()):L=a,null==L?L="":"number"==typeof L?L+="":f.isArray(L)&&(L=f.map(L,function(a){return null==a?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||
f.valHooks[this.type],!c||!("set"in c)||c.set(this,L,"value")===b))this.value=L})}});f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c=a.selectedIndex,d=[],e=a.options,a="select-one"===a.type;if(0>c)return null;for(var h=a?c:0,g=a?c+1:e.length;h<g;h++)if(b=e[h],b.selected&&(f.support.optDisabled?!b.disabled:null===b.getAttribute("disabled"))&&(!b.parentNode.disabled||!f.nodeName(b.parentNode,"optgroup"))){b=
f(b).val();if(a)return b;d.push(b)}return a&&!d.length&&e.length?f(e[c]).val():d},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=0<=f.inArray(f(this).val(),c)});c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attrFix:{tabindex:"tabIndex"},attr:function(a,c,d,e){var h=a.nodeType;if(!a||3===h||8===h||2===h)return b;if(e&&c in f.attrFn)return f(a)[c](d);if(!("getAttribute"in a))return f.prop(a,
c,d);var g,i;(e=1!==h||!f.isXMLDoc(a))&&(c=f.attrFix[c]||c,i=f.attrHooks[c],i||(wb.test(c)?i=xb:fa&&(i=fa)));if(d!==b){if(null===d)return f.removeAttr(a,c),b;if(i&&"set"in i&&e&&(g=i.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(i&&"get"in i&&e&&null!==(g=i.get(a,c)))return g;g=a.getAttribute(c);return null===g?b:g},removeAttr:function(a,b){var c;1===a.nodeType&&(b=f.attrFix[b]||b,f.attr(a,b,""),a.removeAttribute(b),wb.test(b)&&(c=f.propFix[b]||b)in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,
b){if(tc.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&"radio"===b&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);c&&(a.value=c);return b}}},value:{get:function(a,b){return fa&&f.nodeName(a,"button")?fa.get(a,b):b in a?a.value:null},set:function(a,b,c){if(fa&&f.nodeName(a,"button"))return fa.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",
cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e=a.nodeType;if(!a||3===e||8===e||2===e)return b;var h,g;(1!==e||!f.isXMLDoc(a))&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(h=g.set(a,d,c))!==b?h:a[c]=d:g&&"get"in g&&null!==(h=g.get(a,c))?h:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):
uc.test(a.nodeName)||vc.test(a.nodeName)&&a.href?0:b}}}});f.attrHooks.tabIndex=f.propHooks.tabIndex;xb={get:function(a,c){var d;return!0===f.prop(a,c)||(d=a.getAttributeNode(c))&&!1!==d.nodeValue?c.toLowerCase():b},set:function(a,b,c){var d;!1===b?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}};f.support.getSetAttribute||(fa=f.valHooks.button={get:function(a,c){var d;return(d=a.getAttributeNode(c))&&""!==d.nodeValue?d.nodeValue:b},set:function(a,
b,c){var d=a.getAttributeNode(c);d||(d=q.createAttribute(c),a.setAttributeNode(d));return d.nodeValue=b+""}},f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,j){if(""===j)return a.setAttribute(b,"auto"),j}})}));f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){a=a.getAttribute(c,2);return null===a?b:a}})});f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||
b},set:function(a,b){return a.style.cssText=""+b}});f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){a=a.parentNode;a&&(a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex);return null}}));f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}});f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=
0<=f.inArray(f(a).val(),b)}})});var Za=/\.(.*)$/,fb=/^(?:textarea|input|select)$/i,bc=/\./g,cc=/ /g,wc=/[^\w\s.|`]/g,xc=function(a){return a.replace(wc,"\\$&")};f.event={add:function(a,c,d,e){if(3!==a.nodeType&&8!==a.nodeType){if(!1===d)d=H;else if(!d)return;var h,g;d.handler&&(h=d,d=h.handler);d.guid||(d.guid=f.guid++);if(g=f._data(a)){var i=g.events,k=g.handle;i||(g.events=i={});k||(g.handle=k=function(a){return"undefined"!=typeof f&&(!a||f.event.triggered!==a.type)?f.event.handle.apply(k.elem,
arguments):b});k.elem=a;for(var c=c.split(" "),m,p=0,A;m=c[p++];){g=h?f.extend({},h):{handler:d,data:e};-1<m.indexOf(".")?(A=m.split("."),m=A.shift(),g.namespace=A.slice(0).sort().join(".")):(A=[],g.namespace="");g.type=m;g.guid||(g.guid=d.guid);var v=i[m],n=f.event.special[m]||{};if(!v&&(v=i[m]=[],!n.setup||!1===n.setup.call(a,e,A,k)))a.addEventListener?a.addEventListener(m,k,!1):a.attachEvent&&a.attachEvent("on"+m,k);n.add&&(n.add.call(a,g),g.handler.guid||(g.handler.guid=d.guid));v.push(g);f.event.global[m]=
!0}a=null}}},global:{},remove:function(a,c,d,e){if(3!==a.nodeType&&8!==a.nodeType){!1===d&&(d=H);var h,g,i=0,k,m,p,A,v,n,s=f.hasData(a)&&f._data(a),u=s&&s.events;if(s&&u)if(c&&c.type&&(d=c.handler,c=c.type),!c||"string"==typeof c&&"."===c.charAt(0))for(h in c=c||"",u)f.event.remove(a,h+c);else{for(c=c.split(" ");h=c[i++];)if(A=h,k=0>h.indexOf("."),m=[],k||(m=h.split("."),h=m.shift(),p=RegExp("(^|\\.)"+f.map(m.slice(0).sort(),xc).join("\\.(?:.*\\.)?")+"(\\.|$)")),v=u[h])if(d){A=f.event.special[h]||
{};for(g=e||0;g<v.length;g++)if(n=v[g],d.guid===n.guid){if(k||p.test(n.namespace))null==e&&v.splice(g--,1),A.remove&&A.remove.call(a,n);if(null!=e)break}if(0===v.length||null!=e&&1===v.length)(!A.teardown||!1===A.teardown.call(a,m))&&f.removeEvent(a,h,s.handle),delete u[h]}else for(g=0;g<v.length;g++)if(n=v[g],k||p.test(n.namespace))f.event.remove(a,A,n.handler,g),v.splice(g--,1);f.isEmptyObject(u)&&((c=s.handle)&&(c.elem=null),delete s.events,delete s.handle,f.isEmptyObject(s)&&f.removeData(a,b,
!0))}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(j,c,d,e){var h=j.type||j,g=[],i;0<=h.indexOf("!")&&(h=h.slice(0,-1),i=!0);0<=h.indexOf(".")&&(g=h.split("."),h=g.shift(),g.sort());if(d&&!f.event.customEvent[h]||f.event.global[h]){j="object"==typeof j?j[f.expando]?j:new f.Event(h,j):new f.Event(h);j.type=h;j.exclusive=i;j.namespace=g.join(".");j.namespace_re=RegExp("(^|\\.)"+g.join("\\.(?:.*\\.)?")+"(\\.|$)");if(e||!d)j.preventDefault(),j.stopPropagation();if(d){if(!(3===
d.nodeType||8===d.nodeType)){j.result=b;j.target=d;c=null!=c?f.makeArray(c):[];c.unshift(j);g=d;e=0>h.indexOf(":")?"on"+h:"";do i=f._data(g,"handle"),j.currentTarget=g,i&&i.apply(g,c),e&&f.acceptData(g)&&g[e]&&!1===g[e].apply(g,c)&&(j.result=!1,j.preventDefault()),g=g.parentNode||g.ownerDocument||g===j.target.ownerDocument&&a;while(g&&!j.isPropagationStopped());if(!j.isDefaultPrevented()){var k,g=f.event.special[h]||{};if((!g._default||!1===g._default.call(d.ownerDocument,j))&&("click"!==h||!f.nodeName(d,
"a"))&&f.acceptData(d)){try{e&&d[h]&&(k=d[e],k&&(d[e]=null),f.event.triggered=h,d[h]())}catch(m){}k&&(d[e]=k);f.event.triggered=b}}return j.result}}else f.each(f.cache,function(){var a=this[f.expando];a&&a.events&&a.events[h]&&f.event.trigger(j,c,a.handle.elem)})}},handle:function(j){var j=f.event.fix(j||a.event),c=((f._data(this,"events")||{})[j.type]||[]).slice(0),d=!j.exclusive&&!j.namespace,e=Array.prototype.slice.call(arguments,0);e[0]=j;j.currentTarget=this;for(var h=0,g=c.length;h<g;h++){var i=
c[h];if(d||j.namespace_re.test(i.namespace))if(j.handler=i.handler,j.data=i.data,j.handleObj=i,i=i.handler.apply(this,e),i!==b&&(j.result=i,!1===i&&(j.preventDefault(),j.stopPropagation())),j.isImmediatePropagationStopped())break}return j.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),
fix:function(a){if(a[f.expando])return a;for(var c=a,a=f.Event(c),d=this.props.length,e;d;)e=this.props[--d],a[e]=c[e];a.target||(a.target=a.srcElement||q);3===a.target.nodeType&&(a.target=a.target.parentNode);!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);null==a.pageX&&null!=a.clientX&&(d=a.target.ownerDocument||q,c=d.documentElement,d=d.body,a.pageX=a.clientX+(c&&c.scrollLeft||d&&d.scrollLeft||0)-(c&&c.clientLeft||d&&d.clientLeft||0),a.pageY=
a.clientY+(c&&c.scrollTop||d&&d.scrollTop||0)-(c&&c.clientTop||d&&d.clientTop||0));null==a.which&&(null!=a.charCode||null!=a.keyCode)&&(a.which=null!=a.charCode?a.charCode:a.keyCode);!a.metaKey&&a.ctrlKey&&(a.metaKey=a.ctrlKey);!a.which&&a.button!==b&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);return a},guid:1E8,proxy:f.proxy,special:{ready:{setup:f.bindReady,teardown:f.noop},live:{add:function(a){f.event.add(this,Q(a.origType,a.selector),f.extend({},a,{handler:N,guid:a.handler.guid}))},remove:function(a){f.event.remove(this,
Q(a.origType,a.selector),a)}},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}}};f.removeEvent=q.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)};f.Event=function(a,b){if(!this.preventDefault)return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||
!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?M:H):this.type=a;b&&f.extend(this,b);this.timeStamp=f.now();this[f.expando]=!0};f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=M;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=M;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=
M;this.stopPropagation()},isDefaultPrevented:H,isPropagationStopped:H,isImmediatePropagationStopped:H};var yb=function(a){var b=a.relatedTarget,c=!1,d=a.type;a.type=a.data;b!==this&&(b&&(c=f.contains(this,b)),c||(f.event.handle.apply(this,arguments),a.type=d))},zb=function(a){a.type=a.data;f.event.handle.apply(this,arguments)};f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={setup:function(c){f.event.add(this,b,c&&c.selector?zb:yb,a)},teardown:function(a){f.event.remove(this,
b,a&&a.selector?zb:yb)}}});f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click.specialSubmit",function(a){var b=a.target,c=f.nodeName(b,"input")||f.nodeName(b,"button")?b.type:"";("submit"===c||"image"===c)&&f(b).closest("form").length&&R("submit",this,arguments)});f.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,c=f.nodeName(b,"input")||f.nodeName(b,"button")?b.type:"";("text"===c||"password"===c)&&f(b).closest("form").length&&
13===a.keyCode&&R("submit",this,arguments)})},teardown:function(){f.event.remove(this,".specialSubmit")}});if(!f.support.changeBubbles){var za,Ab=function(a){var b=f.nodeName(a,"input")?a.type:"",c=a.value;"radio"===b||"checkbox"===b?c=a.checked:"select-multiple"===b?c=-1<a.selectedIndex?f.map(a.options,function(a){return a.selected}).join("-"):"":f.nodeName(a,"select")&&(c=a.selectedIndex);return c},Ma=function(a,c){var d=a.target,e,h;if(fb.test(d.nodeName)&&!d.readOnly&&(e=f._data(d,"_change_data"),
h=Ab(d),("focusout"!==a.type||"radio"!==d.type)&&f._data(d,"_change_data",h),!(e===b||h===e)))if(null!=e||h)a.type="change",a.liveFired=b,f.event.trigger(a,c,d)};f.event.special.change={filters:{focusout:Ma,beforedeactivate:Ma,click:function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";("radio"===c||"checkbox"===c||f.nodeName(b,"select"))&&Ma.call(this,a)},keydown:function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(13===a.keyCode&&!f.nodeName(b,"textarea")||32===a.keyCode&&("checkbox"===
c||"radio"===c)||"select-multiple"===c)&&Ma.call(this,a)},beforeactivate:function(a){a=a.target;f._data(a,"_change_data",Ab(a))}},setup:function(){if("file"===this.type)return!1;for(var a in za)f.event.add(this,a+".specialChange",za[a]);return fb.test(this.nodeName)},teardown:function(){f.event.remove(this,".specialChange");return fb.test(this.nodeName)}};za=f.event.special.change.filters;za.focus=za.beforeactivate}f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){function c(a){var j=
f.event.fix(a);j.type=b;j.originalEvent={};f.event.trigger(j,null,j.target);j.isDefaultPrevented()&&a.preventDefault()}var d=0;f.event.special[b]={setup:function(){0===d++&&q.addEventListener(a,c,!0)},teardown:function(){0===--d&&q.removeEventListener(a,c,!0)}}});f.each(["bind","one"],function(a,c){f.fn[c]=function(a,j,d){var e;if("object"==typeof a){for(var h in a)this[c](h,j,a[h],d);return this}if(2===arguments.length||!1===j)d=j,j=b;"one"===c?(e=function(a){f(this).unbind(a,e);return d.apply(this,
arguments)},e.guid=d.guid||f.guid++):e=d;if("unload"===a&&"one"!==c)this.one(a,j,d);else{h=0;for(var g=this.length;h<g;h++)f.event.add(this[h],a,e,j)}return this}});f.fn.extend({unbind:function(a,b){if("object"==typeof a&&!a.preventDefault)for(var c in a)this.unbind(c,a[c]);else{c=0;for(var d=this.length;c<d;c++)f.event.remove(this[c],a,b)}return this},delegate:function(a,b,c,d){return this.live(b,c,d,a)},undelegate:function(a,b,c){return 0===arguments.length?this.unbind("live"):this.die(b,null,c,
a)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f.data(this,"lastToggle"+a.guid)||0)%d;f.data(this,"lastToggle"+a.guid,e+1);c.preventDefault();return b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});
var gb={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};f.each(["live","die"],function(a,c){f.fn[c]=function(a,j,d,e){var h=0,g,i,k=e||this.selector,m=e?this:f(this.context);if("object"==typeof a&&!a.preventDefault){for(g in a)m[c](g,j,a[g],k);return this}if("die"===c&&!a&&e&&"."===e.charAt(0))return m.unbind(e),this;if(!1===j||f.isFunction(j))d=j||H,j=b;for(a=(a||"").split(" ");null!=(e=a[h++]);)if(g=Za.exec(e),i="",g&&(i=g[0],e=e.replace(Za,"")),"hover"===e)a.push("mouseenter"+
i,"mouseleave"+i);else if(g=e,gb[e]?(a.push(gb[e]+i),e+=i):e=(gb[e]||e)+i,"live"===c){i=0;for(var p=m.length;i<p;i++)f.event.add(m[i],"live."+Q(e,k),{data:j,selector:k,handler:d,origType:e,origHandler:d,preType:g})}else m.unbind("live."+Q(e,k),d);return this}});f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){f.fn[b]=function(a,
j){null==j&&(j=a,a=null);return 0<arguments.length?this.bind(b,a,j):this.trigger(b)};f.attrFn&&(f.attrFn[b]=!0)});var Bb=function(a,b,c,d,e,f){for(var e=0,h=d.length;e<h;e++){var g=d[e];if(g){for(var i=!1,g=g[a];g;){if(g.sizcache===c){i=d[g.sizset];break}if(1===g.nodeType)if(f||(g.sizcache=c,g.sizset=e),"string"!=typeof b){if(g===b){i=!0;break}}else if(0<C.filter(b,[g]).length){i=g;break}g=g[a]}d[e]=i}}},Cb=function(a,b,c,d,e,f){for(var e=0,h=d.length;e<h;e++){var g=d[e];if(g){for(var i=!1,g=g[a];g;){if(g.sizcache===
c){i=d[g.sizset];break}1===g.nodeType&&!f&&(g.sizcache=c,g.sizset=e);if(g.nodeName.toLowerCase()===b){i=g;break}g=g[a]}d[e]=i}}},hb=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,ib=0,Db=Object.prototype.toString,Na=!1,Eb=!0,qa=/\\/g,Oa=/\W/;[0,0].sort(function(){Eb=!1;return 0});var C=function(a,b,c,d){var c=c||[],e=b=b||q;if(1!==b.nodeType&&9!==b.nodeType)return[];if(!a||"string"!=typeof a)return c;var f,h,g,
i,k,m,p=!0,A=C.isXML(b),v=[],n=a;do if(hb.exec(""),f=hb.exec(n))if(n=f[3],v.push(f[1]),f[2]){i=f[3];break}while(f);if(1<v.length&&yc.exec(a))if(2===v.length&&E.relative[v[0]])h=Fb(v[0]+v[1],b);else for(h=E.relative[v[0]]?[b]:C(v.shift(),b);v.length;)a=v.shift(),E.relative[a]&&(a+=v.shift()),h=Fb(a,h);else if(!d&&1<v.length&&9===b.nodeType&&!A&&E.match.ID.test(v[0])&&!E.match.ID.test(v[v.length-1])&&(k=C.find(v.shift(),b,A),b=k.expr?C.filter(k.expr,k.set)[0]:k.set[0]),b){k=d?{expr:v.pop(),set:Y(d)}:
C.find(v.pop(),1===v.length&&("~"===v[0]||"+"===v[0])&&b.parentNode?b.parentNode:b,A);h=k.expr?C.filter(k.expr,k.set):k.set;for(0<v.length?g=Y(h):p=!1;v.length;)f=m=v.pop(),E.relative[m]?f=v.pop():m="",null==f&&(f=b),E.relative[m](g,f,A)}else g=[];g||(g=h);g||C.error(m||a);if("[object Array]"===Db.call(g))if(p)if(b&&1===b.nodeType)for(a=0;null!=g[a];a++)g[a]&&(!0===g[a]||1===g[a].nodeType&&C.contains(b,g[a]))&&c.push(h[a]);else for(a=0;null!=g[a];a++)g[a]&&1===g[a].nodeType&&c.push(h[a]);else c.push.apply(c,
g);else Y(g,c);i&&(C(i,e,c,d),C.uniqueSort(c));return c};C.uniqueSort=function(a){if(Pa&&(Na=Eb,a.sort(Pa),Na))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a};C.matches=function(a,b){return C(a,null,null,b)};C.matchesSelector=function(a,b){return 0<C(b,null,null,[a]).length};C.find=function(a,b,c){var d;if(!a)return[];for(var e=0,f=E.order.length;e<f;e++){var h,g=E.order[e];if(h=E.leftMatch[g].exec(a)){var i=h[1];h.splice(1,1);if("\\"!==i.substr(i.length-1)&&(h[1]=(h[1]||"").replace(qa,
""),d=E.find[g](h,b,c),null!=d)){a=a.replace(E.match[g],"");break}}}d||(d="undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName("*"):[]);return{set:d,expr:a}};C.filter=function(a,c,d,e){for(var f,h,g=a,i=[],k=c,m=c&&c[0]&&C.isXML(c[0]);a&&c.length;){for(var p in E.filter)if(null!=(f=E.leftMatch[p].exec(a))&&f[2]){var A,v,n=E.filter[p];v=f[1];h=!1;f.splice(1,1);if("\\"!==v.substr(v.length-1)){k===i&&(i=[]);if(E.preFilter[p])if(f=E.preFilter[p](f,k,d,i,e,m)){if(!0===f)continue}else h=A=
!0;if(f)for(var s=0;null!=(v=k[s]);s++)if(v){A=n(v,f,s,k);var u=e^!!A;d&&null!=A?u?h=!0:k[s]=!1:u&&(i.push(v),h=!0)}if(A!==b){d||(k=i);a=a.replace(E.match[p],"");if(!h)return[];break}}}if(a===g)if(null==h)C.error(a);else break;g=a}return k};C.error=function(a){throw"Syntax error, unrecognized expression: "+a;};var E=C.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,
TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=
"string"==typeof b,d=c&&!Oa.test(b),c=c&&!d;d&&(b=b.toLowerCase());for(var d=0,e=a.length,f;d<e;d++)if(f=a[d]){for(;(f=f.previousSibling)&&1!==f.nodeType;);a[d]=c||f&&f.nodeName.toLowerCase()===b?f||!1:f===b}c&&C.filter(b,a,!0)},">":function(a,b){var c,d="string"==typeof b,e=0,f=a.length;if(d&&!Oa.test(b))for(b=b.toLowerCase();e<f;e++){if(c=a[e])c=c.parentNode,a[e]=c.nodeName.toLowerCase()===b?c:!1}else{for(;e<f;e++)(c=a[e])&&(a[e]=d?c.parentNode:c.parentNode===b);d&&C.filter(b,a,!0)}},"":function(a,
b,c){var d,e=ib++,f=Bb;"string"==typeof b&&!Oa.test(b)&&(b=b.toLowerCase(),d=b,f=Cb);f("parentNode",b,e,a,d,c)},"~":function(a,b,c){var d,e=ib++,f=Bb;"string"==typeof b&&!Oa.test(b)&&(b=b.toLowerCase(),d=b,f=Cb);f("previousSibling",b,e,a,d,c)}},find:{ID:function(a,b,c){if("undefined"!=typeof b.getElementById&&!c)return(a=b.getElementById(a[1]))&&a.parentNode?[a]:[]},NAME:function(a,b){if("undefined"!=typeof b.getElementsByName){for(var c=[],d=b.getElementsByName(a[1]),e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===
a[1]&&c.push(d[e]);return 0===c.length?null:c}},TAG:function(a,b){if("undefined"!=typeof b.getElementsByTagName)return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(qa,"")+" ";if(f)return a;for(var f=0,h;null!=(h=b[f]);f++)h&&(e^(h.className&&0<=(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a))?c||d.push(h):c&&(b[f]=!1));return!1},ID:function(a){return a[1].replace(qa,"")},TAG:function(a){return a[1].replace(qa,"").toLowerCase()},CHILD:function(a){if("nth"===
a[1]){a[2]||C.error(a[0]);a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even"===a[2]&&"2n"||"odd"===a[2]&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}else a[2]&&C.error(a[0]);a[0]=ib++;return a},ATTR:function(a,b,c,d,e,f){b=a[1]=a[1].replace(qa,"");!f&&E.attrMap[b]&&(a[1]=E.attrMap[b]);a[4]=(a[4]||a[5]||"").replace(qa,"");"~="===a[2]&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(a,b,c,d,e){if("not"===a[1])if(1<(hb.exec(a[3])||"").length||
/^\w/.test(a[3]))a[3]=C(a[3],null,null,b);else return a=C.filter(a[3],b,c,1^e),c||d.push.apply(d,a),!1;else if(E.match.POS.test(a[0])||E.match.CHILD.test(a[0]))return!0;return a},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return!1===a.disabled&&"hidden"!==a.type},disabled:function(a){return!0===a.disabled},checked:function(a){return!0===a.checked},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},parent:function(a){return!!a.firstChild},
empty:function(a){return!a.firstChild},has:function(a,b,c){return!!C(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return"input"===a.nodeName.toLowerCase()&&"text"===c&&(b===c||null===b)},radio:function(a){return"input"===a.nodeName.toLowerCase()&&"radio"===a.type},checkbox:function(a){return"input"===a.nodeName.toLowerCase()&&"checkbox"===a.type},file:function(a){return"input"===a.nodeName.toLowerCase()&&"file"===a.type},
password:function(a){return"input"===a.nodeName.toLowerCase()&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return("input"===b||"button"===b)&&"submit"===a.type},image:function(a){return"input"===a.nodeName.toLowerCase()&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return("input"===b||"button"===b)&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},
focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return 0===b},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return 0===b%2},odd:function(a,b){return 1===b%2},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=E.filters[e];if(f)return f(a,c,b,d);if("contains"===e)return 0<=(a.textContent||a.innerText||
C.getText([a])||"").indexOf(b[3]);if("not"===e){b=b[3];c=0;for(d=b.length;c<d;c++)if(b[c]===a)return!1;return!0}C.error(e)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case "only":case "first":for(;d=d.previousSibling;)if(1===d.nodeType)return!1;if("first"===c)return!0;d=a;case "last":for(;d=d.nextSibling;)if(1===d.nodeType)return!1;return!0;case "nth":var c=b[2],e=b[3];if(1===c&&0===e)return!0;var f=b[0],h=a.parentNode;if(h&&(h.sizcache!==f||!a.nodeIndex)){for(var g=0,d=h.firstChild;d;d=d.nextSibling)1===
d.nodeType&&(d.nodeIndex=++g);h.sizcache=f}d=a.nodeIndex-e;return 0===c?0===d:0===d%c&&0<=d/c}},ID:function(a,b){return 1===a.nodeType&&a.getAttribute("id")===b},TAG:function(a,b){return"*"===b&&1===a.nodeType||a.nodeName.toLowerCase()===b},CLASS:function(a,b){return-1<(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)},ATTR:function(a,b){var c=b[1],c=E.attrHandle[c]?E.attrHandle[c](a):null!=a[c]?a[c]:a.getAttribute(c),d=c+"",e=b[2],f=b[4];return null==c?"!="===e:"="===e?d===f:"*="===e?0<=
d.indexOf(f):"~="===e?0<=(" "+d+" ").indexOf(f):f?"!="===e?d!==f:"^="===e?0===d.indexOf(f):"$="===e?d.substr(d.length-f.length)===f:"|="===e?d===f||d.substr(0,f.length+1)===f+"-":!1:d&&!1!==c},POS:function(a,b,c,d){var e=E.setFilters[b[2]];if(e)return e(a,c,b,d)}}},yc=E.match.POS,zc=function(a,b){return"\\"+(b-0+1)},Aa;for(Aa in E.match)E.match[Aa]=RegExp(E.match[Aa].source+/(?![^\[]*\])(?![^\(]*\))/.source),E.leftMatch[Aa]=RegExp(/(^(?:.|\r|\n)*?)/.source+E.match[Aa].source.replace(/\\(\d+)/g,zc));
var Y=function(a,b){a=Array.prototype.slice.call(a,0);return b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(q.documentElement.childNodes,0)[0].nodeType}catch(dd){Y=function(a,b){var c=0,d=b||[];if("[object Array]"===Db.call(a))Array.prototype.push.apply(d,a);else if("number"==typeof a.length)for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var Pa,Ba;q.documentElement.compareDocumentPosition?Pa=function(a,b){return a===b?(Na=!0,0):!a.compareDocumentPosition||
!b.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(Pa=function(a,b){if(a===b)return Na=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[];c=a.parentNode;d=b.parentNode;var h=c;if(c===d)return Ba(a,b);if(!c)return-1;if(!d)return 1;for(;h;)e.unshift(h),h=h.parentNode;for(h=d;h;)f.unshift(h),h=h.parentNode;c=e.length;d=f.length;for(h=0;h<c&&h<d;h++)if(e[h]!==f[h])return Ba(e[h],f[h]);return h===c?Ba(a,f[h],-1):Ba(e[h],
b,1)},Ba=function(a,b,c){if(a===b)return c;for(a=a.nextSibling;a;){if(a===b)return-1;a=a.nextSibling}return 1});C.getText=function(a){for(var b="",c,d=0;a[d];d++)c=a[d],3===c.nodeType||4===c.nodeType?b+=c.nodeValue:8!==c.nodeType&&(b+=C.getText(c.childNodes));return b};var Qa=q.createElement("div"),Gb="script"+(new Date).getTime(),Ra=q.documentElement;Qa.innerHTML="<a name='"+Gb+"'/>";Ra.insertBefore(Qa,Ra.firstChild);q.getElementById(Gb)&&(E.find.ID=function(a,c,d){if("undefined"!=typeof c.getElementById&&
!d)return(c=c.getElementById(a[1]))?c.id===a[1]||"undefined"!=typeof c.getAttributeNode&&c.getAttributeNode("id").nodeValue===a[1]?[c]:b:[]},E.filter.ID=function(a,b){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return 1===a.nodeType&&c&&c.nodeValue===b});Ra.removeChild(Qa);var Ra=Qa=null,ga=q.createElement("div");ga.appendChild(q.createComment(""));0<ga.getElementsByTagName("*").length&&(E.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if("*"===a[1]){for(var d=
[],e=0;c[e];e++)1===c[e].nodeType&&d.push(c[e]);c=d}return c});ga.innerHTML="<a href='#'></a>";ga.firstChild&&"undefined"!=typeof ga.firstChild.getAttribute&&"#"!==ga.firstChild.getAttribute("href")&&(E.attrHandle.href=function(a){return a.getAttribute("href",2)});ga=null;if(q.querySelectorAll){var jb=C,Sa=q.createElement("div");Sa.innerHTML="<p class='TEST'></p>";if(!Sa.querySelectorAll||0!==Sa.querySelectorAll(".TEST").length){var C=function(a,b,c,d){b=b||q;if(!d&&!C.isXML(b)){var e=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(a);
if(e&&(1===b.nodeType||9===b.nodeType)){if(e[1])return Y(b.getElementsByTagName(a),c);if(e[2]&&E.find.CLASS&&b.getElementsByClassName)return Y(b.getElementsByClassName(e[2]),c)}if(9===b.nodeType){if("body"===a&&b.body)return Y([b.body],c);if(e&&e[3]){var f=b.getElementById(e[3]);if(!f||!f.parentNode)return Y([],c);if(f.id===e[3])return Y([f],c)}try{return Y(b.querySelectorAll(a),c)}catch(h){}}else if(1===b.nodeType&&"object"!==b.nodeName.toLowerCase()){var e=b,g=(f=b.getAttribute("id"))||"__sizzle__",
i=b.parentNode,k=/^\s*[+~]/.test(a);f?g=g.replace(/'/g,"\\$&"):b.setAttribute("id",g);k&&i&&(b=b.parentNode);try{if(!k||i)return Y(b.querySelectorAll("[id='"+g+"'] "+a),c)}catch(m){}finally{f||e.removeAttribute("id")}}}return jb(a,b,c,d)},kb;for(kb in jb)C[kb]=jb[kb];Sa=null}}var Ta=q.documentElement,Ua=Ta.matchesSelector||Ta.mozMatchesSelector||Ta.webkitMatchesSelector||Ta.msMatchesSelector;if(Ua){var Ac=!Ua.call(q.createElement("div"),"div"),Hb=!1;try{Ua.call(q.documentElement,"[test!='']:sizzle")}catch(ed){Hb=
!0}C.matchesSelector=function(a,b){b=b.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!C.isXML(a))try{if(Hb||!E.match.PSEUDO.test(b)&&!/!=/.test(b)){var c=Ua.call(a,b);if(c||!Ac||a.document&&11!==a.document.nodeType)return c}}catch(d){}return 0<C(b,null,null,[a]).length}}var ra=q.createElement("div");ra.innerHTML="<div class='test e'></div><div class='test'></div>";ra.getElementsByClassName&&0!==ra.getElementsByClassName("e").length&&(ra.lastChild.className="e",1!==ra.getElementsByClassName("e").length&&
(E.order.splice(1,0,"CLASS"),E.find.CLASS=function(a,b,c){if("undefined"!=typeof b.getElementsByClassName&&!c)return b.getElementsByClassName(a[1])},ra=null));q.documentElement.contains?C.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:q.documentElement.compareDocumentPosition?C.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:C.contains=function(){return!1};C.isXML=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?"HTML"!==a.nodeName:!1};var Fb=function(a,
b){for(var c,d=[],e="",f=b.nodeType?[b]:b;c=E.match.PSEUDO.exec(a);)e+=c[0],a=a.replace(E.match.PSEUDO,"");a=E.relative[a]?a+"*":a;c=0;for(var h=f.length;c<h;c++)C(a,f[c],d);return C.filter(e,d)};f.find=C;f.expr=C.selectors;f.expr[":"]=f.expr.filters;f.unique=C.uniqueSort;f.text=C.getText;f.isXMLDoc=C.isXML;f.contains=C.contains;var Bc=/Until$/,Cc=/^(?:parents|prevUntil|prevAll)/,Dc=/,/,ac=/^.[^:#\[\.,]*$/,Ec=Array.prototype.slice,Ib=f.expr.match.POS,Fc={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=
this,c,d;if("string"!=typeof a)return f(a).filter(function(){c=0;for(d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),h,g,i;c=0;for(d=this.length;c<d;c++)if(h=e.length,f.find(a,this[c],e),0<c)for(g=h;g<e.length;g++)for(i=0;i<h;i++)if(e[i]===e[g]){e.splice(g--,1);break}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(O(this,a,!1),"not",
a)},filter:function(a){return this.pushStack(O(this,a,!0),"filter",a)},is:function(a){return!!a&&("string"==typeof a?0<f.filter(a,this).length:0<this.filter(a).length)},closest:function(a,b){var c=[],d,e,h=this[0];if(f.isArray(a)){var g,i={},k=1;if(h&&a.length){d=0;for(e=a.length;d<e;d++)g=a[d],i[g]||(i[g]=Ib.test(g)?f(g,b||this.context):g);for(;h&&h.ownerDocument&&h!==b;){for(g in i)d=i[g],(d.jquery?-1<d.index(h):f(h).is(d))&&c.push({selector:g,elem:h,level:k});h=h.parentNode;k++}}return c}g=Ib.test(a)||
"string"!=typeof a?f(a,b||this.context):0;d=0;for(e=this.length;d<e;d++)for(h=this[d];h;){if(g?-1<g.index(h):f.find.matchesSelector(h,a)){c.push(h);break}h=h.parentNode;if(!h||!h.ownerDocument||h===b||11===h.nodeType)break}c=1<c.length?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){return!a?this[0]&&this[0].parentNode?this.prevAll().length:-1:"string"==typeof a?f.inArray(this[0],f(a)):f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c="string"==typeof a?f(a,b):f.makeArray(a&&
a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(!c[0]||!c[0].parentNode||11===c[0].parentNode.nodeType||!d[0]||!d[0].parentNode||11===d[0].parentNode.nodeType?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}});f.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,
2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,
b){f.fn[a]=function(c,d){var e=f.map(this,b,c),h=Ec.call(arguments);Bc.test(a)||(d=c);d&&"string"==typeof d&&(e=f.filter(d,e));e=1<this.length&&!Fc[a]?f.unique(e):e;(1<this.length||Dc.test(d))&&Cc.test(a)&&(e=e.reverse());return this.pushStack(e,a,h.join(","))}});f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return 1===b.length?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){for(var e=[],a=a[c];a&&9!==a.nodeType&&(d===b||1!==a.nodeType||!f(a).is(d));)1===
a.nodeType&&e.push(a),a=a[c];return e},nth:function(a,b,c){for(var b=b||1,d=0;a&&!(1===a.nodeType&&++d===b);a=a[c]);return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Gc=/ jQuery\d+="(?:\d+|null)"/g,lb=/^\s+/,Jb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Kb=/<([\w:]+)/,Hc=/<tbody/i,Ic=/<|&#?\w+;/,Lb=/<(?:script|object|embed|option|style)/i,Mb=/checked\s*(?:[^=]|=\s*.checked.)/i,Jc=/\/(java|ecma)script/i,$b=
/^\s*<!(?:\[CDATA\[|\-\-)/,W={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};W.optgroup=W.option;W.tbody=W.tfoot=W.colgroup=W.caption=W.thead;W.th=W.td;f.support.htmlSerialize||(W._default=[1,"div<div>","</div>"]);f.fn.extend({text:function(a){return f.isFunction(a)?
this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))}):"object"!=typeof a&&a!==b?this.empty().append((this[0]&&this[0].ownerDocument||q).createTextNode(a)):f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},
wrapInner:function(a){return f.isFunction(a)?this.each(function(b){f(this).wrapInner(a.call(this,b))}):this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){f(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){1===this.nodeType&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,
!0,function(a){1===this.nodeType&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,
"after",arguments);a.push.apply(a,f(arguments[0]).toArray());return a}},remove:function(a,b){for(var c=0,d;null!=(d=this[c]);c++)if(!a||f.filter(a,[d]).length)!b&&1===d.nodeType&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;null!=(b=this[a]);a++)for(1===b.nodeType&&f.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);return this},clone:function(a,b){a=null==a?!1:a;b=null==
b?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&1===this[0].nodeType?this[0].innerHTML.replace(Gc,""):null;if("string"==typeof a&&!Lb.test(a)&&(f.support.leadingWhitespace||!lb.test(a))&&!W[(Kb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Jb,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)1===this[c].nodeType&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=
f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});"string"!=typeof a&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove();b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,
!0)},domManip:function(a,c,d){var e,h,g,i=a[0],k=[];if(!f.support.checkClone&&3===arguments.length&&"string"==typeof i&&Mb.test(i))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(i))return this.each(function(e){var h=f(this);a[0]=i.call(this,e,c?h.html():b);h.domManip(a,c,d)});if(this[0]){g=i&&i.parentNode;f.support.parentNode&&g&&11===g.nodeType&&g.childNodes.length===this.length?e={fragment:g}:e=f.buildFragment(a,this,k);g=e.fragment;1===g.childNodes.length?h=g=g.firstChild:
h=g.firstChild;if(h){c=c&&f.nodeName(h,"tr");h=0;for(var m=this.length,p=m-1;h<m;h++)d.call(c?f.nodeName(this[h],"table")?this[h].getElementsByTagName("tbody")[0]||this[h].appendChild(this[h].ownerDocument.createElement("tbody")):this[h]:this[h],e.cacheable||1<m&&h<p?f.clone(g,!0,!0):g)}k.length&&f.each(k,x)}return this}});f.buildFragment=function(a,b,c){var d,e,h,g;b&&b[0]&&(g=b[0].ownerDocument||b[0]);g.createDocumentFragment||(g=q);1===a.length&&"string"==typeof a[0]&&512>a[0].length&&g===q&&"<"===
a[0].charAt(0)&&!Lb.test(a[0])&&(f.support.checkClone||!Mb.test(a[0]))&&(e=!0,h=f.fragments[a[0]],h&&1!==h&&(d=h));d||(d=g.createDocumentFragment(),f.clean(a,g,d,c));e&&(f.fragments[a[0]]=h?d:1);return{fragment:d,cacheable:e}};f.fragments={};f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],c=f(c),e=1===this.length&&this[0].parentNode;if(e&&11===e.nodeType&&1===e.childNodes.length&&1===c.length)return c[b](this[0]),
this;for(var e=0,h=c.length;e<h;e++){var g=(0<e?this.clone(!0):this).get();f(c[e])[b](g);d=d.concat(g)}return this.pushStack(d,a,c.selector)}});f.extend({clone:function(a,b,c){var d=a.cloneNode(!0),e,h,g;if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(1===a.nodeType||11===a.nodeType)&&!f.isXMLDoc(a)){D(a,d);e=w(a);h=w(d);for(g=0;e[g];++g)h[g]&&D(e[g],h[g])}if(b&&(K(a,d),c)){e=w(a);h=w(d);for(g=0;e[g];++g)K(e[g],h[g])}return d},clean:function(a,b,c,d){b=b||q;"undefined"==typeof b.createElement&&
(b=b.ownerDocument||b[0]&&b[0].ownerDocument||q);for(var e=[],h,g=0,i;null!=(i=a[g]);g++)if("number"==typeof i&&(i+=""),i){if("string"==typeof i)if(Ic.test(i)){i=i.replace(Jb,"<$1></$2>");h=(Kb.exec(i)||["",""])[1].toLowerCase();var k=W[h]||W._default,m=k[0],p=b.createElement("div");for(p.innerHTML=k[1]+i+k[2];m--;)p=p.lastChild;if(!f.support.tbody){m=Hc.test(i);k="table"===h&&!m?p.firstChild&&p.firstChild.childNodes:"<table>"===k[1]&&!m?p.childNodes:[];for(h=k.length-1;0<=h;--h)f.nodeName(k[h],"tbody")&&
!k[h].childNodes.length&&k[h].parentNode.removeChild(k[h])}!f.support.leadingWhitespace&&lb.test(i)&&p.insertBefore(b.createTextNode(lb.exec(i)[0]),p.firstChild);i=p.childNodes}else i=b.createTextNode(i);var A;if(!f.support.appendChecked)if(i[0]&&"number"==typeof(A=i.length))for(h=0;h<A;h++)B(i[h]);else B(i);i.nodeType?e.push(i):e=f.merge(e,i)}if(c){a=function(a){return!a.type||Jc.test(a.type)};for(g=0;e[g];g++)d&&f.nodeName(e[g],"script")&&(!e[g].type||"text/javascript"===e[g].type.toLowerCase())?
d.push(e[g].parentNode?e[g].parentNode.removeChild(e[g]):e[g]):(1===e[g].nodeType&&(b=f.grep(e[g].getElementsByTagName("script"),a),e.splice.apply(e,[g+1,0].concat(b))),c.appendChild(e[g]))}return e},cleanData:function(a){for(var b,c,d=f.cache,e=f.expando,h=f.event.special,g=f.support.deleteExpando,i=0,k;null!=(k=a[i]);i++)if(!k.nodeName||!f.noData[k.nodeName.toLowerCase()])if(c=k[f.expando]){if((b=d[c]&&d[c][e])&&b.events){for(var m in b.events)h[m]?f.event.remove(k,m):f.removeEvent(k,m,b.handle);
b.handle&&(b.handle.elem=null)}g?delete k[f.expando]:k.removeAttribute&&k.removeAttribute(f.expando);delete d[c]}}});var mb=/alpha\([^)]*\)/i,Kc=/opacity=([^)]*)/,Lc=/([A-Z]|^ms)/g,Nb=/^-?\d+(?:px)?$/i,Mc=/^-?\d/,Nc=/^([\-+])=([\-+.\de]+)/,Oc={position:"absolute",visibility:"hidden",display:"block"},Yb=["Left","Right"],Zb=["Top","Bottom"],ka,Ob,Pb;f.fn.css=function(a,c){return 2===arguments.length&&c===b?this:f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})};f.extend({cssHooks:{opacity:{get:function(a,
b){if(b){var c=ka(a,"opacity","opacity");return""===c?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var h,g=f.camelCase(c),i=a.style,k=f.cssHooks[g],c=f.cssProps[g]||g;if(d===b)return k&&"get"in k&&(h=k.get(a,!1,e))!==b?h:i[c];e=typeof d;"string"===e&&(h=Nc.exec(d))&&(d=+(h[1]+
1)*+h[2]+parseFloat(f.css(a,c)),e="number");if(!(null==d||"number"===e&&isNaN(d)))if("number"===e&&!f.cssNumber[g]&&(d+="px"),!k||!("set"in k)||(d=k.set(a,d))!==b)try{i[c]=d}catch(m){}}},css:function(a,c,d){var e,h,c=f.camelCase(c);h=f.cssHooks[c];c=f.cssProps[c]||c;"cssFloat"===c&&(c="float");if(h&&"get"in h&&(e=h.get(a,!0,d))!==b)return e;if(ka)return ka(a,c)},swap:function(a,b,c){var d={},e;for(e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}});f.curCSS=f.css;f.each(["height",
"width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(0!==a.offsetWidth)return u(a,b,d);f.swap(a,Oc,function(){e=u(a,b,d)});return e}},set:function(a,b){if(!Nb.test(b))return b;b=parseFloat(b);if(0<=b)return b+"px"}}});f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return Kc.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNaN(b)?"":"alpha(opacity="+100*b+")",
h=d&&d.filter||c.filter||"";c.zoom=1;if(1<=b&&""===f.trim(h.replace(mb,""))&&(c.removeAttribute("filter"),d&&!d.filter))return;c.filter=mb.test(h)?h.replace(mb,e):h+" "+e}});f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=ka(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})});q.defaultView&&q.defaultView.getComputedStyle&&(Ob=function(a,c){var d,e,c=c.replace(Lc,"-$1").toLowerCase();if(!(e=
a.ownerDocument.defaultView))return b;if(e=e.getComputedStyle(a,null))d=e.getPropertyValue(c),""===d&&!f.contains(a.ownerDocument.documentElement,a)&&(d=f.style(a,c));return d});q.documentElement.currentStyle&&(Pb=function(a,b){var c,d=a.currentStyle&&a.currentStyle[b],e=a.runtimeStyle&&a.runtimeStyle[b],f=a.style;!Nb.test(d)&&Mc.test(d)&&(c=f.left,e&&(a.runtimeStyle.left=a.currentStyle.left),f.left="fontSize"===b?"1em":d||0,d=f.pixelLeft+"px",f.left=c,e&&(a.runtimeStyle.left=e));return""===d?"auto":
d});ka=Ob||Pb;f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetHeight;return 0===a.offsetWidth&&0===b||!f.support.reliableHiddenOffsets&&"none"===(a.style.display||f.css(a,"display"))},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var Pc=/%20/g,Xb=/\[\]$/,Qb=/\r?\n/g,Qc=/#.*$/,Rc=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,Sc=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Tc=/^(?:GET|HEAD)$/,Uc=
/^\/\//,Rb=/\?/,Vc=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Wc=/^(?:select|textarea)/i,qb=/\s+/,Xc=/([?&])_=[^&]*/,Sb=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Tb=f.fn.load,Ya={},Ub={},ha,ia,Vb=["*/"]+["*"];try{ha=P.href}catch(fd){ha=q.createElement("a"),ha.href="",ha=ha.href}ia=Sb.exec(ha.toLowerCase())||[];f.fn.extend({load:function(a,c,d){if("string"!=typeof a&&Tb)return Tb.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(0<=e)var h=a.slice(e,a.length),
a=a.slice(0,e);e="GET";c&&(f.isFunction(c)?(d=c,c=b):"object"==typeof c&&(c=f.param(c,f.ajaxSettings.traditional),e="POST"));var g=this;f.ajax({url:a,type:e,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText;a.isResolved()&&(a.done(function(a){c=a}),g.html(h?f("<div>").append(c.replace(Vc,"")).find(h):c));d&&g.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):
this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Wc.test(this.nodeName)||Sc.test(this.type))}).map(function(a,b){var c=f(this).val();return null==c?null:f.isArray(c)?f.map(c,function(a){return{name:b.name,value:a.replace(Qb,"\r\n")}}):{name:b.name,value:c.replace(Qb,"\r\n")}}).get()}});f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.bind(b,a)}});f.each(["get","post"],function(a,c){f[c]=function(a,
d,e,h){f.isFunction(d)&&(h=h||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:h})}});f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?m(a,f.ajaxSettings):(b=a,a=f.ajaxSettings);m(a,b);return a},ajaxSettings:{url:ha,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(ia[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",
html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Vb},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:s(Ya),ajaxTransport:s(Ub),ajax:function(a,c){function d(a,c,j,A){if(2!==t){t=2;aa&&clearTimeout(aa);q=b;s=A||"";J.readyState=0<a?4:0;var v,G,n,A=c;if(j){var u=e,L=J,x=u.contents,
H=u.dataTypes,da=u.responseFields,M,w,ba,P;for(w in da)w in j&&(L[da[w]]=j[w]);for(;"*"===H[0];)H.shift(),M===b&&(M=u.mimeType||L.getResponseHeader("content-type"));if(M)for(w in x)if(x[w]&&x[w].test(M)){H.unshift(w);break}if(H[0]in j)ba=H[0];else{for(w in j){if(!H[0]||u.converters[w+" "+H[0]]){ba=w;break}P||(P=w)}ba=ba||P}ba?(ba!==H[0]&&H.unshift(ba),j=j[ba]):j=void 0}else j=b;if(200<=a&&300>a||304===a){if(e.ifModified){if(M=J.getResponseHeader("Last-Modified"))f.lastModified[p]=M;if(M=J.getResponseHeader("Etag"))f.etag[p]=
M}if(304===a)A="notmodified",v=!0;else try{M=e;M.dataFilter&&(j=M.dataFilter(j,M.dataType));var T=M.dataTypes;w={};var B,D,ca=T.length,S,F=T[0],K,C,U,E,I;for(B=1;B<ca;B++){if(1===B)for(D in M.converters)"string"==typeof D&&(w[D.toLowerCase()]=M.converters[D]);K=F;F=T[B];if("*"===F)F=K;else if("*"!==K&&K!==F){C=K+" "+F;U=w[C]||w["* "+F];if(!U)for(E in I=b,w)if(S=E.split(" "),S[0]===K||"*"===S[0])if(I=w[S[1]+" "+F]){E=w[E];!0===E?U=I:!0===I&&(U=E);break}!U&&!I&&f.error("No conversion from "+C.replace(" ",
" to "));!0!==U&&(j=U?U(j):I(E(j)))}}G=j;A="success";v=!0}catch(la){A="parsererror",n=la}}else if(n=A,!A||a)A="error",0>a&&(a=0);J.status=a;J.statusText=""+(c||A);v?i.resolveWith(h,[G,A,J]):i.rejectWith(h,[J,A,n]);J.statusCode(m);m=b;y&&g.trigger("ajax"+(v?"Success":"Error"),[J,e,v?G:n]);k.resolveWith(h,[J,A]);y&&(g.trigger("ajaxComplete",[J,e]),--f.active||f.event.trigger("ajaxStop"))}}"object"==typeof a&&(c=a,a=b);var c=c||{},e=f.ajaxSetup({},c),h=e.context||e,g=h!==e&&(h.nodeType||h instanceof
f)?f(h):f.event,i=f.Deferred(),k=f._Deferred(),m=e.statusCode||{},p,A={},v={},s,u,q,aa,x,t=0,y,H,J={readyState:0,setRequestHeader:function(a,b){if(!t){var c=a.toLowerCase(),a=v[c]=v[c]||a;A[a]=b}return this},getAllResponseHeaders:function(){return 2===t?s:null},getResponseHeader:function(a){var c;if(2===t){if(!u)for(u={};c=Rc.exec(s);)u[c[1].toLowerCase()]=c[2];c=u[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){t||(e.mimeType=a);return this},abort:function(a){a=a||"abort";q&&q.abort(a);
d(0,a);return this}};i.promise(J);J.success=J.done;J.error=J.fail;J.complete=k.done;J.statusCode=function(a){if(a){var b;if(2>t)for(b in a)m[b]=[m[b],a[b]];else b=a[J.status],J.then(b,b)}return this};e.url=((a||e.url)+"").replace(Qc,"").replace(Uc,ia[1]+"//");e.dataTypes=f.trim(e.dataType||"*").toLowerCase().split(qb);null==e.crossDomain&&(x=Sb.exec(e.url.toLowerCase()),e.crossDomain=!(!x||x[1]==ia[1]&&x[2]==ia[2]&&(x[3]||("http:"===x[1]?80:443))==(ia[3]||("http:"===ia[1]?80:443))));e.data&&e.processData&&
"string"!=typeof e.data&&(e.data=f.param(e.data,e.traditional));n(Ya,e,c,J);if(2===t)return!1;y=e.global;e.type=e.type.toUpperCase();e.hasContent=!Tc.test(e.type);y&&0===f.active++&&f.event.trigger("ajaxStart");if(!e.hasContent&&(e.data&&(e.url+=(Rb.test(e.url)?"&":"?")+e.data,delete e.data),p=e.url,!1===e.cache)){x=f.now();var da=e.url.replace(Xc,"$1_="+x);e.url=da+(da===e.url?(Rb.test(e.url)?"&":"?")+"_="+x:"")}(e.data&&e.hasContent&&!1!==e.contentType||c.contentType)&&J.setRequestHeader("Content-Type",
e.contentType);e.ifModified&&(p=p||e.url,f.lastModified[p]&&J.setRequestHeader("If-Modified-Since",f.lastModified[p]),f.etag[p]&&J.setRequestHeader("If-None-Match",f.etag[p]));J.setRequestHeader("Accept",e.dataTypes[0]&&e.accepts[e.dataTypes[0]]?e.accepts[e.dataTypes[0]]+("*"!==e.dataTypes[0]?", "+Vb+"; q=0.01":""):e.accepts["*"]);for(H in e.headers)J.setRequestHeader(H,e.headers[H]);if(e.beforeSend&&(!1===e.beforeSend.call(h,J,e)||2===t))return J.abort(),!1;for(H in{success:1,error:1,complete:1})J[H](e[H]);
if(q=n(Ub,e,c,J)){J.readyState=1;y&&g.trigger("ajaxSend",[J,e]);e.async&&0<e.timeout&&(aa=setTimeout(function(){J.abort("timeout")},e.timeout));try{t=1,q.send(A,d)}catch(M){2>t?d(-1,M):f.error(M)}}else d(-1,"No Transport");return J},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var h in a)k(h,
a[h],c,e);return d.join("&").replace(Pc,"+")}});f.extend({active:0,lastModified:{},etag:{}});var Yc=f.now(),Va=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+Yc++}});f.ajaxPrefilter("json jsonp",function(b,c,d){c="application/x-www-form-urlencoded"===b.contentType&&"string"==typeof b.data;if("jsonp"===b.dataTypes[0]||!1!==b.jsonp&&(Va.test(b.url)||c&&Va.test(b.data))){var e,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,
g=a[h],i=b.url,k=b.data,m="$1"+h+"$2";!1!==b.jsonp&&(i=i.replace(Va,m),b.url===i&&(c&&(k=k.replace(Va,m)),b.data===k&&(i+=(/\?/.test(i)?"&":"?")+b.jsonp+"="+h)));b.url=i;b.data=k;a[h]=function(a){e=[a]};d.always(function(){a[h]=g;e&&f.isFunction(g)&&a[h](e[0])});b.converters["script json"]=function(){e||f.error(h+" was not called");return e[0]};b.dataTypes[0]="json";return"script"}});f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}});f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1);a.crossDomain&&(a.type="GET",a.global=!1)});f.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=q.head||q.getElementsByTagName("head")[0]||q.documentElement;return{send:function(e,f){c=q.createElement("script");c.async="async";a.scriptCharset&&(c.charset=a.scriptCharset);c.src=a.url;c.onload=c.onreadystatechange=function(a,
e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||f(200,"success")};d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var nb=a.ActiveXObject?function(){for(var a in sa)sa[a](0,1)}:!1,Zc=0,sa;f.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&h()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:h;var ob=f.ajaxSettings.xhr();f.extend(f.support,
{ajax:!!ob,cors:!!ob&&"withCredentials"in ob});f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,h){var g=c.xhr(),i,k;c.username?g.open(c.type,c.url,c.async,c.username,c.password):g.open(c.type,c.url,c.async);if(c.xhrFields)for(k in c.xhrFields)g[k]=c.xhrFields[k];c.mimeType&&g.overrideMimeType&&g.overrideMimeType(c.mimeType);!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(k in e)g.setRequestHeader(k,
e[k])}catch(m){}g.send(c.hasContent&&c.data||null);d=function(a,e){var k,m,p,A,v;try{if(d&&(e||4===g.readyState))if(d=b,i&&(g.onreadystatechange=f.noop,nb&&delete sa[i]),e)4!==g.readyState&&g.abort();else{k=g.status;p=g.getAllResponseHeaders();A={};(v=g.responseXML)&&v.documentElement&&(A.xml=v);A.text=g.responseText;try{m=g.statusText}catch(n){m=""}!k&&c.isLocal&&!c.crossDomain?k=A.text?200:404:1223===k&&(k=204)}}catch(s){e||h(-1,s)}A&&h(k,m,A,p)};!c.async||4===g.readyState?d():(i=++Zc,nb&&(sa||
(sa={},f(a).unload(nb)),sa[i]=d),g.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var Xa={},Z,ja,$c=/^(?:toggle|show|hide)$/,ad=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,Wa,pb=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],Ca;f.fn.extend({show:function(a,b,c){var h;if(a||0===a)return this.animate(e("show",3),a,b,c);b=0;for(c=this.length;b<c;b++)a=this[b],a.style&&(h=a.style.display,!f._data(a,"olddisplay")&&
"none"===h&&(h=a.style.display=""),""===h&&"none"===f.css(a,"display")&&f._data(a,"olddisplay",d(a.nodeName)));for(b=0;b<c;b++)if(a=this[b],a.style&&(h=a.style.display,""===h||"none"===h))a.style.display=f._data(a,"olddisplay")||"";return this},hide:function(a,b,c){if(a||0===a)return this.animate(e("hide",3),a,b,c);a=0;for(b=this.length;a<b;a++)this[a].style&&(c=f.css(this[a],"display"),"none"!==c&&!f._data(this[a],"olddisplay")&&f._data(this[a],"olddisplay",c));for(a=0;a<b;a++)this[a].style&&(this[a].style.display=
"none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d="boolean"==typeof a;f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):null==a||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(e("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,e){var h=f.speed(b,c,e);if(f.isEmptyObject(a))return this.each(h.complete,
[!1]);a=f.extend({},a);return this[!1===h.queue?"each":"queue"](function(){!1===h.queue&&f._mark(this);var b=f.extend({},h),c=1===this.nodeType,e=c&&f(this).is(":hidden"),g,i,k,m,p,A,v,n;b.animatedProperties={};for(k in a){g=f.camelCase(k);k!==g&&(a[g]=a[k],delete a[k]);i=a[g];f.isArray(i)?(b.animatedProperties[g]=i[1],i=a[g]=i[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if("hide"===i&&e||"show"===i&&!e)return b.complete.call(this);c&&("height"===g||"width"===
g)&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===f.css(this,"display")&&"none"===f.css(this,"float")&&(f.support.inlineBlockNeedsLayout?(m=d(this.nodeName),"inline"===m?this.style.display="inline-block":(this.style.display="inline",this.style.zoom=1)):this.style.display="inline-block"))}null!=b.overflow&&(this.style.overflow="hidden");for(k in a)c=new f.fx(this,b,k),i=a[k],$c.test(i)?c["toggle"===i?e?"show":"hide":i]():(p=ad.exec(i),A=c.cur(),p?(v=parseFloat(p[2]),
n=p[3]||(f.cssNumber[k]?"":"px"),"px"!==n&&(f.style(this,k,(v||1)+n),A*=(v||1)/c.cur(),f.style(this,k,A+n)),p[1]&&(v=("-="===p[1]?-1:1)*v+A),c.custom(A,v,n)):c.custom(A,i,""));return!0})},stop:function(a,b){a&&this.queue([]);this.each(function(){var a=f.timers,c=a.length;for(b||f._unmark(!0,this);c--;)a[c].elem===this&&(b&&a[c](!0),a.splice(c,1))});b||this.dequeue();return this}});f.each({slideDown:e("show",1),slideUp:e("hide",1),slideToggle:e("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},
fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});f.extend({speed:function(a,b,c){var d=a&&"object"==typeof a?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;d.old=d.complete;d.complete=function(a){f.isFunction(d.old)&&d.old.call(this);!1!==d.queue?f.dequeue(this):
!1!==a&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+0.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b;this.elem=a;this.prop=c;b.orig=b.orig||{}}});f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(null!=this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];
var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||"auto"===b?0:b:a},custom:function(a,b,c){function d(a){return e.step(a)}var e=this,h=f.fx;this.startTime=Ca||i();this.start=a;this.end=b;this.unit=c||this.unit||(f.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;d.elem=this.elem;d()&&f.timers.push(d)&&!Wa&&(Wa=setInterval(h.tick,h.interval))},show:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop);this.options.show=!0;this.custom("width"===
this.prop||"height"===this.prop?1:0,this.cur());f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop);this.options.hide=!0;this.custom(this.cur(),0)},step:function(a){var b=Ca||i(),c=!0,d=this.elem,e=this.options,h,g;if(a||b>=e.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();e.animatedProperties[this.prop]=!0;for(h in e.animatedProperties)!0!==e.animatedProperties[h]&&(c=!1);if(c){null!=e.overflow&&!f.support.shrinkWrapBlocks&&
f.each(["","X","Y"],function(a,b){d.style["overflow"+b]=e.overflow[a]});e.hide&&f(d).hide();if(e.hide||e.show)for(var k in e.animatedProperties)f.style(d,k,e.orig[k]);e.complete.call(d)}return!1}Infinity==e.duration?this.now=b:(g=b-this.startTime,this.state=g/e.duration,this.pos=f.easing[e.animatedProperties[this.prop]](this.state,g,0,1,e.duration),this.now=this.start+(this.end-this.start)*this.pos);this.update();return!0}};f.extend(f.fx,{tick:function(){for(var a=f.timers,b=0;b<a.length;++b)a[b]()||
a.splice(b--,1);a.length||f.fx.stop()},interval:13,stop:function(){clearInterval(Wa);Wa=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&null!=a.elem.style[a.prop]?a.elem.style[a.prop]=("width"===a.prop||"height"===a.prop?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=a.now}}});f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var bd=
/^t(?:able|d|h)$/i,Wb=/^(?:body|html)$/i;"getBoundingClientRect"in q.documentElement?f.fn.offset=function(a){var b=this[0],d;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{d=b.getBoundingClientRect()}catch(e){}var h=b.ownerDocument,g=h.documentElement;if(!d||!f.contains(g,b))return d?{top:d.top,left:d.left}:{top:0,left:0};b=h.body;h=c(h);return{top:d.top+(h.pageYOffset||f.support.boxModel&&
g.scrollTop||b.scrollTop)-(g.clientTop||b.clientTop||0),left:d.left+(h.pageXOffset||f.support.boxModel&&g.scrollLeft||b.scrollLeft)-(g.clientLeft||b.clientLeft||0)}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);f.offset.initialize();var c,d=b.offsetParent,e=b.ownerDocument,h=e.documentElement,g=e.body;c=(e=e.defaultView)?e.getComputedStyle(b,null):
b.currentStyle;for(var i=b.offsetTop,k=b.offsetLeft;(b=b.parentNode)&&(b!==g&&b!==h)&&!(f.offset.supportsFixedPosition&&"fixed"===c.position);)c=e?e.getComputedStyle(b,null):b.currentStyle,i-=b.scrollTop,k-=b.scrollLeft,b===d&&(i+=b.offsetTop,k+=b.offsetLeft,f.offset.doesNotAddBorder&&(!f.offset.doesAddBorderForTableAndCells||!bd.test(b.nodeName))&&(i+=parseFloat(c.borderTopWidth)||0,k+=parseFloat(c.borderLeftWidth)||0),d=b.offsetParent),f.offset.subtractsBorderForOverflowNotVisible&&"visible"!==
c.overflow&&(i+=parseFloat(c.borderTopWidth)||0,k+=parseFloat(c.borderLeftWidth)||0);if("relative"===c.position||"static"===c.position)i+=g.offsetTop,k+=g.offsetLeft;f.offset.supportsFixedPosition&&"fixed"===c.position&&(i+=Math.max(h.scrollTop,g.scrollTop),k+=Math.max(h.scrollLeft,g.scrollLeft));return{top:i,left:k}};f.offset={initialize:function(){var a=q.body,b=q.createElement("div"),c,d,e,h=parseFloat(f.css(a,"marginTop"))||0;f.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,
width:"1px",height:"1px",visibility:"hidden"});b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";a.insertBefore(b,a.firstChild);c=b.firstChild;d=c.firstChild;e=c.nextSibling.firstChild.firstChild;this.doesNotAddBorder=5!==d.offsetTop;this.doesAddBorderForTableAndCells=
5===e.offsetTop;d.style.position="fixed";d.style.top="20px";this.supportsFixedPosition=20===d.offsetTop||15===d.offsetTop;d.style.position=d.style.top="";c.style.overflow="hidden";c.style.position="relative";this.subtractsBorderForOverflowNotVisible=-5===d.offsetTop;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==h;a.removeChild(b);f.offset.initialize=f.noop},bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.offset.initialize();f.offset.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,
"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");"static"===d&&(a.style.position="relative");var e=f(a),h=e.offset(),g=f.css(a,"top"),i=f.css(a,"left"),k={},m={},p,A;("absolute"===d||"fixed"===d)&&-1<f.inArray("auto",[g,i])?(m=e.position(),p=m.top,A=m.left):(p=parseFloat(g)||0,A=parseFloat(i)||0);f.isFunction(b)&&(b=b.call(a,c,h));null!=b.top&&(k.top=b.top-h.top+p);null!=b.left&&(k.left=b.left-h.left+A);"using"in b?
b.using.call(a,k):e.css(k)}};f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=Wb.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0;c.left-=parseFloat(f.css(a,"marginLeft"))||0;d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0;d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||
q.body;a&&!Wb.test(a.nodeName)&&"static"===f.css(a,"position");)a=a.offsetParent;return a})}});f.each(["Left","Top"],function(a,d){var e="scroll"+d;f.fn[e]=function(d){var h,g;return d===b?(h=this[0],!h?null:(g=c(h))?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[e]||g.document.body[e]:h[e]):this.each(function(){(g=c(this))?g.scrollTo(a?f(g).scrollLeft():d,a?d:f(g).scrollTop()):this[e]=d})}});f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();
f.fn["inner"+c]=function(){var a=this[0];return a&&a.style?parseFloat(f.css(a,d,"padding")):null};f.fn["outer"+c]=function(a){var b=this[0];return b&&b.style?parseFloat(f.css(b,d,a?"margin":"border")):null};f.fn[d]=function(a){var e=this[0];if(!e)return null==a?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var h=e.document.documentElement["client"+c],g=e.document.body;return"CSS1Compat"===e.document.compatMode&&h||g&&g["client"+
c]||h}return 9===e.nodeType?Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]):a===b?(e=f.css(e,d),h=parseFloat(e),f.isNaN(h)?e:h):this.css(d,"string"==typeof a?a:a+"px")}});a.jQuery=a.$=f})(window);
(function(a){function b(){var b;b=a(this);if(!b.data("timeago")){b.data("timeago",{datetime:d.datetime(b)});var g=a.trim(b.text());0<g.length&&b.attr("title",g)}b=b.data("timeago");isNaN(b.datetime)||a(this).text(c(b.datetime));return this}function c(a){return d.inWords((new Date).getTime()-a.getTime())}a.timeago=function(b){return b instanceof Date?c(b):"string"===typeof b?c(a.timeago.parse(b)):c(a.timeago.datetime(b))};var d=a.timeago;a.extend(a.timeago,{settings:{refreshMillis:6E4,allowFuture:!1,
strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},inWords:function(b){function c(h,g){return(a.isFunction(h)?h(g,b):h).replace(/%d/i,d.numbers&&d.numbers[g]||g)}var d=this.settings.strings,h=d.prefixAgo,k=d.suffixAgo;this.settings.allowFuture&&
(0>b&&(h=d.prefixFromNow,k=d.suffixFromNow),b=Math.abs(b));var m=b/1E3,n=m/60,s=n/60,u=s/24,x=u/365,m=45>m&&c(d.seconds,Math.round(m))||90>m&&c(d.minute,1)||45>n&&c(d.minutes,Math.round(n))||90>n&&c(d.hour,1)||24>s&&c(d.hours,Math.round(s))||48>s&&c(d.day,1)||30>u&&c(d.days,Math.floor(u))||60>u&&c(d.month,1)||365>u&&c(d.months,Math.floor(u/30))||2>x&&c(d.year,1)||c(d.years,Math.floor(x));return a.trim([h,m,k].join(" "))},parse:function(b){b=a.trim(b);b=b.replace(/\.\d\d\d+/,"");b=b.replace(/-/,"/").replace(/-/,
"/");b=b.replace(/T/," ").replace(/Z/," UTC");b=b.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(b)},datetime:function(b){b="time"===a(b).get(0).tagName.toLowerCase()?a(b).attr("datetime"):a(b).attr("title");return d.parse(b)}});a.fn.timeago=function(){var a=this;a.each(b);var c=d.settings;0<c.refreshMillis&&setInterval(function(){a.each(b)},c.refreshMillis);return a};document.createElement("abbr");document.createElement("time")})(jQuery);
(function(a){function b(b,c,d,e){e={data:e||0===e||!1===e?e:c?c.data:{},_wrap:c?c._wrap:null,tmpl:null,parent:c||null,nodes:[],calls:k,nest:m,wrap:n,html:s,update:u};b&&a.extend(e,b,{nodes:[],parent:c});d&&(e.tmpl=d,e._ctnt=e._ctnt||e.tmpl(a,e),e.key=++Q,(R.length?D:w)[Q]=e);return e}function c(b,e,g){var i,g=g?a.map(g,function(a){return"string"===typeof a?b.key?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+B+'="'+b.key+'" $2'):a:c(a,b,a._ctnt)}):b;if(e)return g;g=g.join("");g.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(b,c,e,f){i=a(e).get();h(i);c&&(i=d(c).concat(i));f&&(i=i.concat(d(f)))});return i?i:d(g)}function d(b){var c=document.createElement("div");c.innerHTML=b;return a.makeArray(c.childNodes)}function e(b){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(b,c,d,e,h,g,f){b=a.tmpl.tag[d];if(!b)throw"Unknown template tag: "+d;d=b._default||[];g&&!/\w$/.test(h)&&(h+=g,g="");h?(h=i(h),f=f?","+i(f)+")":g?")":"",f=g?-1<h.indexOf(".")?h+i(g):"("+h+").call($item"+f:h,g=g?f:"(typeof("+h+")==='function'?("+h+").call($item):("+h+"))"):g=f=d.$1||"null";e=i(e);return"');"+b[c?"close":"open"].split("$notnull_1").join(h?"typeof("+h+")!=='undefined' && ("+h+")!=null":"true").split("$1a").join(g).split("$1").join(f).split("$2").join(e||d.$2||"")+"__.push('"})+
"');}return __;")}function g(b,d){b._wrap=c(b,!0,a.isArray(d)?d:[F.test(d)?d:a(d).html()]).join("")}function i(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function h(c){function d(c){function f(a){a+=e;k=i[a]=i[a]||b(k,w[k.parent.key+e]||k.parent)}var h,g=c,k,m;if(m=c.getAttribute(B)){for(;g.parentNode&&1===(g=g.parentNode).nodeType&&!(h=g.getAttribute(B)););if(h!==m){g=g.parentNode?11===g.nodeType?0:g.getAttribute(B)||0:0;if(!(k=w[m]))k=D[m],k=b(k,w[g]||D[g]),k.key=++Q,w[Q]=k;N&&
f(m)}c.removeAttribute(B)}else if(N&&(k=a.data(c,"tmplItem")))f(k.key),w[k.key]=k,g=(g=a.data(c.parentNode,"tmplItem"))?g.key:0;if(k){for(h=k;h&&h.key!=g;)h.nodes.push(c),h=h.parent;delete k._ctnt;delete k._wrap;a.data(c,"tmplItem",k)}}var e="_"+N,h,g,i={},k,f,m;k=0;for(f=c.length;k<f;k++)if(1===(h=c[k]).nodeType){g=h.getElementsByTagName("*");for(m=g.length-1;0<=m;m--)d(g[m]);d(h)}}function k(a,b,c,d){if(!a)return R.pop();R.push({_:a,tmpl:b,item:this,data:c,options:d})}function m(b,c,d){return a.tmpl(a.template(b),
c,d,this)}function n(b,c){var d=b.options||{};d.wrapped=c;return a.tmpl(a.template(b.tmpl),b.data,d,b.item)}function s(b,c){var d=this._wrap;return a.map(a(a.isArray(d)?d.join(""):d).filter(b||"*"),function(a){if(c)a=a.innerText||a.textContent;else{var b;if(!(b=a.outerHTML))b=document.createElement("div"),b.appendChild(a.cloneNode(!0)),b=b.innerHTML;a=b}return a})}function u(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]);a(b).remove()}var x=a.fn.domManip,B="_tmplitem",F=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,
w={},D={},K,O={key:0,data:{}},Q=0,N=0,R=[];a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){a.fn[b]=function(d){var e=[],d=a(d),h,g,i;h=1===this.length&&this[0].parentNode;K=w||{};if(h&&11===h.nodeType&&1===h.childNodes.length&&1===d.length)d[c](this[0]),e=this;else{g=0;for(i=d.length;g<i;g++)N=g,h=(0<g?this.clone(!0):this).get(),a(d[g])[c](h),e=e.concat(h);N=0;e=this.pushStack(e,b,d.selector)}d=K;K=null;a.tmpl.complete(d);
return e}});a.fn.extend({tmpl:function(b,c,d){return a.tmpl(this[0],b,c,d)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(b,c,d,e){if(b[0]&&a.isArray(b[0])){for(var h=a.makeArray(arguments),g=b[0],i=g.length,f=0,k;f<i&&!(k=a.data(g[f++],"tmplItem")););k&&N&&(h[2]=function(b){a.tmpl.afterManip(this,b,d)});x.apply(this,h)}else x.apply(this,arguments);N=0;K||a.tmpl.complete(w);return this}});a.extend({tmpl:function(d,e,h,i){var k=
!i;if(k)i=O,d=a.template[d]||a.template(null,d),D={};else if(!d)return d=i.tmpl,w[i.key]=i,i.nodes=[],i.wrapped&&g(i,i.wrapped),a(c(i,null,i.tmpl(a,i)));if(!d)return[];"function"===typeof e&&(e=e.call(i||{}));h&&h.wrapped&&g(h,h.wrapped);e=a.isArray(e)?a.map(e,function(a){return a?b(h,i,d,a):null}):[b(h,i,d,e)];return k?a(c(i,null,e)):e},tmplItem:function(b){var c;for(b instanceof a&&(b=b[0]);b&&1===b.nodeType&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode););return c||O},template:function(b,c){return c?
("string"===typeof c?c=e(c):c instanceof a&&(c=c[0]||{}),c.nodeType&&(c=a.data(c,"tmpl")||a.data(c,"tmpl",e(c.innerHTML))),"string"===typeof b?a.template[b]=c:c):b?"string"!==typeof b?a.template(null,b):a.template[b]||a.template(null,F.test(b)?b:a(b)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},
open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){w={}},afterManip:function(b,
c,d){var e=11===c.nodeType?a.makeArray(c.childNodes):1===c.nodeType?[c]:[];d.call(b,c);h(e);N++}})})(jQuery);
(function(a,b,c){function d(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}var e=document,g,i=a.event.special,h=e.documentMode,k="onhashchange"in b&&(h===c||7<h);a.fn.hashchange=function(a){return a?this.bind("hashchange",a):this.trigger("hashchange")};a.fn.hashchange.delay=50;i.hashchange=a.extend(i.hashchange,{setup:function(){if(k)return!1;a(g.start)},teardown:function(){if(k)return!1;a(g.stop)}});var m=function(){var c=d(),e=x(s);c!==s?(u(s=c,e),a(b).trigger("hashchange")):e!==
s&&(location.href=location.href.replace(/#.*/,"")+e);n=setTimeout(m,a.fn.hashchange.delay)},i={},n,s=d(),u=h=function(a){return a},x=h;i.start=function(){n||m()};i.stop=function(){n&&clearTimeout(n);n=c};if(a.browser.msie&&!k){var B,F;i.start=function(){B||(F=(F=a.fn.hashchange.src)&&F+d(),B=a('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){F||u(d());m()}).attr("src",F||"javascript:0").insertAfter("body")[0].contentWindow,e.onpropertychange=function(){try{"title"===event.propertyName&&
(B.document.title=e.title)}catch(a){}})};i.stop=h;x=function(){return d(B.location.href)};u=function(b,c){var d=B.document,h=a.fn.hashchange.domain;b!==c&&(d.title=e.title,d.open(),h&&d.write('<script>document.domain="'+h+'"<\/script>'),d.close(),B.location.hash=b)}}g=i})(jQuery,this);jQuery.expr[":"].Contains=function(a,b,c){return 0<=jQuery(a).text().toUpperCase().indexOf(c[3].toUpperCase())};
(function(a){function b(b,c,d){var h=this,m,n,s,u={},x=!1;this.settings=d;this.temp=this.val=this.values=null;this.setDefaults=function(b){a.extend(y,b)};this.enable=function(){d.disabled=!1;a(b).is(":input")&&a(b).prop("disabled",!1)};this.scroll=function(a,b,c,d,e){a.attr("style",(c?Q+"-transition:all "+c.toFixed(1)+"s ease-out;":"")+(O?Q+"-transform:translate3d(0,"+b*g+"px,0);":"top:"+b*g+"px;"));if(c){var h=0;clearInterval(u[e]);u[e]=setInterval(function(){h+=0.1;a.data("pos",Math.round((b-d)*
Math.sin(h/c*(Math.PI/2))+d));h>=c&&(clearInterval(u[e]),a.data("pos",b))},100)}else a.data("pos",b)};this.disable=function(){d.disabled=!0;a(b).is(":input")&&a(b).prop("disabled",!0)};this.formatDate=function(b,c,d){if(!c)return null;for(var d=a.extend({},this.settings,d),e=function(a){for(var c=0;i+1<b.length&&b.charAt(i+1)==a;)c++,i++;return c},h=function(a,b,c){b=""+b;if(e(a))for(;b.length<c;)b="0"+b;return b},f="",g=!1,i=0;i<b.length;i++)if(g)"'"==b.charAt(i)&&!e("'")?g=!1:f+=b.charAt(i);else switch(b.charAt(i)){case "d":f+=
h("d",c.getDate(),2);break;case "D":var k;k=c.getDay();var m=d.dayNamesShort,n=d.dayNames;k=e("D")?n[k]:m[k];f+=k;break;case "o":f+=h("o",(c.getTime()-(new Date(c.getFullYear(),0,0)).getTime())/864E5,3);break;case "m":f+=h("m",c.getMonth()+1,2);break;case "M":k=c.getMonth();m=d.monthNamesShort;n=d.monthNames;k=e("M")?n[k]:m[k];f+=k;break;case "y":f+=e("y")?c.getFullYear():(10>c.getYear()%100?"0":"")+c.getYear()%100;break;case "h":k=c.getHours();f+=h("h",12<k?k-12:0==k?12:k,2);break;case "H":f+=h("H",
c.getHours(),2);break;case "i":f+=h("i",c.getMinutes(),2);break;case "s":f+=h("s",c.getSeconds(),2);break;case "a":f+=11<c.getHours()?"pm":"am";break;case "A":f+=11<c.getHours()?"PM":"AM";break;case "'":e("'")?f+="'":g=!0;break;default:f+=b.charAt(i)}return f};this.parseDate=function(b,c,d){var e=new Date;if(!b||!c)return e;for(var c="object"==typeof c?c.toString():c+"",h=a.extend({},this.settings,d),d=e.getFullYear(),f=e.getMonth()+1,g=e.getDate(),i=-1,k=e.getHours(),m=e.getMinutes(),e=e.getSeconds(),
n=-1,s=!1,u=function(a){(a=v+1<b.length&&b.charAt(v+1)==a)&&v++;return a},x=function(a){u(a);a=RegExp("^\\d{1,"+("@"==a?14:"!"==a?20:"y"==a?4:"o"==a?3:2)+"}");a=c.substr(w).match(a);if(!a)throw"Missing number at position "+w;w+=a[0].length;return parseInt(a[0],10)},t=function(a,b,d){a=u(a)?d:b;for(b=0;b<a.length;b++)if(c.substr(w,a[b].length).toLowerCase()==a[b].toLowerCase())return w+=a[b].length,b+1;throw"Unknown name at position "+w;},q=function(){if(c.charAt(w)!=b.charAt(v))throw"Unexpected literal at position "+
w;w++},w=0,v=0;v<b.length;v++)if(s)"'"==b.charAt(v)&&!u("'")?s=!1:q();else switch(b.charAt(v)){case "d":g=x("d");break;case "D":t("D",h.dayNamesShort,h.dayNames);break;case "o":i=x("o");break;case "m":f=x("m");break;case "M":f=t("M",h.monthNamesShort,h.monthNames);break;case "y":d=x("y");break;case "H":k=x("H");break;case "h":k=x("h");break;case "i":m=x("i");break;case "s":e=x("s");break;case "a":n=t("a",["am","pm"],["am","pm"])-1;break;case "A":n=t("A",["am","pm"],["am","pm"])-1;break;case "'":u("'")?
q():s=!0;break;default:q()}100>d&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=h.shortYearCutoff?0:-100));if(-1<i){f=1;g=i;do{h=32-(new Date(d,f-1,32)).getDate();if(g<=h)break;f++;g-=h}while(1)}k=new Date(d,f-1,g,-1==n?k:n&&12>k?k+12:!n&&12==k?0:k,m,e);if(k.getFullYear()!=d||k.getMonth()+1!=f||k.getDate()!=g)throw"Invalid date";return k};this.setValue=function(c){void 0==c&&(c=!0);var d=this.formatResult();this.val=d;this.values=this.temp.slice(0);c&&a(b).is(":input")&&a(b).val(d).change()};
this.getDate=function(){var a=this.values;if("date"==d.preset)return new Date(a[m],a[n],a[s]);if("time"==d.preset){var b=d.ampm?"PM"==a[d.seconds?3:2]&&12>a[0]-0?a[0]-0+12:"AM"==a[d.seconds?3:2]&&12==a[0]?0:a[0]:a[0];return new Date(1970,0,1,b,a[1],d.seconds?a[2]:null)}if("datetime"==d.preset)return b=d.ampm?"PM"==a[d.seconds?6:5]&&12>a[3]-0?a[3]-0+12:"AM"==a[d.seconds?6:5]&&12==a[3]?0:a[3]:a[3],new Date(a[m],a[n],a[s],b,a[4],d.seconds?a[5]:null)};this.setDate=function(a,b){d.preset.match(/date/i)&&
(this.temp[m]=a.getFullYear(),this.temp[n]=a.getMonth(),this.temp[s]=a.getDate());if("time"==d.preset){var c=a.getHours();this.temp[0]=d.ampm?12<c?c-12:0==c?12:c:c;this.temp[1]=a.getMinutes();d.seconds&&(this.temp[2]=a.getSeconds());d.ampm&&(this.temp[d.seconds?3:2]=11<c?"PM":"AM")}"datetime"==d.preset&&(c=a.getHours(),this.temp[3]=d.ampm?12<c?c-12:0==c?12:c:c,this.temp[4]=a.getMinutes(),d.seconds&&(this.temp[5]=a.getSeconds()),d.ampm&&(this.temp[d.seconds?6:5]=11<c?"PM":"AM"));this.setValue(b)};
this.parseValue=function(a){if(this.preset){var b=[];if("date"==d.preset){try{var c=this.parseDate(d.dateFormat,a,d)}catch(e){c=new Date}b[m]=c.getFullYear();b[n]=c.getMonth();b[s]=c.getDate()}else if("time"==d.preset){try{c=this.parseDate(d.timeFormat,a,d)}catch(h){c=new Date}a=c.getHours();b[0]=d.ampm?12<a?a-12:0==a?12:a:a;b[1]=c.getMinutes();d.seconds&&(b[2]=c.getSeconds());d.ampm&&(b[d.seconds?3:2]=11<a?"PM":"AM")}else if("datetime"==d.preset){try{c=this.parseDate(d.dateFormat+" "+d.timeFormat,
a,d)}catch(f){c=new Date}a=c.getHours();b[m]=c.getFullYear();b[n]=c.getMonth();b[s]=c.getDate();b[3]=d.ampm?12<a?a-12:0==a?12:a:a;b[4]=c.getMinutes();d.seconds&&(b[5]=c.getSeconds());d.ampm&&(b[d.seconds?6:5]=11<a?"PM":"AM")}return b}return d.parseValue(a,this)};this.formatResult=function(){var a=this.temp;if(this.preset){if("date"==d.preset)return this.formatDate(d.dateFormat,new Date(a[m],a[n],a[s]),d);if("datetime"==d.preset){var b=d.ampm?"PM"==a[d.seconds?6:5]&&12>a[3]-0?a[3]-0+12:"AM"==a[d.seconds?
6:5]&&12==a[3]?0:a[3]:a[3];return this.formatDate(d.dateFormat+" "+d.timeFormat,new Date(a[m],a[n],a[s],b,a[4],d.seconds?a[5]:null),d)}if("time"==d.preset)return b=d.ampm?"PM"==a[d.seconds?3:2]&&12>a[0]-0?a[0]-0+12:"AM"==a[d.seconds?3:2]&&12==a[0]?0:a[0]:a[0],this.formatDate(d.timeFormat,new Date(1970,0,1,b,a[1],d.seconds?a[2]:null),d)}return d.formatResult(a)};this.validate=function(b){if(this.preset&&d.preset.match(/date/i)&&(b==m||b==n||-1==b)){var b=32-(new Date(this.temp[m],this.temp[n],32)).getDate()-
1,e=a("ul:eq("+s+")",c);a("li",e).show();a("li:gt("+b+")",e).hide();this.temp[s]>b&&(this.scroll(e,i-b-1),this.temp[s]=a("li:eq("+b+")",e).data("val"))}else d.validate(b)};this.hide=function(){if(!1===d.onClose(this.val,this))return!1;a(".dwtd").prop("disabled",!1).removeClass("dwtd");a(b).blur();c.hide();e.hide();x=!1;this.preset&&(d.wheels=null);a(window).unbind("resize.dw")};this.show=function(){if(d.disabled||x)return!1;d.beforeShow(b,this);g=d.height;i=Math.round(d.rows/2);k=this;this.init();
if(this.preset){d.wheels=[];if(d.preset.match(/date/i)){for(var u={},w=0;3>w;w++)if(w==m){u[d.yearText]={};for(var p=d.startYear;p<=d.endYear;p++)u[d.yearText][p]=0>d.dateOrder.search(/yy/i)?p.toString().substr(2,2):p.toString()}else if(w==n){u[d.monthText]={};for(p=0;12>p;p++)u[d.monthText][p]=0>d.dateOrder.search(/MM/)?0>d.dateOrder.search(/M/)?0>d.dateOrder.search(/mm/)?p+1:9>p?"0"+(p+1):p+1:d.monthNamesShort[p]:d.monthNames[p]}else if(w==s){u[d.dayText]={};for(p=1;32>p;p++)u[d.dayText][p]=0>d.dateOrder.search(/dd/i)?
p:10>p?"0"+p:p}d.wheels.push(u)}if(d.preset.match(/time/i)){d.stepHour=1>d.stepHour?1:parseInt(d.stepHour);d.stepMinute=1>d.stepMinute?1:parseInt(d.stepMinute);d.stepSecond=1>d.stepSecond?1:parseInt(d.stepSecond);u={};u[d.hourText]={};for(p=d.ampm?1:0;p<(d.ampm?13:24);p+=d.stepHour)u[d.hourText][p]=10>p?"0"+p:p;u[d.minuteText]={};for(p=0;60>p;p+=d.stepMinute)u[d.minuteText][p]=10>p?"0"+p:p;if(d.seconds){u[d.secText]={};for(p=0;60>p;p+=d.stepSecond)u[d.secText][p]=10>p?"0"+p:p}d.ampm&&(u[d.ampmText]=
{},u[d.ampmText].AM="AM",u[d.ampmText].PM="PM");d.wheels.push(u)}}a(".dwc",c).remove();for(p=0;p<d.wheels.length;p++){var w=a('<div class="dwc'+("clickpick"==d.mode?" dwpm":"")+'"><div class="dwwc dwrc"><div class="clear" style="clear:both;"></div></div>').insertBefore(a(".dwbc",c)),aa;for(aa in d.wheels[p]){var u=a(".dwwc .clear",w),u=a('<div class="dwwl dwrc">'+("clickpick"==d.mode?'<div class="dwwb dwwbp">+</div><div class="dwwb dwwbm">&ndash;</div>':"")+'<div class="dwl">'+aa+'</div><div class="dww dwrc"><ul></ul><div class="dwwo"></div></div><div class="dwwol"></div></div>').insertBefore(u),
q;for(q in d.wheels[p][aa])a('<li class="val_'+q+'">'+d.wheels[p][aa][q]+"</li>").data("val",q).appendTo(a("ul",u))}}a(".dww ul",c).each(function(b){for(var c=a("li",this).index(a("li.val_"+h.temp[b],this));0>c&&0<=--h.temp[b];)c=a("li",this).index(a("li.val_"+h.temp[b],this));h.scroll(a(this),i-(0>c?0:c)-1)});a(".dwv",c).html(this.formatResult());h.validate(-1);a("#dw_set",c).text(d.setText).unbind().bind("click",function(){h.setValue();d.onSelect(h.val,k);h.hide();return!1});a("#dw_cancel",c).text(d.cancelText).unbind().bind("click",
function(){d.onCancel(h.val,k);h.hide();return!1});a(":input:not(:disabled)").addClass("dwtd");a(":input").prop("disabled",!0);e.show();c.attr("class","dw "+d.theme).show();x=!0;a(".dww, .dwwl",c).height(d.rows*g);a(".dww",c).each(function(){a(this).width(a(this).parent().width()<d.width?d.width:a(this).parent().width())});a(".dwbc a",c).attr("class",d.btnClass);a(".dww li, .dwwb",c).css({height:g,lineHeight:g+"px"});a(".dwwc",c).each(function(){var b=0;a(".dwwl",this).each(function(){b+=a(this).outerWidth(!0)});
a(this).width(b)});a(".dwc",c).each(function(){a(this).width(a(".dwwc",this).outerWidth(!0))});this.pos();a(window).bind("resize.dw",function(){h.pos()})};this.pos=function(){var b=0,d=0,h=a(window).width(),g=a(window).height(),i=a(window).scrollTop(),k,m;a(".dwc",c).each(function(){k=a(this).outerWidth(!0);b+=k;d=k>d?k:d});k=b>h?d:b;c.width(k);k=c.outerWidth();m=c.outerHeight();c.css({left:(h-k)/2,top:i+(g-m)/2});e.height(0);e.height(a(document).height())};this.init=function(){var c=d.dateOrder.search(/y/i),
e=d.dateOrder.search(/m/i),h=d.dateOrder.search(/d/i);m=c<e?c<h?0:1:c<h?1:2;n=e<c?e<h?0:1:e<h?1:2;s=h<c?h<e?0:1:h<e?1:2;this.preset=null===d.wheels;this.temp=a(b).is("input")&&null!==this.val&&this.val!=a(b).val()||null===this.values?this.parseValue(a(b).val()?a(b).val():""):this.values.slice(0);this.setValue(!1)};this.init();a(b).is(":input")&&d.showOnFocus&&a(b).data("dwro",a(b).prop("readonly")).prop("readonly",!0);a(b).addClass("scroller").unbind("focus.dw").bind("focus.dw",function(){d.showOnFocus&&
h.show()})}function c(a){for(var b in a)if(void 0!==K[a[b]])return!0;return!1}var d,e,g,i,h,k,m={},n=new Date,s=n.getTime(),u=!1,x=null,B,F,w,D,K=document.createElement(K).style,O=c(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"])&&"webkitPerspective"in document.documentElement.style,Q;a:{var N=["Webkit","Moz","O","ms"],R;for(R in N)if(c([N[R]+"Transform"])){Q="-"+N[R].toLowerCase();break a}Q=""}var M="ontouchstart"in window,H=M?"touchstart":"mousedown",
S=M?"touchmove":"mousemove",T=M?"touchend":"mouseup",y={width:80,height:40,rows:3,disabled:!1,showOnFocus:!0,wheels:null,theme:"",mode:"scroller",preset:"date",dateFormat:"mm/dd/yy",dateOrder:"mmddy",ampm:!0,seconds:!1,timeFormat:"hh:ii A",startYear:n.getFullYear()-100,endYear:n.getFullYear()+1,monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),shortYearCutoff:"+10",monthText:"Month",dayText:"Day",yearText:"Year",hourText:"Hours",minuteText:"Minutes",secText:"Seconds",ampmText:"&nbsp;",setText:"Set",cancelText:"Cancel",btnClass:"dwb",stepHour:1,stepMinute:1,stepSecond:1,beforeShow:function(){},onClose:function(){},onSelect:function(){},onCancel:function(){},formatResult:function(a){for(var b="",c=0;c<a.length;c++)b+=(0<c?" ":"")+a[c];return b},parseValue:function(a,b){for(var c=b.settings.wheels,
d=a.split(" "),e=[],h=0,g=0;g<c.length;g++)for(var i in c[g]){h++;for(var k in c[g][i]){e.push(k);break}}return d.length==h?d:e},validate:function(){return!0}},q={init:function(c){void 0===c&&(c={});var f={};"ios"==c.theme&&(f.dateOrder="MMdyy",f.rows=5,f.height=30,f.width=55);"clickpick"==c.mode&&(f.height=50,f.rows=3);var n=a.extend({},y,f,c),t=!1,q=!1;if(a(".dw").length)e=a(".dwo"),d=a(".dw");else{e=a('<div class="dwo"></div>').hide().appendTo("body");d=a('<div class="dw"><div class="dwv">&nbsp;</div><div class="dwbc" style="clear:both;"><span class="dwbw dwb-s"><a id="dw_set" href="#"></a></span><span class="dwbw dwb-c"><a id="dw_cancel" href="#"></a></span></div></div>');
d.hide().appendTo("body");var K=function(b,c,e,f){var g=a("ul",d).index(b),c=c>i-1?i-1:c,c=c<i-h?i-h:c;k.scroll(b,c,e?c==f?0.1:Math.abs(0.1*(c-f)):0,f,g);k.temp[g]=a("li:eq("+(i-1-c)+")",b).data("val");k.validate(g);a(".dwv",d).html(k.formatResult())},N=function(a){if(t){var b=a.data("pos")-1,b=b<i-h?i-1:b;K(a,b)}else clearInterval(t)},O=function(a){if(q){var b=a.data("pos")+1,b=b>i-1?i-h:b;K(a,b)}else clearInterval(q)};a(document).bind(S,function(a){u&&(a.preventDefault(),F=M?a.originalEvent.changedTouches[0].pageY:
a.pageY,a=D+(F-B)/g,a=a>i-1+1?i-1+1:a,a=a<i-h-1?i-h-1:a,k.scroll(x,a))});a(document).bind(T,function(b){if(u){b.preventDefault();var c=new Date-w,b=D+(F-B)/g,b=b>i-1+1?i-1+1:b,b=b<i-h-1?i-h-1:b;300>c?(c=(F-B)/c,c=c*c/0.0012,0>F-B&&(c=-c)):c=F-B;K(x,Math.round(D+c/g),!0,Math.round(b));u=!1;x=null}clearInterval(t);clearInterval(q);q=t=!1;a(".dwb-a").removeClass("dwb-a")});d.delegate(".dwwl","DOMMouseScroll mousewheel",function(b){b.preventDefault();var b=b.originalEvent,c=b.wheelDelta?b.wheelDelta/
120:b.detail?-b.detail/3:0,b=a("ul",this),d=b.data("pos"),c=Math.round(d+c);h=a("li:visible",b).length;K(b,c)}).delegate(".dwb, .dwwb",H,function(){a(this).addClass("dwb-a")}).delegate(".dwwbp",H,function(b){b.preventDefault();var c=a(this).closest(".dwwl").find("ul");h=a("li:visible",c).length;clearInterval(t);t=setInterval(function(){N(c)},200);N(c)}).delegate(".dwwbm",H,function(b){b.preventDefault();var c=a(this).closest(".dwwl").find("ul");h=a("li:visible",c).length;clearInterval(q);q=setInterval(function(){O(c)},
200);O(c)}).delegate(".dwwl",H,function(b){!u&&"scroller"==k.settings.mode&&(b.preventDefault(),u=!0,x=a("ul",this),D=x.data("pos"),h=a("li:visible",x).length,B=M?b.originalEvent.changedTouches[0].pageY:b.pageY,w=new Date,F=B,k.scroll(x,D))})}return this.each(function(){this.id||(s+=1,this.id="scoller"+s);m[this.id]=new b(this,d,n)})},enable:function(){return this.each(function(){m[this.id]&&m[this.id].enable()})},disable:function(){return this.each(function(){m[this.id]&&m[this.id].disable()})},
isDisabled:function(){if(m[this[0].id])return m[this[0].id].settings.disabled},option:function(b,c){return this.each(function(){m[this.id]&&("object"===typeof b?a.extend(m[this.id].settings,b):m[this.id].settings[b]=c,m[this.id].init())})},setValue:function(a,b){void 0==b&&(b=!1);return this.each(function(){m[this.id]&&(m[this.id].temp=a,m[this.id].setValue(a,b))})},getValue:function(){if(m[this[0].id])return m[this[0].id].values},setDate:function(a,b){void 0==b&&(b=!1);return this.each(function(){m[this.id]&&
m[this.id].setDate(a,b)})},getDate:function(){if(m[this[0].id])return m[this[0].id].getDate()},show:function(){if(m[this[0].id])return m[this[0].id].show()},hide:function(){return this.each(function(){m[this.id]&&m[this.id].hide()})},destroy:function(){return this.each(function(){m[this.id]&&(a(this).unbind("focus.dw").removeClass("scroller"),a(this).is(":input")&&a(this).prop("readonly",a(this).data("dwro")),delete m[this.id])})}};a.fn.scroller=function(b){if(q[b])return q[b].apply(this,Array.prototype.slice.call(arguments,
1));if("object"===typeof b||!b)return q.init.apply(this,arguments);a.error("Unknown method")};a.scroller=new b(null,null,y)})(jQuery);
if(!Date||!Date.CultureInfo||""==Date.CultureInfo.name)Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),abbreviatedDayNames:"Sun Mon Tue Wed Thu Fri Sat".split(" "),shortestDayNames:"Su Mo Tu We Th Fr Sa".split(" "),firstLetterDayNames:"SMTWTFS".split(""),monthNames:"January February March April May June July August September October November December".split(" "),
abbreviatedMonthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},
regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,
yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",
offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};
(function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=function(a,b){b||(b=2);return("000"+a).slice(-1*b)};b.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};b.setTimeToNow=function(){var a=new Date;this.setHours(a.getHours());this.setMinutes(a.getMinutes());this.setSeconds(a.getSeconds());this.setMilliseconds(a.getMilliseconds());return this};a.today=function(){return(new Date).clearTime()};a.compare=function(a,b){if(isNaN(a)||isNaN(b))throw Error(a+
" - "+b);if(a instanceof Date&&b instanceof Date)return a<b?-1:a>b?1:0;throw new TypeError(a+" - "+b);};a.equals=function(a,b){return 0===a.compareTo(b)};a.getDayNumberFromName=function(a){for(var b=c.dayNames,d=c.abbreviatedDayNames,e=c.shortestDayNames,a=a.toLowerCase(),g=0;g<b.length;g++)if(b[g].toLowerCase()==a||d[g].toLowerCase()==a||e[g].toLowerCase()==a)return g;return-1};a.getMonthNumberFromName=function(a){for(var b=c.monthNames,d=c.abbreviatedMonthNames,a=a.toLowerCase(),e=0;e<b.length;e++)if(b[e].toLowerCase()==
a||d[e].toLowerCase()==a)return e;return-1};a.isLeapYear=function(a){return 0===a%4&&0!==a%100||0===a%400};a.getDaysInMonth=function(b,c){return[31,a.isLeapYear(b)?29:28,31,30,31,30,31,31,30,31,30,31][c]};a.getTimezoneAbbreviation=function(a){for(var b=c.timezones,d=0;d<b.length;d++)if(b[d].offset===a)return b[d].name;return null};a.getTimezoneOffset=function(a){for(var b=c.timezones,d=0;d<b.length;d++)if(b[d].name===a.toUpperCase())return b[d].offset;return null};b.clone=function(){return new Date(this.getTime())};
b.compareTo=function(a){return Date.compare(this,a)};b.equals=function(a){return Date.equals(this,a||new Date)};b.between=function(a,b){return this.getTime()>=a.getTime()&&this.getTime()<=b.getTime()};b.isAfter=function(a){return 1===this.compareTo(a||new Date)};b.isBefore=function(a){return-1===this.compareTo(a||new Date)};b.isToday=function(){return this.isSameDay(new Date)};b.isSameDay=function(a){return this.clone().clearTime().equals(a.clone().clearTime())};b.addMilliseconds=function(a){this.setMilliseconds(this.getMilliseconds()+
a);return this};b.addSeconds=function(a){return this.addMilliseconds(1E3*a)};b.addMinutes=function(a){return this.addMilliseconds(6E4*a)};b.addHours=function(a){return this.addMilliseconds(36E5*a)};b.addDays=function(a){this.setDate(this.getDate()+a);return this};b.addWeeks=function(a){return this.addDays(7*a)};b.addMonths=function(b){var c=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+b);this.setDate(Math.min(c,a.getDaysInMonth(this.getFullYear(),this.getMonth())));return this};b.addYears=
function(a){return this.addMonths(12*a)};b.add=function(a){if("number"==typeof a)return this._orient=a,this;a.milliseconds&&this.addMilliseconds(a.milliseconds);a.seconds&&this.addSeconds(a.seconds);a.minutes&&this.addMinutes(a.minutes);a.hours&&this.addHours(a.hours);a.weeks&&this.addWeeks(a.weeks);a.months&&this.addMonths(a.months);a.years&&this.addYears(a.years);a.days&&this.addDays(a.days);return this};var e,g,i;b.getWeek=function(){var a,b,c,d,s;e=!e?this.getFullYear():e;g=!g?this.getMonth()+
1:g;i=!i?this.getDate():i;2>=g?(a=e-1,b=(a/4|0)-(a/100|0)+(a/400|0),s=b-(((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0)),c=0,d=i-1+31*(g-1)):(a=e,b=(a/4|0)-(a/100|0)+(a/400|0),s=b-(((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0)),c=s+1,d=i+(153*(g-3)+2)/5+58+s);a=(a+b)%7;c=d+3-(d+a-c)%7|0;e=g=i=null;return 0>c?53-((a-s)/5|0):c>364+s?1:(c/7|0)+1};b.getISOWeek=function(){e=this.getUTCFullYear();g=this.getUTCMonth()+1;i=this.getUTCDate();return d(this.getWeek())};b.setWeek=function(a){return this.moveToDayOfWeek(1).addWeeks(a-
this.getWeek())};a._validate=function(a,b,c,d){if("undefined"==typeof a)return!1;if("number"!=typeof a)throw new TypeError(a+" is not a Number.");if(a<b||a>c)throw new RangeError(a+" is not a valid value for "+d+".");return!0};a.validateMillisecond=function(b){return a._validate(b,0,999,"millisecond")};a.validateSecond=function(b){return a._validate(b,0,59,"second")};a.validateMinute=function(b){return a._validate(b,0,59,"minute")};a.validateHour=function(b){return a._validate(b,0,23,"hour")};a.validateDay=
function(b,c,d){return a._validate(b,1,a.getDaysInMonth(c,d),"day")};a.validateMonth=function(b){return a._validate(b,0,11,"month")};a.validateYear=function(b){return a._validate(b,0,9999,"year")};b.set=function(b){a.validateMillisecond(b.millisecond)&&this.addMilliseconds(b.millisecond-this.getMilliseconds());a.validateSecond(b.second)&&this.addSeconds(b.second-this.getSeconds());a.validateMinute(b.minute)&&this.addMinutes(b.minute-this.getMinutes());a.validateHour(b.hour)&&this.addHours(b.hour-
this.getHours());a.validateMonth(b.month)&&this.addMonths(b.month-this.getMonth());a.validateYear(b.year)&&this.addYears(b.year-this.getFullYear());a.validateDay(b.day,this.getFullYear(),this.getMonth())&&this.addDays(b.day-this.getDate());b.timezone&&this.setTimezone(b.timezone);b.timezoneOffset&&this.setTimezoneOffset(b.timezoneOffset);b.week&&a._validate(b.week,0,53,"week")&&this.setWeek(b.week);return this};b.moveToFirstDayOfMonth=function(){return this.set({day:1})};b.moveToLastDayOfMonth=function(){return this.set({day:a.getDaysInMonth(this.getFullYear(),
this.getMonth())})};b.moveToNthOccurrence=function(a,b){var c=0;if(0<b)c=b-1;else if(-1===b)return this.moveToLastDayOfMonth(),this.getDay()!==a&&this.moveToDayOfWeek(a,-1),this;return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(a,1).addWeeks(c)};b.moveToDayOfWeek=function(a,b){var c=(a-this.getDay()+7*(b||1))%7;return this.addDays(0===c?c+7*(b||1):c)};b.moveToMonth=function(a,b){var c=(a-this.getMonth()+12*(b||1))%12;return this.addMonths(0===c?c+12*(b||1):c)};b.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-
new Date(this.getFullYear(),0,1))/864E5)+1};b.getTimezone=function(){return a.getTimezoneAbbreviation(this.getUTCOffset())};b.setTimezoneOffset=function(a){var b=this.getTimezoneOffset();return this.addMinutes(-6*Number(a)/10-b)};b.setTimezone=function(b){return this.setTimezoneOffset(a.getTimezoneOffset(b))};b.hasDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset()};b.isDaylightSavingTime=function(){return this.hasDaylightSavingTime()&&
(new Date).getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset()};b.getUTCOffset=function(){var a=-10*this.getTimezoneOffset()/6;if(0>a)return a=(a-1E4).toString(),a.charAt(0)+a.substr(2);a=(a+1E4).toString();return"+"+a.substr(1)};b.getElapsed=function(a){return(a||new Date)-this};b.toISOString||(b.toISOString=function(){function a(b){return 10>b?"0"+b:b}return'"'+this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+
":"+a(this.getUTCSeconds())+'Z"'});b._toString=b.toString;b.toString=function(a){var b=this;if(a&&1==a.length){var e=c.formatPatterns;b.t=b.toString;switch(a){case "d":return b.t(e.shortDate);case "D":return b.t(e.longDate);case "F":return b.t(e.fullDateTime);case "m":return b.t(e.monthDay);case "r":return b.t(e.rfc1123);case "s":return b.t(e.sortableDateTime);case "t":return b.t(e.shortTime);case "T":return b.t(e.longTime);case "u":return b.t(e.universalSortableDateTime);case "y":return b.t(e.yearMonth)}}var g=
function(a){switch(1*a){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return a?a.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(a){if("\\"===a.charAt(0))return a.replace("\\","");b.h=b.getHours;switch(a){case "hh":return d(13>b.h()?0===b.h()?12:b.h():b.h()-12);case "h":return 13>b.h()?0===b.h()?12:b.h():b.h()-12;case "HH":return d(b.h());case "H":return b.h();case "mm":return d(b.getMinutes());case "m":return b.getMinutes();
case "ss":return d(b.getSeconds());case "s":return b.getSeconds();case "yyyy":return d(b.getFullYear(),4);case "yy":return d(b.getFullYear());case "dddd":return c.dayNames[b.getDay()];case "ddd":return c.abbreviatedDayNames[b.getDay()];case "dd":return d(b.getDate());case "d":return b.getDate();case "MMMM":return c.monthNames[b.getMonth()];case "MMM":return c.abbreviatedMonthNames[b.getMonth()];case "MM":return d(b.getMonth()+1);case "M":return b.getMonth()+1;case "t":return 12>b.h()?c.amDesignator.substring(0,
1):c.pmDesignator.substring(0,1);case "tt":return 12>b.h()?c.amDesignator:c.pmDesignator;case "S":return g(b.getDate());default:return a}}):this._toString()}})();
(function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=Number.prototype;b._orient=1;b._nth=null;b._is=!1;b._same=!1;b._isSecond=!1;d._dateElement="day";b.next=function(){this._orient=1;return this};a.next=function(){return a.today().next()};b.last=b.prev=b.previous=function(){this._orient=-1;return this};a.last=a.prev=a.previous=function(){return a.today().last()};b.is=function(){this._is=!0;return this};b.same=function(){this._same=!0;this._isSecond=!1;return this};b.today=function(){return this.same().day()};
b.weekday=function(){return this._is?(this._is=!1,!this.is().sat()&&!this.is().sun()):!1};b.at=function(b){return"string"===typeof b?a.parse(this.toString("d")+" "+b):this.set(b)};d.fromNow=d.after=function(a){var b={};b[this._dateElement]=this;return(!a?new Date:a.clone()).add(b)};d.ago=d.before=function(a){var b={};b[this._dateElement]=-1*this;return(!a?new Date:a.clone()).add(b)};var e="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),g="january february march april may june july august september october november december".split(/\s/),
i="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),h="Milliseconds Seconds Minutes Hours Date Week Month FullYear".split(/\s/),k="final first second third fourth fifth".split(/\s/);b.toObject=function(){for(var a={},b=0;b<i.length;b++)a[i[b].toLowerCase()]=this["get"+h[b]]();return a};a.fromObject=function(a){a.week=null;return Date.today().set(a)};for(var m=function(b){return function(){if(this._is)return this._is=!1,this.getDay()==b;if(null!==this._nth){this._isSecond&&this.addSeconds(-1*
this._orient);this._isSecond=!1;var c=this._nth;this._nth=null;var d=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(b,c);if(this>d)throw new RangeError(a.getDayName(b)+" does not occur "+c+" times in the month of "+a.getMonthName(d.getMonth())+" "+d.getFullYear()+".");return this}return this.moveToDayOfWeek(b,this._orient)}},n=function(b){return function(){var d=a.today(),e=b-d.getDay();0===b&&(1===c.firstDayOfWeek&&0!==d.getDay())&&(e+=7);return d.addDays(e)}},s=0;s<e.length;s++)a[e[s].toUpperCase()]=
a[e[s].toUpperCase().substring(0,3)]=s,a[e[s]]=a[e[s].substring(0,3)]=n(s),b[e[s]]=b[e[s].substring(0,3)]=m(s);e=function(a){return function(){return this._is?(this._is=!1,this.getMonth()===a):this.moveToMonth(a,this._orient)}};m=function(b){return function(){return a.today().set({month:b,day:1})}};for(n=0;n<g.length;n++)a[g[n].toUpperCase()]=a[g[n].toUpperCase().substring(0,3)]=n,a[g[n]]=a[g[n].substring(0,3)]=m(n),b[g[n]]=b[g[n].substring(0,3)]=e(n);e=function(a){return function(b){if(this._isSecond)return this._isSecond=
!1,this;if(this._same){this._same=this._is=!1;for(var c=this.toObject(),b=(b||new Date).toObject(),d="",e=a.toLowerCase(),g=i.length-1;-1<g;g--){d=i[g].toLowerCase();if(c[d]!=b[d])return!1;if(e==d)break}return!0}"s"!=a.substring(a.length-1)&&(a+="s");return this["add"+a](this._orient)}};m=function(a){return function(){this._dateElement=a;return this}};for(n=0;n<i.length;n++)g=i[n].toLowerCase(),b[g]=b[g+"s"]=e(i[n]),d[g]=d[g+"s"]=m(g);b._ss=e("Second");d=function(a){return function(b){if(this._same)return this._ss(b);
if(b||0===b)return this.moveToNthOccurrence(b,a);this._nth=a;return 2===a&&(void 0===b||null===b)?(this._isSecond=!0,this.addSeconds(this._orient)):this}};for(g=0;g<k.length;g++)b[k[g]]=0===g?d(-1):d(g)})();
(function(){Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};for(var a=Date.Parsing,b=a.Operators={rtoken:function(b){return function(c){var d=c.match(b);if(d)return[d[0],c.substring(d[0].length)];throw new a.Exception(c);}},token:function(){return function(a){return b.rtoken(RegExp("^s*"+a+"s*"))(a)}},stoken:function(a){return b.rtoken(RegExp("^"+a))},until:function(a){return function(b){for(var c=[],d=null;b.length;){try{d=a.call(this,b)}catch(e){c.push(d[0]);
b=d[1];continue}break}return[c,b]}},many:function(a){return function(b){for(var c=[],d=null;b.length;){try{d=a.call(this,b)}catch(e){break}c.push(d[0]);b=d[1]}return[c,b]}},optional:function(a){return function(b){var c=null;try{c=a.call(this,b)}catch(d){return[null,b]}return[c[0],c[1]]}},not:function(b){return function(c){try{b.call(this,c)}catch(d){return[null,c]}throw new a.Exception(c);}},ignore:function(a){return a?function(b){var c=null,c=a.call(this,b);return[null,c[1]]}:null},product:function(){for(var a=
arguments[0],c=Array.prototype.slice.call(arguments,1),d=[],e=0;e<a.length;e++)d.push(b.each(a[e],c));return d},cache:function(b){var c={},d=null;return function(e){try{d=c[e]=c[e]||b.call(this,e)}catch(m){d=c[e]=m}if(d instanceof a.Exception)throw d;return d}},any:function(){var b=arguments;return function(c){for(var d=null,e=0;e<b.length;e++)if(null!=b[e]){try{d=b[e].call(this,c)}catch(m){d=null}if(d)return d}throw new a.Exception(c);}},each:function(){var b=arguments;return function(c){for(var d=
[],e=null,m=0;m<b.length;m++)if(null!=b[m]){try{e=b[m].call(this,c)}catch(n){throw new a.Exception(c);}d.push(e[0]);c=e[1]}return[d,c]}},all:function(){var a=a;return a.each(a.optional(arguments))},sequence:function(c,d,e){d=d||b.rtoken(/^\s*/);e=e||null;return 1==c.length?c[0]:function(b){for(var m=null,n=null,s=[],u=0;u<c.length;u++){try{m=c[u].call(this,b)}catch(x){break}s.push(m[0]);try{n=d.call(this,m[1])}catch(B){n=null;break}b=n[1]}if(!m)throw new a.Exception(b);if(n)throw new a.Exception(n[1]);
if(e)try{m=e.call(this,m[1])}catch(F){throw new a.Exception(m[1]);}return[s,m?m[1]:b]}},between:function(a,c,d){var d=d||a,e=b.each(b.ignore(a),c,b.ignore(d));return function(a){a=e.call(this,a);return[[a[0][0],r[0][2]],a[1]]}},list:function(a,c,d){c=c||b.rtoken(/^\s*/);d=d||null;return a instanceof Array?b.each(b.product(a.slice(0,-1),b.ignore(c)),a.slice(-1),b.ignore(d)):b.each(b.many(b.each(a,b.ignore(c))),px,b.ignore(d))},set:function(c,d,e){d=d||b.rtoken(/^\s*/);e=e||null;return function(k){for(var m=
null,n=m=null,s=null,u=[[],k],x=!1,B=0;B<c.length;B++){m=n=null;x=1==c.length;try{m=c[B].call(this,k)}catch(F){continue}s=[[m[0]],m[1]];if(0<m[1].length&&!x)try{n=d.call(this,m[1])}catch(w){x=!0}else x=!0;!x&&0===n[1].length&&(x=!0);if(!x){m=[];for(x=0;x<c.length;x++)B!=x&&m.push(c[x]);m=b.set(m,d).call(this,n[1]);0<m[0].length&&(s[0]=s[0].concat(m[0]),s[1]=m[1])}s[1].length<u[1].length&&(u=s);if(0===u[1].length)break}if(0===u[0].length)return u;if(e){try{n=e.call(this,u[1])}catch(D){throw new a.Exception(u[1]);
}u[1]=n[1]}return u}},forward:function(a,b){return function(c){return a[b].call(this,c)}},replace:function(a,b){return function(c){c=a.call(this,c);return[b,c[1]]}},process:function(a,b){return function(c){c=a.call(this,c);return[b.call(this,c[0]),c[1]]}},min:function(b,c){return function(d){var e=c.call(this,d);if(e[0].length<b)throw new a.Exception(d);return e}}},c=function(a){return function(){var b=null,c=[];1<arguments.length?b=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&
(b=arguments[0]);if(b)for(var d=b.shift();0<d.length;)return b.unshift(d[0]),c.push(a.apply(null,b)),b.shift(),c;else return a.apply(null,arguments)}},d="optional not ignore cache".split(/\s/),e=0;e<d.length;e++)b[d[e]]=c(b[d[e]]);c=function(a){return function(){return arguments[0]instanceof Array?a.apply(null,arguments[0]):a.apply(null,arguments)}};d="each any all".split(/\s/);for(e=0;e<d.length;e++)b[d[e]]=c(b[d[e]])})();
(function(){var a=Date,b=a.CultureInfo,c=function(a){for(var b=[],d=0;d<a.length;d++)a[d]instanceof Array?b=b.concat(c(a[d])):a[d]&&b.push(a[d]);return b};a.Grammar={};a.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,
"");b.length?this.timezoneOffset=Number(b):this.timezone=a.toLowerCase()}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=3==a.length?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(a)/4:Number(a)-1}},year:function(a){return function(){var c=Number(a);this.year=2<a.length?c:c+(c+2E3<b.twoDigitYearMax?2E3:1900)}},rday:function(a){return function(){switch(a){case "yesterday":this.days=-1;break;case "tomorrow":this.days=
1;break;case "today":this.days=0;break;case "now":this.days=0,this.now=!0}}},finishExact:function(b){for(var b=b instanceof Array?b:[b],c=0;c<b.length;c++)b[c]&&b[c].call(this);b=new Date;if((this.hour||this.minute)&&!this.month&&!this.year&&!this.day)this.day=b.getDate();this.year||(this.year=b.getFullYear());!this.month&&0!==this.month&&(this.month=b.getMonth());this.day||(this.day=1);this.hour||(this.hour=0);this.minute||(this.minute=0);this.second||(this.second=0);this.meridian&&this.hour&&("p"==
this.meridian&&12>this.hour?this.hour+=12:"a"==this.meridian&&12==this.hour&&(this.hour=0));if(this.day>a.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");b=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);this.timezone?b.set({timezone:this.timezone}):this.timezoneOffset&&b.set({timezoneOffset:this.timezoneOffset});return b},finish:function(b){b=b instanceof Array?c(b):[b];if(0===b.length)return null;for(var d=0;d<b.length;d++)"function"==
typeof b[d]&&b[d].call(this);b=a.today();if(this.now&&!this.unit&&!this.operator)return new Date;this.now&&(b=new Date);var d=!!(this.days&&null!==this.days||this.orient||this.operator),e,g,h;h="past"==this.orient||"subtract"==this.operator?-1:1;!this.now&&-1!="hour minute second".indexOf(this.unit)&&b.setTimeToNow();if((this.month||0===this.month)&&-1!="year day hour minute second".indexOf(this.unit))this.value=this.month+1,this.month=null,d=!0;!d&&(this.weekday&&!this.day&&!this.days)&&(e=Date[this.weekday](),
this.day=e.getDate(),this.month||(this.month=e.getMonth()),this.year=e.getFullYear());d&&(this.weekday&&"month"!=this.unit)&&(this.unit="day",e=a.getDayNumberFromName(this.weekday)-b.getDay(),g=7,this.days=e?(e+h*g)%g:h*g);this.month&&("day"==this.unit&&this.operator)&&(this.value=this.month+1,this.month=null);null!=this.value&&(null!=this.month&&null!=this.year)&&(this.day=1*this.value);this.month&&(!this.day&&this.value)&&(b.set({day:1*this.value}),d||(this.day=1*this.value));!this.month&&(this.value&&
"month"==this.unit&&!this.now)&&(this.month=this.value,d=!0);if(d&&(this.month||0===this.month)&&"year"!=this.unit)this.unit="month",e=this.month-b.getMonth(),g=12,this.months=e?(e+h*g)%g:h*g,this.month=null;this.unit||(this.unit="day");if(!this.value&&this.operator&&null!==this.operator&&this[this.unit+"s"]&&null!==this[this.unit+"s"])this[this.unit+"s"]=this[this.unit+"s"]+("add"==this.operator?1:-1)+(this.value||0)*h;else if(null==this[this.unit+"s"]||null!=this.operator)this.value||(this.value=
1),this[this.unit+"s"]=this.value*h;this.meridian&&this.hour&&("p"==this.meridian&&12>this.hour?this.hour+=12:"a"==this.meridian&&12==this.hour&&(this.hour=0));this.weekday&&(!this.day&&!this.days)&&(e=Date[this.weekday](),this.day=e.getDate(),e.getMonth()!==b.getMonth()&&(this.month=e.getMonth()));if((this.month||0===this.month)&&!this.day)this.day=1;if(!this.orient&&!this.operator&&"week"==this.unit&&this.value&&!this.day&&!this.month)return Date.today().setWeek(this.value);d&&(this.timezone&&this.day&&
this.days)&&(this.day=this.days);return d?b.add(this):b.set(this)}};var d=a.Parsing.Operators,e=a.Grammar,g=a.Translator,i;e.datePartDelimiter=d.rtoken(/^([\s\-\.\,\/\x27]+)/);e.timePartDelimiter=d.stoken(":");e.whiteSpace=d.rtoken(/^\s*/);e.generalDelimiter=d.rtoken(/^(([\s\,]|at|@|on)+)/);var h={};e.ctoken=function(a){var c=h[a];if(!c){for(var c=b.regexPatterns,e=a.split(/\s+/),g=[],i=0;i<e.length;i++)g.push(d.replace(d.rtoken(c[e[i]]),e[i]));c=h[a]=d.any.apply(null,g)}return c};e.ctoken2=function(a){return d.rtoken(b.regexPatterns[a])};
e.h=d.cache(d.process(d.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),g.hour));e.hh=d.cache(d.process(d.rtoken(/^(0[0-9]|1[0-2])/),g.hour));e.H=d.cache(d.process(d.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),g.hour));e.HH=d.cache(d.process(d.rtoken(/^([0-1][0-9]|2[0-3])/),g.hour));e.m=d.cache(d.process(d.rtoken(/^([0-5][0-9]|[0-9])/),g.minute));e.mm=d.cache(d.process(d.rtoken(/^[0-5][0-9]/),g.minute));e.s=d.cache(d.process(d.rtoken(/^([0-5][0-9]|[0-9])/),g.second));e.ss=d.cache(d.process(d.rtoken(/^[0-5][0-9]/),g.second));
e.hms=d.cache(d.sequence([e.H,e.m,e.s],e.timePartDelimiter));e.t=d.cache(d.process(e.ctoken2("shortMeridian"),g.meridian));e.tt=d.cache(d.process(e.ctoken2("longMeridian"),g.meridian));e.z=d.cache(d.process(d.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),g.timezone));e.zz=d.cache(d.process(d.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),g.timezone));e.zzz=d.cache(d.process(e.ctoken2("timezone"),g.timezone));e.timeSuffix=d.each(d.ignore(e.whiteSpace),d.set([e.tt,e.zzz]));e.time=d.each(d.optional(d.ignore(d.stoken("T"))),
e.hms,e.timeSuffix);e.d=d.cache(d.process(d.each(d.rtoken(/^([0-2]\d|3[0-1]|\d)/),d.optional(e.ctoken2("ordinalSuffix"))),g.day));e.dd=d.cache(d.process(d.each(d.rtoken(/^([0-2]\d|3[0-1])/),d.optional(e.ctoken2("ordinalSuffix"))),g.day));e.ddd=e.dddd=d.cache(d.process(e.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}}));e.M=d.cache(d.process(d.rtoken(/^(1[0-2]|0\d|\d)/),g.month));e.MM=d.cache(d.process(d.rtoken(/^(1[0-2]|0\d)/),g.month));e.MMM=e.MMMM=d.cache(d.process(e.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),
g.month));e.y=d.cache(d.process(d.rtoken(/^(\d\d?)/),g.year));e.yy=d.cache(d.process(d.rtoken(/^(\d\d)/),g.year));e.yyy=d.cache(d.process(d.rtoken(/^(\d\d?\d?\d?)/),g.year));e.yyyy=d.cache(d.process(d.rtoken(/^(\d\d\d\d)/),g.year));i=function(){return d.each(d.any.apply(null,arguments),d.not(e.ctoken2("timeContext")))};e.day=i(e.d,e.dd);e.month=i(e.M,e.MMM);e.year=i(e.yyyy,e.yy);e.orientation=d.process(e.ctoken("past future"),function(a){return function(){this.orient=a}});e.operator=d.process(e.ctoken("add subtract"),
function(a){return function(){this.operator=a}});e.rday=d.process(e.ctoken("yesterday tomorrow today now"),g.rday);e.unit=d.process(e.ctoken("second minute hour day week month year"),function(a){return function(){this.unit=a}});e.value=d.process(d.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}});e.expression=d.set([e.rday,e.operator,e.value,e.unit,e.orientation,e.ddd,e.MMM]);i=function(){return d.set(arguments,e.datePartDelimiter)};e.mdy=i(e.ddd,e.month,
e.day,e.year);e.ymd=i(e.ddd,e.year,e.month,e.day);e.dmy=i(e.ddd,e.day,e.month,e.year);e.date=function(a){return(e[b.dateElementOrder]||e.mdy).call(this,a)};e.format=d.process(d.many(d.any(d.process(d.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(b){if(e[b])return e[b];throw a.Parsing.Exception(b);}),d.process(d.rtoken(/^[^dMyhHmstz]+/),function(a){return d.ignore(d.stoken(a))}))),function(a){return d.process(d.each.apply(null,a),g.finishExact)});var k={};e.formats=function(a){if(a instanceof
Array){for(var b=[],c=0;c<a.length;c++)b.push(k[a[c]]=k[a[c]]||e.format(a[c])[0]);return d.any.apply(null,b)}return k[a]=k[a]||e.format(a)[0]};e._formats=e.formats('"yyyy-MM-ddTHH:mm:ssZ";yyyy-MM-ddTHH:mm:ssZ;yyyy-MM-ddTHH:mm:ssz;yyyy-MM-ddTHH:mm:ss;yyyy-MM-ddTHH:mmZ;yyyy-MM-ddTHH:mmz;yyyy-MM-ddTHH:mm;ddd, MMM dd, yyyy H:mm:ss tt;ddd MMM d yyyy HH:mm:ss zzz;MMddyyyy;ddMMyyyy;Mddyyyy;ddMyyyy;Mdyyyy;dMyyyy;yyyy;Mdyy;dMyy;d'.split(";"));e._start=d.process(d.set([e.date,e.time,e.expression],e.generalDelimiter,
e.whiteSpace),g.finish);e.start=function(a){try{var b=e._formats.call({},a);if(0===b[1].length)return b}catch(c){}return e._start.call({},a)};a._parse=a.parse;a.parse=function(b){var c=null;if(!b)return null;if(b instanceof Date)return b;try{c=a.Grammar.start.call({},b.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(d){return null}return 0===c[1].length?c[0]:null};a.getParseFunction=function(b){var c=a.Grammar.formats(b);return function(a){var b=null;try{b=c.call({},a)}catch(d){return null}return 0===
b[1].length?b[0]:null}};a.parseExact=function(b,c){return a.getParseFunction(c)(b)}})();var cookieExpire=2629743;function setCookie(a,b,c){var d=new Date;d.setDate(d.getDate()+c);b=escape(b)+(null==c?"":"; expires="+d.toUTCString());document.cookie=a+"="+b}function getCookie(a){var b,c,d,e=document.cookie.split(";");for(b=0;b<e.length;b++)if(c=e[b].substr(0,e[b].indexOf("=")),d=e[b].substr(e[b].indexOf("=")+1),c=c.replace(/^\s+|\s+$/g,""),c==a)return unescape(d)}
var CacheCore=function(){this.cache={};this.dependencies={dashboard:{main:{type:"time",attr:"0"},inbox:{type:"time",attr:"0"},settings:{type:"time",attr:"0"}},staff:{staffList:{type:"time",attr:"0"},addEmployee:{type:"time",attr:"0"},fastAssignment:{type:"time",attr:"0"}},timeClock:{overview:{type:"time",attr:"0"},addClockTime:{type:"time",attr:"0"},manageTimeSheets:{type:"time",attr:"0"}}}};CacheCore.prototype.addDependecy=function(a){this.dependencies[a.page][a.subpage]=a.depends};
CacheCore.prototype.readC=function(a,b){var c=a+"."+b;if("undefined"!=typeof this.cache[c])return!1;if("time"==this.dependencies[a][b].type){var d=this;setTimeout(function(){delete d.cache[c]},this.dependencies[a][b].attr)}return this.cache[c]=!0};CacheCore.prototype.clearChangeCache=function(a){var b=this;$.each(b.dependencies,function(c,d){$.each(d,function(d,g){"change"==g.type&&$.inArray(a,g.attr)&&(b.cache[c+"."+d]=null)})})};CacheCore.prototype.flushAll=function(){this.cache={}};
function strtotime(a,b){var c,d,e,g;e="";a=a.replace(/\s{2,}|^\s|\s$/g," ");a=a.replace(/[\t\r\n]/g,"");if("now"===a)return null===b||isNaN(b)?(new Date).getTime()/1E3|0:b|0;if(isNaN(e=Date.parse(a)))b=b?new Date(1E3*b):new Date;else return e/1E3|0;a=a.toLowerCase();g={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};c="jan feb mar apr may jun jul aug sep oct nov dec".split(" ");e=a.match(/^(\d{2,4}-\d{2}-\d{2})(?:\s(\d{1,2}:\d{2}(:\d{2})?)?(?:\.(\d+))?)?$/);if(null!==e)return e[2]?e[3]||(e[2]+=":00"):
e[2]="00:00:00",g=e[1].split(/-/g),g[1]=c[g[1]-1]||g[1],g[0]=+g[0],g[0]=0<=g[0]&&69>=g[0]?"20"+(10>g[0]?"0"+g[0]:g[0]+""):70<=g[0]&&99>=g[0]?"19"+g[0]:g[0]+"",parseInt(this.strtotime(g[2]+" "+g[1]+" "+g[0]+" "+e[2])+(e[4]?e[4]/1E3:""),10);e=a.match(RegExp("([+-]?\\d+\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday)|(last|next)\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday))(\\sago)?",
"gi"));if(null===e)return!1;c=0;for(d=e.length;c<d;c++){var i;a:{i=e[c].split(" ");var h=i[2]&&"ago"===i[2],k=(k="last"===i[0]?-1:1)*(h?-1:1);switch(i[0]){case "last":case "next":switch(i[1].substring(0,3)){case "yea":b.setFullYear(b.getFullYear()+k);break;case "mon":b.setMonth(b.getMonth()+k);break;case "wee":b.setDate(b.getDate()+7*k);break;case "day":b.setDate(b.getDate()+k);break;case "hou":b.setHours(b.getHours()+k);break;case "min":b.setMinutes(b.getMinutes()+k);break;case "sec":b.setSeconds(b.getSeconds()+
k);break;default:h=g[i[1].substring(0,3)],"undefined"!==typeof h&&(h-=b.getDay(),0===h?h=7*k:0<h?"last"===i[0]&&(h-=7):"next"===i[0]&&(h+=7),b.setDate(b.getDate()+h))}break;default:if(/\d+/.test(i[0]))switch(k*=parseInt(i[0],10),i[1].substring(0,3)){case "yea":b.setFullYear(b.getFullYear()+k);break;case "mon":b.setMonth(b.getMonth()+k);break;case "wee":b.setDate(b.getDate()+7*k);break;case "day":b.setDate(b.getDate()+k);break;case "hou":b.setHours(b.getHours()+k);break;case "min":b.setMinutes(b.getMinutes()+
k);break;case "sec":b.setSeconds(b.getSeconds()+k)}else{i=!1;break a}}i=!0}if(!i)return!1}return b.getTime()/1E3|0}var months=[_s("Jan"),_s("Feb"),_s("Mar"),_s("Apr"),_s("May"),_s("Jun"),_s("Jul"),_s("Aug"),_s("Sep"),_s("Oct"),_s("Nov"),_s("Dec")],daysOfWeek=[_s("Sunday"),_s("Monday"),_s("Tuesday"),_s("Wednesday"),_s("Thursday"),_s("Friday"),_s("Saturday")],daysOfWeekS=[_s("Sun"),_s("Mon"),_s("Tue"),_s("Wed"),_s("Thu"),_s("Fri"),_s("Sat")];
function date(a,b){var c,d,e=/\\?([a-z])/gi,g,i=function(a,b){return(a+="").length<b?Array(++b-a.length).join("0")+a:a},h=[_s("Sun"),_s("Mon"),_s("Tues"),_s("Wednes"),_s("Thurs"),_s("Fri"),_s("Satur"),_s("January"),_s("February"),_s("March"),_s("April"),_s("May"),_s("June"),_s("July"),_s("August"),_s("September"),_s("October"),_s("November"),_s("December")];g=function(a,b){return d[a]?d[a]():b};d={d:function(){return i(d.j(),2)},D:function(){return d.l().slice(0,3)},j:function(){return c.getDate()},
l:function(){return h[d.w()]+"day"},N:function(){return d.w()||7},S:function(){var a=d.j();return 4>a|20<a&&["st","nd","rd"][a%10-1]||"th"},w:function(){return c.getDay()},z:function(){var a=new Date(d.Y(),d.n()-1,d.j()),b=new Date(d.Y(),0,1);return Math.round((a-b)/864E5)+1},W:function(){var a=new Date(d.Y(),d.n()-1,d.j()-d.N()+3),b=new Date(a.getFullYear(),0,4);return i(1+Math.round((a-b)/864E5/7),2)},F:function(){return h[6+d.n()]},m:function(){return i(d.n(),2)},M:function(){return d.F().slice(0,
3)},n:function(){return c.getMonth()+1},t:function(){return(new Date(d.Y(),d.n(),0)).getDate()},L:function(){var a=d.Y();return 0==a%4&0!=a%100|0==a%400},o:function(){var a=d.n(),b=d.W();return d.Y()+(12===a&&9>b?-1:1===a&&9<b)},Y:function(){return c.getFullYear()},y:function(){return(d.Y()+"").slice(-2)},a:function(){return 11<c.getHours()?"pm":"am"},A:function(){return d.a().toUpperCase()},B:function(){var a=3600*c.getUTCHours(),b=60*c.getUTCMinutes(),d=c.getUTCSeconds();return i(Math.floor((a+
b+d+3600)/86.4)%1E3,3)},g:function(){return d.G()%12||12},G:function(){return c.getHours()},h:function(){return i(d.g(),2)},H:function(){return i(d.G(),2)},i:function(){return i(c.getMinutes(),2)},s:function(){return i(c.getSeconds(),2)},u:function(){return i(1E3*c.getMilliseconds(),6)},e:function(){throw _s("Not supported (see source code of date() for timezone on how to add support)");},I:function(){var a=new Date(d.Y(),0),b=Date.UTC(d.Y(),0),c=new Date(d.Y(),6),e=Date.UTC(d.Y(),6);return 0+(a-
b!==c-e)},O:function(){var a=c.getTimezoneOffset(),b=Math.abs(a);return(0<a?"-":"+")+i(100*Math.floor(b/60)+b%60,4)},P:function(){var a=d.O();return a.substr(0,3)+":"+a.substr(3,2)},T:function(){return"UTC"},Z:function(){return 60*-c.getTimezoneOffset()},c:function(){return"Y-m-d\\Th:i:sP".replace(e,g)},r:function(){return"D, d M Y H:i:s O".replace(e,g)},U:function(){return c/1E3|0}};this.date=function(a,b){c=null==b?new Date:b instanceof Date?new Date(b):new Date(1E3*b);return a.replace(e,g)};return this.date(a,
b)}function now(a){return"undefined"!=typeof a?new Date(1E3*a):new Date}function formatted(a){var b="";switch(a){case "today":a=Date.parse("today");b=a.toString(cal.dformat);break;case "nowT":var a=Date.parse("now").getTime(),b=6E4*Date.parse("now").getTimezoneOffset(),c=sp.staff.admin.settings.timezone.split(","),c=c[0].split(":"),d=3600*parseInt(c[0]),c=60*c[1],b=(new Date(a+b+1E3*(Math.abs(d)+c)+0)).toString(cal.tstring);break;default:b=a.toString("dddd, "+cal.dformat)}return b}
(function(){var a=Date,b=a.prototype,c=[],d=function(a,b){b||(b=2);return("000"+a).slice(-1*b)};a.normalizeFormat=function(a){c=[];(new Date).$format(a);return c.join("")};a.strftime=function(a,b){return(new Date(1E3*b)).$format(a)};a.strtotime=function(b){b=a.parse(b);b.addMinutes(-1*b.getTimezoneOffset());return Math.round(a.UTC(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCMilliseconds())/1E3)};b.$format=function(b){var g=this,i,h=
function(a){c.push(a);return g.toString(a)};return b?b.replace(/(%|\\)?.|%%/g,function(b){if("\\"===b.charAt(0)||"%%"===b.substring(0,2))return b.replace("\\","").replace("%%","%");switch(b){case "d":case "%d":return h("dd");case "D":case "%a":return h("ddd");case "j":case "%e":return h("d");case "l":case "%A":return h("dddd");case "N":case "%u":return g.getDay()+1;case "S":return h("S");case "w":case "%w":return g.getDay();case "z":return g.getOrdinalNumber();case "%j":return d(g.getOrdinalNumber(),
3);case "%U":var b=g.clone().set({month:0,day:1}).addDays(-1).moveToDayOfWeek(0),e=g.clone().addDays(1).moveToDayOfWeek(0,-1);return e<b?"00":d((e.getOrdinalNumber()-b.getOrdinalNumber())/7+1);case "W":case "%V":return g.getISOWeek();case "%W":return d(g.getWeek());case "F":case "%B":return h("MMMM");case "m":case "%m":return h("MM");case "M":case "%b":case "%h":return h("MMM");case "n":return h("M");case "t":return a.getDaysInMonth(g.getFullYear(),g.getMonth());case "L":return a.isLeapYear(g.getFullYear())?
1:0;case "o":case "%G":return g.setWeek(g.getISOWeek()).toString("yyyy");case "%g":return g.$format("%G").slice(-2);case "Y":case "%Y":return h("yyyy");case "y":case "%y":return h("yy");case "a":case "%p":return h("tt").toLowerCase();case "A":return h("tt").toUpperCase();case "g":case "%I":return h("h");case "G":return h("H");case "h":return h("hh");case "H":case "%H":return h("HH");case "i":case "%M":return h("mm");case "s":case "%S":return h("ss");case "u":return d(g.getMilliseconds(),3);case "I":return g.isDaylightSavingTime()?
1:0;case "O":return g.getUTCOffset();case "P":return i=g.getUTCOffset(),i.substring(0,i.length-2)+":"+i.substring(i.length-2);case "e":case "T":case "%z":case "%Z":return g.getTimezone();case "Z":return-60*g.getTimezoneOffset();case "B":return b=new Date,Math.floor((3600*b.getHours()+60*b.getMinutes()+b.getSeconds()+60*(b.getTimezoneOffset()+60))/86.4);case "c":return g.toISOString().replace(/\"/g,"");case "U":return a.strtotime("now");case "%c":return h("d")+" "+h("t");case "%C":return Math.floor(g.getFullYear()/
100+1);case "%D":return h("MM/dd/yy");case "%n":return"\\n";case "%t":return"\\t";case "%r":return h("hh:mm tt");case "%R":return h("H:mm");case "%T":return h("H:mm:ss");case "%x":return h("d");case "%X":return h("t");default:return c.push(b),b}}):this._toString()};b.format||(b.format=b.$format)})();
tfObjSort={init:function(){Array.prototype.objSort=function(){tfObjSort.setThings(this);var a=arguments,b=tfObjSort;b.a=[];b.d=[];for(var c=0;c<a.length;c++)"string"==typeof a[c]&&(b.a.push(a[c]),b.d.push(1)),-1===a[c]&&(b.d[b.d.length-1]=-1);return this.sort(tfObjSort.sorter)};Array.prototype.strSort=function(){tfObjSort.setThings(this);return this.sort(tfObjSort.charSorter)}},sorter:function(a,b){for(var c=tfObjSort.a,d=tfObjSort.d,e=0,g=0;g<c.length;g++){if("objectobject"!=typeof a+typeof b)return"object"==
typeof a?-1:1;var i=a[c[g]],h=b[c[g]],k=typeof i+typeof h;if("booleanboolean"==k)i*=-1,h*=-1;else if(""!=k.split("string").join("").split("number").join(""))continue;e=i-h;isNaN(e)&&(e=tfObjSort.charSorter(i,h));if(0!=e)return e*d[g]}return e},charSorter:function(a,b){tfObjSort.ignoreCase&&(a=a.toLowerCase(),b=b.toLowerCase());var c=tfObjSort.chars;if(!c)return a>b?1:a<b?-1:0;a=a.split("");b=b.split("");l=a.length>b.length?b.length:a.length;for(var d=0,e=0;e<l&&!(d=c.indexOf(a[e])-c.indexOf(b[e]),
0!=d);e++);0==d&&(d=a.length-b.length);return d},setThings:function(a){this.ignoreCase=a.sortIgnoreCase;a=a.sortCharOrder;if(!a)return this.chars=!1,!0;a.sort||(a=a.split(","));for(var b="",c=1;1024>c;c++)b+=String.fromCharCode(c);for(c=0;c<a.length;c++){z=a[c].split("");var d=z[0],e=z[1],g="",g="_"==z[2]?e+d:d+e,b=b.split(d).join("").split(e).join(g)}this.chars=b}};tfObjSort.init();
(function(a,b,c,d){function e(e){for(var i=e.target,h=0,k=b[d],m;h<k;h++)m=b[h],m!==i&&!(m.contains?m.contains(i):m.compareDocumentPosition?m.compareDocumentPosition(i)&16:1)&&a.event.trigger(c,e,m)}a.event.special[c]={setup:function(){b[d]||a.event.add(document,"click",e);0>a.inArray(this,b)&&(b[b[d]]=this)},teardown:function(){for(var c=[],i=0,h=0,k=b[d],m;i<k;i++)m=b[i],m!==this&&(c[h++]=m);b[d]=0;b.push.apply(b,c)||a.event.remove(document,"click",e)}};a.fn[c]=function(a){return a?this.bind(c,
a):this.trigger(c)}})(jQuery,[],"outerClick","length");
function Hammer(a,b,c){var d,e;function g(a){return a.touches?a.touches.length:1}function i(a){a=a||window.event;if(ca){for(var b=[],c,d=0,e=a.touches.length;d<e;d++)c=a.touches[d],b.push({x:c.pageX,y:c.pageY});return b}b=document;c=b.body;return[{x:a.pageX||a.clientX+(b&&b.scrollLeft||c&&c.scrollLeft||0)-(b&&b.clientLeft||c&&b.clientLeft||0),y:a.pageY||a.clientY+(b&&b.scrollTop||c&&c.scrollTop||0)-(b&&b.clientTop||c&&b.clientTop||0)}]}function h(a,b){return 180*Math.atan2(b.y-a.y,b.x-a.x)/Math.PI}
function k(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)}function m(a,b){if(2==a.length&&2==b.length){var c=k(a[0],a[1]);return k(b[0],b[1])/c}return 0}function n(a,b){if(2==a.length&&2==b.length){var c=h(a[1],a[0]);return h(b[1],b[0])-c}return 0}function s(a,b){b.touches=i(b.originalEvent);b.type=a;"[object Function]"==Object.prototype.toString.call(K["on"+a])&&K["on"+a].call(K,b)}function u(a){a=a||window.event;a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.returnValue=!1,
a.cancelBubble=!0)}function x(){y={};q=!1;S=H=0;P=null}function B(c){function h(){y.start=i(c);v=(new Date).getTime();g(c);q=!0;Da=c;var b=a.getBoundingClientRect();d=b.top+(window.pageYOffset||a.scrollTop||document.body.scrollTop)-(a.clientTop||document.body.clientTop||0);e=b.left+(window.pageXOffset||a.scrollLeft||document.body.scrollLeft)-(a.clientLeft||document.body.clientLeft||0);U=!0;J.hold(c)}var k;switch(c.type){case "mousedown":case "touchstart":k=g(c);A=1===k;2===k&&"drag"===P&&s("dragend",
{originalEvent:c,direction:T,distance:H,angle:S});h();b.prevent_default&&u(c);break;case "mousemove":case "touchmove":k=g(c);if(!U&&1===k)return!1;!U&&2===k&&(A=!1,x(),h());y.move=i(c);J.transform(c)||J.drag(c);break;case "mouseup":case "mouseout":case "touchcancel":case "touchend":k=!0;U=!1;J.swipe(c);if("drag"==P)s("dragend",{originalEvent:c,direction:T,distance:H,angle:S});else if("transform"==P){var w=y.center.x-y.startCenter.x,t=y.center.y-y.startCenter.y;s("transformend",{originalEvent:c,position:y.center,
scale:m(y.start,y.move),rotation:n(y.start,y.move),distance:H,distanceX:w,distanceY:t});1===g(c)&&(x(),h(),k=!1)}else A&&J.tap(Da);f=P;s("release",{originalEvent:c,gesture:P,position:y.move||y.start});k&&x()}}function F(b){var c;a:if(c=b.relatedTarget,!c&&(window.event&&window.event.toElement)&&(c=window.event.toElement),a===c)c=!0;else{if(c)for(c=c.parentNode;null!==c;){if(c===a){c=!0;break a}c=c.parentNode}c=!1}c||B(b)}function w(a,b,c){for(var b=b.split(" "),d=0,e=b.length;d<e;d++)a.addEventListener?
a.addEventListener(b[d],c,!1):document.attachEvent&&a.attachEvent("on"+b[d],c)}function D(a,b,c){for(var b=b.split(" "),d=0,e=b.length;d<e;d++)a.removeEventListener?a.removeEventListener(b[d],c,!1):document.detachEvent&&a.detachEvent("on"+b[d],c)}var K=this;var O={prevent_default:!1,css_hacks:!0,swipe:!0,swipe_time:200,swipe_min_distance:20,drag:!0,drag_vertical:!0,drag_horizontal:!0,drag_min_distance:20,transform:!0,scale_treshold:0.1,rotation_treshold:15,tap:!0,tap_double:!0,tap_max_interval:300,
tap_max_distance:10,tap_double_distance:20,hold:!0,hold_timeout:500},Q=b,N={};if(Q){for(var R in O)N[R]=R in Q?Q[R]:O[R];b=N}else b=O;if(b.css_hacks){O=["webkit","moz","ms","o",""];Q={userSelect:"none",touchCallout:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"};N="";for(R=0;R<O.length;R++)for(var M in Q)N=M,O[R]&&(N=O[R]+N.substring(0,1).toUpperCase()+N.substring(1)),a.style[N]=Q[M]}var H=0,S=0,T=0,y={},q=!1,P=null,f=null,v=null,t={x:0,y:0},ta=null,la=null;e=d=void 0;var U=!1,Da,ca="ontouchstart"in
window,A=!1;this.option=function(a,d){d!==c&&(b[a]=d);return b[a]};this.getDirectionFromAngle=function(a){var a={down:45<=a&&135>a,left:135<=a||-135>=a,up:-45>a&&-135<a,right:-45<=a&&45>=a},b,c;for(c in a)if(a[c]){b=c;break}return b};this.destroy=function(){ca?D(a,"touchstart touchmove touchend touchcancel",B):(D(a,"mouseup mousedown mousemove",B),D(a,"mouseout",F))};var J={hold:function(a){b.hold&&(P="hold",clearTimeout(la),la=setTimeout(function(){"hold"==P&&s("hold",{originalEvent:a,position:y.start})},
b.hold_timeout))},swipe:function(a){if(y.move&&"transform"!==P){var c=y.move[0].x-y.start[0].x,f=y.move[0].y-y.start[0].y;H=Math.sqrt(c*c+f*f);var g=(new Date).getTime()-v;b.swipe&&(b.swipe_time>g&&H>b.swipe_min_distance)&&(S=h(y.start[0],y.move[0]),T=K.getDirectionFromAngle(S),P="swipe",s("swipe",{originalEvent:a,position:{x:y.move[0].x-e,y:y.move[0].y-d},direction:T,distance:H,distanceX:c,distanceY:f,angle:S}))}},drag:function(a){var c=y.move[0].x-y.start[0].x,f=y.move[0].y-y.start[0].y;H=Math.sqrt(c*
c+f*f);if(b.drag&&H>b.drag_min_distance||"drag"==P){S=h(y.start[0],y.move[0]);T=K.getDirectionFromAngle(S);var g="up"==T||"down"==T;(g&&!b.drag_vertical||!g&&!b.drag_horizontal)&&H>b.drag_min_distance||(P="drag",c={originalEvent:a,position:{x:y.move[0].x-e,y:y.move[0].y-d},direction:T,distance:H,distanceX:c,distanceY:f,angle:S},q&&(s("dragstart",c),q=!1),s("drag",c),u(a))}},transform:function(a){if(b.transform){if(2!==g(a))return!1;var c=n(y.start,y.move),f=m(y.start,y.move);if("transform"===P||Math.abs(1-
f)>b.scale_treshold||Math.abs(c)>b.rotation_treshold){P="transform";y.center={x:(y.move[0].x+y.move[1].x)/2-e,y:(y.move[0].y+y.move[1].y)/2-d};q&&(y.startCenter=y.center);var h=y.center.x-y.startCenter.x,i=y.center.y-y.startCenter.y;H=Math.sqrt(h*h+i*i);c={originalEvent:a,position:y.center,scale:f,rotation:c,distance:H,distanceX:h,distanceY:i};q&&(s("transformstart",c),q=!1);s("transform",c);u(a);return!0}}return!1},tap:function(a){var c=(new Date).getTime(),d=c-v;if(!b.hold||b.hold&&b.hold_timeout>
d){if(t&&b.tap_double&&"tap"==f&&y.start&&v-ta<b.tap_max_interval)var d=Math.abs(t[0].x-y.start[0].x),e=Math.abs(t[0].y-y.start[0].y),d=t&&y.start&&Math.max(d,e)<b.tap_double_distance;else d=!1;d?(P="double_tap",ta=null,s("doubletap",{originalEvent:a,position:y.start}),u(a)):(d=y.move?Math.abs(y.move[0].x-y.start[0].x):0,e=y.move?Math.abs(y.move[0].y-y.start[0].y):0,H=Math.max(d,e),H<b.tap_max_distance&&(P="tap",ta=c,t=y.start,b.tap&&(s("tap",{originalEvent:a,position:y.start}),u(a))))}}};ca?w(a,
"touchstart touchmove touchend touchcancel",B):(w(a,"mouseup mousedown mousemove",B),w(a,"mouseout",F))}jQuery.fn.hammer=function(a){return this.each(function(){var b=new Hammer(this,a),c=jQuery(this);c.data("hammer",b);for(var d="hold tap doubletap transformstart transform transformend dragstart drag dragend swipe release".split(" "),e=0;e<d.length;e++)b["on"+d[e]]=function(a,b){return function(c){a.trigger(jQuery.Event(b,c))}}(c,d[e])})};
(function(a){function b(b,d){this._delegateGuids=[];this._fn=function(e){d.trigger(a.Event(b,e))};this._delegateFn=function(d){d=a.Event(b,d);a(d.originalEvent.target).trigger(d)}}b.prototype={addDelegate:function(a){this._delegateGuids.push(a);return this},removeDelegate:function(a){a=this._delegateGuids.indexOf(a);0<=a&&this._delegateGuids.splice(a);return this},getFn:function(){return 0<this._delegateGuids.length?this._delegateFn:this._fn},destroy:function(){this._delegateGuids=this._delegateFn=
this._fn=null;delete this._fn;delete this._delegateFn;delete this._delegateGuids}};a.each("hold tap doubletap transformstart transform transformend dragstart drag dragend swipe release".split(" "),function(c,d){a.event.special[d]={setup:function(c){var g=a(this),i=g.data("hammerjs");i||(i=new Hammer(this,c),i.__Fns={},g.data("hammerjs",i));i.__Fns[d]=new b(d,g)},add:function(b){var c=a(this).data("hammerjs");b.selector&&c.__Fns[d].addDelegate(b.guid);c["on"+d]=c.__Fns[d].getFn()},remove:function(b){var c=
a(this).data("hammerjs");b.selector&&c.__Fns[d].removeDelegate(b.guid);c["on"+d]=c.__Fns[d].getFn()},teardown:function(){var b=a(this).data("hammerjs");b.__Fns[d].destroy();delete b.__Fns[d]}}})})(jQuery);
(function(a){function b(a,b){return b.measureText(a).width}function c(a,b){b.text(a);return b.width()}var d=!1,e,g,i;a.fn.shorten=function(){var d={},h=arguments,n=h.callee;if(h.length)if(h[0].constructor==Object)d=h[0];else{if("options"==h[0])return a(this).eq(0).data("shorten-options");d={width:parseInt(h[0]),tail:h[1]}}this.css("visibility","hidden");var s=a.extend({},n.defaults,d);return this.each(function(){var h=a(this),m=h.text(),B=m.length,F,w=a("<span/>").html(s.tail).text(),D={shortened:!1,
textOverflow:!1};F="none"!=h.css("float")?s.width||h.width():s.width||h.parent().width();if(0>F)return!0;h.data("shorten-options",s);this.style.display="block";this.style.whiteSpace="nowrap";if(e){var K=a(this),O=document.createElement("canvas");ctx=O.getContext("2d");K.html(O);ctx.font=K.css("font-style")+" "+K.css("font-variant")+" "+K.css("font-weight")+" "+Math.ceil(parseFloat(K.css("font-size")))+"px "+K.css("font-family");g=ctx;i=b}else K=a('<table style="padding:0; margin:0; border:none; font:inherit;width:auto;zoom:1;position:absolute;"><tr style="padding:0; margin:0; border:none; font:inherit;"><td style="padding:0; margin:0; border:none; font:inherit;white-space:nowrap;"></td></tr></table>'),
$td=a("td",K),a(this).html(K),g=$td,i=c;K=i.call(this,m,g);if(K<F)return h.text(m),this.style.visibility="visible",h.data("shorten-info",D),!0;s.tooltip&&this.setAttribute("title",m);if(n._native&&!d.width&&(O=a("<span>"+s.tail+"</span>").text(),1==O.length&&8230==O.charCodeAt(0)))return h.text(m),this.style.overflow="hidden",this.style[n._native]="ellipsis",this.style.visibility="visible",D.shortened=!0,D.textOverflow="ellipsis",h.data("shorten-info",D),!0;w=i.call(this,w,g);F-=w;w=1.15*F;0<K-w&&
(w=Math.ceil(B*(w/K)),w=m.substring(0,w),i.call(this,w,g)>F&&(m=w,B=m.length));do B--,m=m.substring(0,B);while(i.call(this,m,g)>=F);h.html(a.trim(a("<span/>").text(m).html())+s.tail);this.style.visibility="visible";D.shortened=!0;h.data("shorten-info",D);return!0})};var h=document.documentElement.style;"textOverflow"in h?d="textOverflow":"OTextOverflow"in h&&(d="OTextOverflow");"undefined"!=typeof Modernizr&&Modernizr.canvastext?e=Modernizr.canvastext:(h=document.createElement("canvas"),e=!(!h.getContext||
!(h.getContext("2d")&&"function"===typeof h.getContext("2d").fillText)));a.fn.shorten._is_canvasTextSupported=e;a.fn.shorten._native=d;a.fn.shorten.defaults={tail:"&hellip;",tooltip:!0}})(jQuery);var SPModelSchedule=function(){this.model="schedule"};SPModelSchedule.prototype.vacation=function(a,b,c,d,e){sp.api(this.model+"."+a,b,c,d,e)};SPModelSchedule.prototype.vacations=function(a,b,c,d,e){sp.api(this.model+"."+a,b,c,d,e)};
SPModelSchedule.prototype.schedulesByUser=function(a,b){"undefined"==typeof b&&(b=!1);if("undefined"!=typeof sp.staff.data.employees[a]){if(b){var c="undefined"==typeof sp.staff.data.employees[a].schedules?{}:sp.staff.data.employees[a].schedules,d={};$.each(sp.schedule.raw.schedules,function(a,b){"undefined"!=typeof c[b.id]&&("undefined"==typeof b.location&&(b.location={name:_("Schedules")}),"undefined"==typeof d[b.location.name]&&(d[b.location.name]={name:b.location.name,data:[]}),d[b.location.name].data.push(b))});
return d}return"undefined"==typeof sp.staff.data.employees[a].schedules?{}:sp.staff.data.employees[a].schedules}return{}};SPModelSchedule.prototype.allSchedules=function(a){if("undefined"==typeof a)return sp.schedule.data.schedules;spModel.schedule.get("schedules",{},function(a){sp.schedule.raw.schedules=a.data;sp.schedule.data.schedules=sp.map(a.data);return sp.schedule.data.schedules},function(){Log.log("implement");return{}})};var SPModelRequests=function(){this.model="requests"};
SPModelRequests.prototype.vacations=function(a,b,c,d,e){sp.api(this.model+"."+a,b,c,d,e)};var SPModelAdmin=function(){this.model="admin"};SPModelAdmin.prototype.vacations=function(a,b,c,d,e){sp.api(this.model+"."+a,b,c,d,e)};var SPModelMessaging=function(){this.model="messaging"};SPModelMessaging.prototype.wall=function(a,b,c,d,e){var g=this;sp.api(this.model+"."+a,b,c,function(a){"function"==typeof d&&("get"==b&&(a.data=g.prepareWallMessages(a.data)),d.call(this,a))},e)};
SPModelMessaging.prototype.prepareWallMessages=function(a){var b=[];$.each(a,function(){var a=[];"undefined"!=typeof this.comments&&$.each(this.comments,function(){a.push({id:this.id,avatar:sp.getAvatar(this.user.id),userName:this.user.name,userId:this.user.id,time:$.timeago(new Date(1E3*this.date)),comment:this.comment_formatted,full:!0,owner:3>=parseInt(sp.staff.admin.info.group)||this.user.id==sp.staff.admin.info.id?1:0})});b.push({id:this.id,avatar:sp.getAvatar(this.user.id),userName:this.user.name,
userId:this.user.id,time:$.timeago(new Date(1E3*this.date)),sticky:parseInt(this.sticky),title:this.title_formatted,post:this.post_formatted,comments:a,owner:3>=parseInt(sp.staff.admin.info.group)||this.user.id==sp.staff.admin.info.id?1:0})});return b};var SPModelTimeClock=function(){this.model="timeclock"};SPModelTimeClock.prototype.dtc=function(a,b){spModel.timeclock.del("timeclock",{id:a},function(a){b(a)})};var SPModelStaff=function(){this.model="staff"};
SPModelStaff.prototype.allStaff=function(a){if("undefined"==typeof a)return sp.staff.raw.employees;spModel.staff.get("employees",{schedule:a},function(a){return a.data},function(){Log.log("implement");return{}})};
SPModelStaff.prototype.allSkills=function(a){if("undefined"==typeof a)return null==sp.staff.raw.skills?[]:sp.staff.raw.skills;spModel.schedule.get("schedules",{},function(a){sp.staff.raw.skills=a.data;sp.staff.data.skills=sp.map(a.data);return sp.staff.raw.skills},function(){Log.log("implement");return{}})};SPModelStaff.prototype.reset=function(){spModel.staff.get("employees",{},function(a){sp.staff.raw.employees=a.data;sp.staff.data.employees=sp.map(a.data)})};
SPModelStaff.prototype.getEmployeeById=function(a){return"undefined"==typeof sp.staff.data.employees[a]?(sp.showError("Employee doesn't exists"),sp.staff.admin.info):sp.staff.data.employees[a]};SPModelStaff.prototype.addEmployee=function(a){sp.staff.raw.employees.push(a);sp.staff.data.employees[""+a.id]=a};var SPModelPayroll=function(){this.model="payroll"},SPModelLocation=function(){this.model="location"};
SPModelLocation.prototype.locationsList=function(a){if("undefined"!=typeof a&&!0==a)spModel.location.get("locations",{},function(a){sp.staff.raw.locations=a.data;sp.staff.data.locations=sp.map(a.data)});else return sp.staff.data.locations};var SPModelTraining=function(){this.model="training"};function ShiftPlanning(){this.raw={};this.apiCalls={};this.successMessage="";this.initialize();return this.hashChange=!0}
ShiftPlanning.prototype={multiApi:function(a,b){var c=[];$.each(a,function(a,b){var g={module:b[0],method:b[1]};$.each(b[2],function(a,b){g[a]=b});c.push(g)});$.ajax({url:"api.php",dataType:"json",type:"post",data:"multi=1&data="+JSON.stringify(c),cache:!1,success:function(a){$.each(a,function(a,b){if(3==b.status)return sp.hash("logout"),user.loggedIn=0,user.name="",user.company="",sp.staff.data.employees={},window.location.reload(),!1});"function"==typeof b&&b.call(this,a)}})},api:function(a,b,c,
d,e){var g=this,i=a+"."+b+"."+JSON.stringify(c);if("undefined"!=typeof this.apiCalls[i]&&null!=this.apiCalls[i])return!1;var h={module:a,method:b};$.each(c,function(a,b){h[a]=b});this.apiCalls[i]=$.ajax({url:"api.php",dataType:"json",type:"post",data:h,cache:!1,success:function(a){g.apiCalls[i]=null;var b=!0;$.each(g.apiCalls,function(a,c){null!=c&&(b=!1)});b&&($(".bigLoader").hide(),g.apiCalls={});if(3==a.status)user.loggedIn=0,user.name="",user.company="",g.staff.data.employees={},$(".applicationContainer").fadeOut(500,
function(){window.location.reload();$("body").addClass("login");$("html").css("height","100%");$(".loginContainer").fadeIn(500)});else if(1==a.status){if("function"==typeof d){if(!1==a.data||null==a.data)a.data=[];d.call(this,a)}}else"function"==typeof e&&e.call(this,a)}})},loadPage:function(a){user.loggedIn&&"undefined"!=typeof this[a]&&($("#pages #"+a+" > div").hide(),$("#pages #"+a).show(),$(".subNavigation > div").hide(),$(".subNavigation > div."+a).show(),$(".subNavigation > div."+a+" li:first a").trigger(clickEvent),
this[a].loadPage())},nl2br:function(a){return(a+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2")},map:function(a){if(null==a)return{};var b={};$.each(a,function(){b[""+this.id]=this});return b},hash:function(a){if(a==window.location.hash.substring(1))return window.location.hash.substring(1);"undefined"!=typeof a&&(window.location.hash=a);return window.location.hash.substring(1)},outerHtml:function(a){return $("<div>").append(a.clone()).remove().html()},hasPermission:function(a){return this.staff.admin.info.group<=
a?!0:!1},currentTime:function(){var a=new Date;return months[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear()+" - "+a.getHours()+":"+(1==a.getMinutes().length?"0"+a.getMinutes():a.getMinutes())},currentUnixTime:function(){var a=(new Date).getTime();return parseInt(a/1E3)},date:function(a){return(new Date(a)).getDate()},correctTime:function(a){return 10>a?"0"+a:a},strReplace:function(a,b,c,d){var e=0,g=0,i="",h="",k=0,m=0,a=[].concat(a),b=[].concat(b),n="[object Array]"===Object.prototype.toString.call(b),
s="[object Array]"===Object.prototype.toString.call(c),c=[].concat(c);d&&(this.window[d]=0);e=0;for(k=c.length;e<k;e++)if(""!==c[e]){g=0;for(m=a.length;g<m;g++)i=c[e]+"",h=n?void 0!==b[g]?b[g]:"":b[0],c[e]=i.split(a[g]).join(h),d&&c[e]!==i&&(this.window[d]+=(i.length-c[e].length)/a[g].length)}return s?c:c[0]},getAvatar:function(a){"undefined"==typeof a&&(a=sp.staff.admin.info.id);return"undefined"!=typeof sp.staff.data.employees[a]&&"undefined"!=typeof sp.staff.data.employees[a].avatar&&""!=sp.staff.data.employees[a].avatar&&
"undefined"!=typeof sp.staff.data.employees[a].avatar.small?sp.staff.data.employees[a].avatar.small:"images/no-avatar.png"},isL:function(a){return 0<$.trim(a).length?!0:!1},isC:function(a){return $(a).hasClass("check")},countObject:function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b},countResponse:function(a){return"undefined"==typeof a.length?this.countObject(a):a.length},objToArray:function(a){if("object"==typeof a){var b=[];$.each(a,function(a,d){b.push(d)});a=b}return a}};
var ShiftPlanningModel=function(){this.cache={};this.diff=""};ShiftPlanningModel.prototype.addModel=function(a,b){$.extend(b.prototype,spModel);"undefined"==typeof this[a]&&(this[a]=new b)};
ShiftPlanningModel.prototype.get=function(a,b,c,d){if("undefined"==typeof this[a])sp.api(this.model+"."+a,"get",b,function(a){"function"==typeof c&&c.call(this,a)},function(a){sp.showError(a.error);"function"==typeof d&&d.call(this,d)});else this[a](a,"get",b,function(a){"function"==typeof c&&c.call(this,a)},function(a){sp.showError(a.error);"function"==typeof d&&d.call(this,a)})};
ShiftPlanningModel.prototype.update=function(a,b,c,d){if("undefined"==typeof this[a])sp.api(this.model+"."+a,"update",b,function(a){"function"==typeof c&&c.call(this,a)},function(a){sp.showError(a.error);"function"==typeof d&&d.call(this,d)});else this[a](a,"update",b,function(a){"function"==typeof c&&c.call(this,a)},function(a){sp.showError(a.error);"function"==typeof d&&d.call(this,a)})};
ShiftPlanningModel.prototype.create=function(a,b,c,d){if("undefined"==typeof this[a])sp.api(this.model+"."+a,"create",b,function(a){"function"==typeof c&&c.call(this,a)},function(a){sp.showError(a.error);"function"==typeof d&&d.call(this,d)});else this[a](a,"create",b,function(a){"function"==typeof c&&c.call(this,a)},function(a){sp.showError(a.error);"function"==typeof d&&d.call(this,a)})};
ShiftPlanningModel.prototype.del=function(a,b,c,d){if("undefined"==typeof this[a])sp.api(this.model+"."+a,"delete",b,function(a){"function"==typeof c&&c.call(this,a)},function(a){sp.showError(a.error);"function"==typeof d&&d.call(this,d)});else this[a](a,"delete",b,function(a){"function"==typeof c&&c.call(this,a)},function(a){sp.showError(a.error);"function"==typeof d&&d.call(this,d)})};ShiftPlanningModel.prototype.set=function(){};
ShiftPlanningModel.prototype.setCache=function(a,b){"unfedined"==typeof this.cache[a]&&(this.cache[a]={});this.cache[a][this.diff]=b};ShiftPlanningModel.prototype.clearCache=function(a){this.cache[a]={}};ShiftPlanningModel.prototype.getCache=function(a){return this.cache[a]};ShiftPlanningModel.prototype.isSetCache=function(a){return"undefined"!=typeof this.cache[a]&&0<this.cache[a].length?!0:!1};
ShiftPlanningModel.prototype.cacheDiff=function(a){if("undefined"!=typeof a)this.diff=JSON.stringify(a);else if(0==this.diff.length)Log.log("Please set diff");else return this.diff;return!0};var spModel=new ShiftPlanningModel;spModel.addModel("schedule",SPModelSchedule);spModel.addModel("requests",SPModelRequests);spModel.addModel("admin",SPModelAdmin);spModel.addModel("messaging",SPModelMessaging);spModel.addModel("timeclock",SPModelTimeClock);spModel.addModel("staff",SPModelStaff);
spModel.addModel("payroll",SPModelPayroll);spModel.addModel("location",SPModelLocation);spModel.addModel("training",SPModelTraining);var ShiftPlanningView=function(){};
ShiftPlanningView.prototype.optionSchedules=function(a,b,c){"undefined"==typeof b&&(b=!1);"undefined"==typeof c&&(c=!1);var d,e=this,a="undefined"==typeof a||0==a?spModel.schedule.allSchedules():spModel.schedule.schedulesByUser(a,c);d='<option disabled="disabled" selected="selected" value="0">'+_("Select Schedule")+"</option>";c?$.each(a,function(a,b){d+='<optgroup label="'+b.name+'">';$.each(b.data,function(a,b){d+='<option value="'+b.id+'">'+b.name+"</option>"});d+="</optgroup>"}):$.each(a,function(a,
b){e.checkPerm(b)&&(d+='<option value="'+a+'">'+("object"==typeof b?b.name:b)+"</option>")});return d};
ShiftPlanningView.prototype.staffOption=function(a){"undefined"==typeof a&&(a=!1);var b;!1==a?(b='<option disabled="disabled" selected="selected" value="0">Select Employee</option>',a=4==sp.staff.admin.info.group?sp.staff.fixed.employees:spModel.staff.allStaff(),$.each(a,function(a,d){b+='<option value="'+d.id+'">'+("object"==typeof d?d.name:d)+"</option>"})):b='<option value="'+sp.staff.admin.info.id+'">'+sp.staff.admin.info.name+"</option>";return b};
ShiftPlanningView.prototype.staffFilter=function(a){"undefined"==typeof a&&(a=!1);var b="";!1==a?(3>=sp.staff.admin.info.group&&(b='<option value="0">All Employees</option>'),a=4==sp.staff.admin.info.group?sp.staff.fixed.employees:spModel.staff.allStaff(),$.each(a,function(a,d){b+='<option value="'+d.id+'">'+("object"==typeof d?d.name:d)+"</option>"})):b='<option value="'+sp.staff.admin.info.id+'">'+sp.staff.admin.info.name+"</option>";return b};
ShiftPlanningView.prototype.scheduleFilter=function(a,b){"undefined"==typeof b&&(b=!1);var c=this,d="",e;e="undefined"==typeof a||0==a?spModel.schedule.allSchedules():spModel.schedule.schedulesByUser(a);3>=sp.staff.admin.info.group&&(d='<option value="0">All Positions</option>');$.each(e,function(a,e){c.checkPerm(e,b)&&(d+='<option value="'+a+'">'+("object"==typeof e?e.name:e)+"</option>")});return d};
ShiftPlanningView.prototype.schedulerFilter=function(a,b){"undefined"==typeof b&&(b=!1);var c=this,d;d="undefined"==typeof a||0==a?spModel.schedule.allSchedules():spModel.schedule.schedulesByUser(a);var e="";$.each(d,function(a,d){c.checkPerm(d,b)&&(e+='<option value="'+a+'">'+("object"==typeof d?d.name:d)+"</option>")});return e};
ShiftPlanningView.prototype.skillsFilter=function(a){"undefined"==typeof a&&(a=!1);var b;!1==a?(b='<option value="0">All Skills</option>',$.each(spModel.staff.allSkills(),function(a,d){b+='<option value="'+d.id+'">'+("object"==typeof d?d.name:d)+"</option>"})):b='<option value="'+sp.staff.admin.info.id+'">'+sp.staff.admin.info.name+"</option>";return b};
ShiftPlanningView.prototype.locationSelector=function(a){"undefined"==typeof a&&(a=2);var b='<option value="0" selected="selected">'+(1==a?"Select Location":"Select Work Site")+"</option>",b=b+'<optgroup lable="locations">';$.each(spModel.location.locationsList(),function(c,d){d.type==a&&(b+='<option value="'+d.id+'">'+d.name+"</option>")});return b+='</optgroup><optgroup><option value="add" type="'+a+'">'+(1==a?"New Location?":"New Work Site?")+"</option></optgroup>"};
ShiftPlanningView.prototype.timeRanges=function(){var a=spRanges.createSelector("times"),b='<option value="-1">Select</option>';$.each(a,function(a,d){b+='<option value="'+a+'" >'+d+"</option>"});return b};
ShiftPlanningView.prototype.customFields=function(a){var b="",c="",d="",e=2,g="";"undefined"!=typeof a.custom&&$.each(a.custom,function(a,d){1==d.toggle&&(g="check");if(4!=d.type){b+="<li>";b+="<div>";switch(d.type){case "1":d.value=null==d.value?"":d.value;b+="<label>"+d.name+": <h4>"+d.value+"</h4></label>";break;case "2":d.text=null==d.text?"":d.text;b+="<label>"+d.name+": <h4>"+d.text+"</h4></label>";break;case "3":d.value=null==d.value?"":d.value,b+="<label>"+d.name+": <h4>"+d.value+"</h4></label>"}b+=
"</div>";b+="</li>"}else c+="<li>",c+='<span item="edit" class="checkbox '+g+'" id='+d.id+">"+d.name+"</span>",c+="</li>",e++,g=""});d=b+c;return 0<d.length?d:this.emptyResult(_s("No custom fields to display"),"li","noBorder")};
ShiftPlanningView.prototype.editableCustomFields=function(a){var b="",c="",d="",e=2,g="";"undefined"!=typeof a.custom&&($.each(a.custom,function(a,d){1==d.toggle&&(g="check");if(4!=d.type){b+="<li>";b+="<div>";switch(d.type){case "1":b+="<label>"+d.name+':</label><span class="input"><input item="edit" id="'+d.id+'" type="text" value="'+d.value+'" name=""></span>';break;case "2":b+="<label>"+d.name+':</label><span class="input"><input item="edit" id="'+d.id+'" type="text" value="'+d.text+'" name=""></span>';
break;case "3":b+="<label>"+d.name+":</label>";b+='<span class="input"><select item="edit" id="'+d.id+'">';b+="<option>"+d.value+"</option>";var k=[],k=d.values.split(",");$.each(k,function(a,c){b+="<option>"+c+"</option>"});b+="</select></span>"}b+="</div>";b+="</li>"}else c+='<li class="'+(0==e%2?"even":"odd")+'">',c+='<span item="edit" class="checkbox '+g+'" id='+d.id+">"+d.name+"</span>",c+="</li>",e++,g=""}),d=b+"<li><ul>"+c+"</ul></li>");return 0<d.length?d:this.emptyResult(_s("No custom fields to display"),
"li","noBorder")};ShiftPlanningView.prototype.editableSchedules=function(a){var b="",c=2;$.each(spModel.schedule.allSchedules(),function(d,e){var g="undefined"!=typeof a.schedules&&"undefined"!=typeof a.schedules[e.id]?'check"':"";b+='<li class="'+(0==c%2?"even":"odd")+'">';b+="  <div>";b+='      <span class="checkbox '+g+'" itemId='+e.id+">"+e.name+"</span>";b+="  </div>";b+="</li>";c++});return 0<b.length?b:this.emptyResult(_s("No positions to display"),"li","noBorder")};
ShiftPlanningView.prototype.editableSkills=function(a){var b="",c=2;$.each(spModel.staff.allSkills(),function(d,e){var g="undefined"!=typeof a.skills&&"undefined"!=typeof a.skills[e.id]?"check":"";b+='<li class="'+(0==c%2?"even":"odd")+'">';b+="  <div>";b+='      <span class="checkbox '+g+'" itemId='+e.id+">"+e.name+"</span>";b+="  </div>";b+="</li>";c++});return 0<b.length?b:this.emptyResult(_s("No skills to display"),"li","noBorder")};ShiftPlanningView.prototype.ulLoader=function(){return'<li class="loading"></li>'};
ShiftPlanningView.prototype.divLoader=function(){return'<div class="loading"></div>'};ShiftPlanningView.prototype.emptyResult=function(a,b,c){"undefined"==typeof c&&(c="");"undefined"==typeof b&&(b="div");"undefined"==typeof a&&(a=_s("Na data for selected criteria!"));return"<"+b+' class="additional '+c+'"><p>'+a+"</p></"+b+">"};ShiftPlanningView.prototype.checkPerm=function(a,b){"undefined"==typeof b&&(b=!1);var c=1;b&&(c=2);var d=!0;"undefined"!=typeof a.perms&&(d=a.perms>=c?!0:!1);return d};
ShiftPlanningView.prototype.fixCurrency=function(a,b){"undefined"==typeof b&&(b=!1);var c=spRanges.currencies[a];if(b)return c;$("span.currency").html(c)};
ShiftPlanningView.prototype.bbc2HTML=function(a){function b(a,b){for(var c in b)a=a.replace(RegExp(c,"g"),b[c]);return a}function c(a,b,m,n){n&&-1<n.indexOf("[")&&(n=n.replace(d,c));switch(b){case "url":case "anchor":case "email":return"<a "+g[b]+(m||n)+'">'+n+"</a>";case "img":return a=e.exec(m),'<img src="'+n+'"'+(a?' width="'+a[1]+'" height="'+a[2]+'"':"")+' alt="'+(a?"":m)+'" />';case "flash":case "youtube":return a=e.exec(m)||[0,425,366],'<object type="application/x-shockwave-flash" data="'+
h[b]+n+'" width="'+a[1]+'" height="'+a[2]+'"><param name="movie" value="'+h[b]+n+'" /></object>';case "float":return'<span style="float: '+m+'">'+n+"</span>";case "left":case "right":case "center":case "justify":return'<div style="text-align: '+b+'">'+n+"</div>";case "google":case "wikipedia":return'<a href="'+i[b]+n+'">'+n+"</a>";case "b":case "i":case "u":case "s":case "sup":case "sub":case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":case "table":case "tr":case "th":case "td":return"<"+
b+">"+n+"</"+b+">";case "row":case "r":case "header":case "head":case "h":case "col":case "c":return"<"+k[b]+">"+n+"</"+k[b]+">";case "acronym":case "abbr":return"<"+b+' title="'+m+'">'+n+"</"+b+">"}return"["+b+(m?"="+m:"")+"]"+n+"[/"+b+"]"}if(0>a.indexOf("["))return a;var d=RegExp("\\[([a-z][a-z0-9]*)(?:=([^\\]]+))?]((?:.|[\r\n])*?)\\[/\\1]","g"),e=RegExp("^(\\d+)x(\\d+)$",void 0),g={url:'href="',anchor:'name="',email:'href="mailto: '},i={google:"http://www.google.com/search?q=",wikipedia:"http://www.wikipedia.org/wiki/"},
h={youtube:"http://www.youtube.com/v/",flash:""},k={row:"tr",r:"tr",header:"th",head:"th",h:"th",col:"td",c:"td"},m={notag:[{"\\[":"&#91;","]":"&#93;"},"",""],code:[{"<":"&lt;"},"<code><pre>","</pre></code>"]};m.php=[m.code[0],m.code[1]+"&lt;?php ","?>"+m.code[2]];var n={font:"font-family:$1",size:"font-size:$1px",color:"color:$1"},s={c:"circle",d:"disc",s:"square",1:"decimal",a:"lower-alpha",A:"upper-alpha",i:"lower-roman",I:"upper-roman"},u={},x={},B;for(B in m)u["\\[("+B+")]((?:.|[\r\n])*?)\\[/\\1]"]=
function(a,c,d){return m[c][1]+b(d,m[c][0])+m[c][2]};for(B in n)x["\\["+B+"=([^\\]]+)]"]='<span style="'+n[B]+'">',x["\\[/"+B+"]"]="</span>";x["\\[list]"]="<ul>";x["\\[list=(\\w)]"]=function(a,b){return'<ul style="list-style-type: '+(s[b]||"disc")+'">'};x["\\[/list]"]="</ul>";x["\\[\\*]"]="<li>";x["\\[/\\*]"]="</li>";x["\\[quote(?:=([^\\]]+))?]"]=function(a,b){return'<div class="bb-quote">'+(b?b+" wrote":"Quote")+":<blockquote>"};x["\\[/quote]"]="</blockquote></div>";x["\\[(hr|br)]"]="<$1 />";x["\\[sp]"]=
"&nbsp;";return b(b(a,u),x).replace(d,c)};ShiftPlanningView.prototype.friendly_filesize=function(a){for(var b=["TB","GB","MB","kB","b"],c=[1099511627776,1073741824,1048576,1024,1],d=0;d<c.length;d++){var e=a/c[d];if(1<e)return Math.round(10*e)/10+" "+b[d]}};
var spView=new ShiftPlanningView,ShiftPlanningRanges=function(){this.times={"0":{title:"Today",start_time:Date.parse("today").getTime(),end_time:Date.parse("today").add(1).days().getTime()},1:{title:"Yesterday",start_time:Date.parse("yesterday").getTime(),end_time:Date.parse("yesterday").add(1).days().getTime()},2:{title:"Last 7 Days",start_time:1E3*strtotime("now -7 day"),end_time:1E3*strtotime("tomorrow")},3:{title:"This Week",start_time:Date.parse("sunday").getTime(),end_time:Date.parse("next saturday").getTime()},
4:{title:"Last Week",start_time:Date.parse("today").moveToDayOfWeek(0).addWeeks(-2).getTime(),end_time:Date.parse("previous saturday").getTime()},5:{title:"This Month",start_time:1E3*strtotime("now -"+(now().getDate()-1)+" days"),end_time:Date.parse("today").moveToLastDayOfMonth().getTime()},6:{title:"Last Month",start_time:1E3*strtotime("now -"+(now().getDate()+30)+" days"),end_time:1E3*strtotime("now -"+now().getDate()+" days")},7:{title:"One Year",start_time:1E3*strtotime("last year"),end_time:1E3*
strtotime("now")}};this.currencies=" $ &#163; &#8364; &#8360; &#165; &#8361; R kr &#8369; RM".split(" ");this.weekdays={1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri",6:"Sat",7:"Sun"};this.months="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")};
ShiftPlanningRanges.prototype.fixRanges=function(){var a=this,b=6E4*Date.parse("now").getTimezoneOffset(),c=sp.staff.admin.settings.timezone.split(","),c=c[0].split(":"),d=3600*parseInt(c[0]),e=3600*parseInt(c[0])/Math.abs(3600*parseInt(c[0])),g=60*c[1];$.each(this.times,function(c,h){a.times[c].start_date=h.start_date+b+1E3*e*(Math.abs(d)+g);a.times[c].end_date=h.end_date+b+1E3*e*(Math.abs(d)+g)});a.times[3]={title:"This Week",start_time:Date.parse("sunday").add(sp.staff.admin.settings.startday-
1).days().getTime(),end_time:Date.parse("next saturday").add(sp.staff.admin.settings.startday-1).days().getTime()};a.times[4]={title:"Last Week",start_time:Date.parse("today").moveToDayOfWeek(0).addWeeks(-2).add(sp.staff.admin.settings.startday-1).days().getTime(),end_time:Date.parse("previous saturday").add(sp.staff.admin.settings.startday-1).days().getTime()}};ShiftPlanningRanges.prototype.getRange=function(a,b){return this[a][b]};
ShiftPlanningRanges.prototype.createSelector=function(a){var b=[];$.each(this[a],function(a,d){b.push(d.title)});return b};var spRanges=new ShiftPlanningRanges;function ShiftPlanningStaff(){this.changed=!0;this.page=6;this.initialize();return!0}ShiftPlanningStaff.prototype={data:{},raw:{},fixed:{},admin:{},initialize:function(){},login:function(){},loadPage:function(){}};
function ShiftPlanningSchedule(){this.initialize();this.fix=86E3;this.raw={};this.data={};this.prepared={};this.shifts={};this.shift={};this.fromStaff=this.fromDashboardUpcoming=this.fromUpcoming=this.fromRecent=this.fromDashboard=this.edit=this.loaded=!1;this.state=1;this.settings={mode:"employee",start_date:"yesterday",end_date:"yesterday"};this.page="today";this.conflicts={};return!0}
ShiftPlanningSchedule.prototype={initialize:function(){},loadPage:function(){},setConflicts:function(a){var b=this;$.each(a,function(a,d){b.conflicts[d.shift+""]=d})}};function ShiftPlanningDashboard(){this.initialize()}ShiftPlanningDashboard.prototype={templates:{},initialize:function(){},loadPage:function(){}};function ShiftPlanningTimeClock(){this.initialize();this.timeSheetsData={};this.actco=!1;this.current={};this.edit=!1;return!0}
ShiftPlanningTimeClock.prototype={times:{"0":{start_time:strtotime("now"),end_time:strtotime("now +1 day")},1:{start_time:strtotime("now -1 day"),end_time:strtotime("now")},2:{start_time:strtotime("now -7 day"),end_time:strtotime("now +1 day")},3:{start_time:Date.parse("monday").getTime()/1E3,end_time:Date.parse("next sunday").getTime()/1E3},4:{start_time:Date.parse("monday").getTime()/1E3-604800,end_time:Date.parse("sunday").getTime()/1E3}}};
var ShiftPlanningReports=function(){this.initialize();this.skills=this.employees=this.positions=this.locations="";this.page="allReports";this.timeLine=""};
ShiftPlanningReports.prototype={initialize:function(){},loadPage:function(){},times:{"0":{start_time:strtotime("now"),end_time:strtotime("now +1 day")},1:{start_time:strtotime("now -2 day"),end_time:strtotime("now")},2:{start_time:strtotime("now -7 day"),end_time:strtotime("now")},3:{start_time:Date.parse("monday").getTime()/1E3,end_time:Date.parse("next sunday").getTime()/1E3},4:{start_time:Date.parse("monday").getTime()/1E3-604800,end_time:Date.parse("sunday").getTime()/1E3},5:{start_time:strtotime("now -"+
(now().getDate()-1)+" days"),end_time:strtotime("now +1 day")},6:{start_time:strtotime("now -"+(now().getDate()+30)+" days"),end_time:strtotime("now -"+(now().getDate()-1)+" days")},7:{start_time:strtotime("last year"),end_time:strtotime("now +1 day")}}};var ShiftPlanningRequests=function(){this.initialize();this.employees=this.positions="";this.shifts=[];this.shiftsR=[];this.vacations=[];this.swaps={};this.current={};this.available={};this.trades={manage:[],requested:[],avaiting:[]}};
ShiftPlanningRequests.prototype={initialize:function(){},loadPage:function(){}};function ShiftPlanningLocation(){this.initialize();return!0}
ShiftPlanningLocation.prototype={data:{},raw:{},initialize:function(){$(document).ready(function(){$("#wrapper").delegate("select.locations","change",function(){var a=$(this);if("add"==$(this).val()){var b=prompt(_s("Enter location name."),"");null!=b&&spModel.location.create("location",{name:b,type:$(this).find("option:last").attr("type")},function(b){a.find("optgroup:first").append('<option value="'+b.data.id+'">'+b.data.name+"</option>");a.val(a.find("optgroup:first option:last").val());spModel.location.locationsList(!0)})}})})}};
var ShiftPlanningPermissions=function(){this.superUser=1;this.manager=2;this.supervisor=3;this.scheduler=4;this.employee=5;this.employees={};this.initialize()};ShiftPlanningPermissions.prototype={initialize:function(){}};function ShiftPlanningTraining(){this.initialize();this.top=this.tmp_section=this.tmp_module=0;this.scrollWindow=!1;this.trainings={};this.statistic=[]}function ShiftPlanningSettings(){this.initialize()}
ShiftPlanningStaff.prototype.initialize=function(){var a=this;$(document).ready(function(){1==user.loggedIn&&a.prepareConfig();$("#lo_b").bind(clickEvent,function(){a.login()});$("#lo_f .checkbox").bind(clickEvent,function(){$(this).toggleClass("check")});a.listEvents();a.addStaffEvents();a.fastAssignmentEvents()})};ShiftPlanningStaff.prototype.loadSubPageEvents=function(a){$("#st_tp_menu").hide();this[a+"SubEvents"]()};
ShiftPlanningStaff.prototype.listEvents=function(){var a=this;$("#st_sn_ga").bind(clickEvent,function(){if($(this).hasClass("active"))return!1;$("#st_sn_ga").addClass("active");$("#st_sn_li").removeClass("active");$("#st_li_ga").removeClass("small").addClass("big")});$("#st_sn_li").bind(clickEvent,function(){if($(this).hasClass("active"))return!1;$("#st_sn_li").addClass("active");$("#st_sn_ga").removeClass("active");$("#st_li_ga").removeClass("big").addClass("small")});$("#st_li_se_b").bind(clickEvent,
function(a){a.preventDefault();a=$("#st_li_se_te").val();0==a.length||"Search..."==a?($("#st_li_ga li").show(),$("#st_li_ga").show(),$("#st_li .noResults").hide()):($("#st_li_ga li").hide(),$("#st_li_ga").show(),$("#st_li .noResults").hide(),$("#st_li_ga li").find('span:Contains("'+a+'")').parents("li").show(),0==$("#st_li_ga li").find('span:Contains("'+a+'")').parents("li").length&&($("#st_li .noResults").show(),$("#st_li_ga").hide()))});$("#st_li_se_te").bind("keyup",function(){$("#st_li_se_b").trigger(clickEvent)});
$("#st_li_ga").delegate("li",clickEvent,function(){var b=$(this).attr("staffId");sp.permissions.hasPermission("visible_staff_details")&&(window.scrollTo(0,1),a.displayEmployee(b))})};ShiftPlanningStaff.prototype.addStaffEvents=function(){var a=this;$("#st_ae_sa").bind(clickEvent,function(){$(this).toggleClass("check")});$("#st_ae_ce_b").bind(clickEvent,function(b){b.preventDefault();a.createEmployee($(this))})};
ShiftPlanningStaff.prototype.fastAssignmentEvents=function(){var a=this;$("#st_fa_el").bind("change",function(){a.loadFastAssignment($(this).val())});$("#st_fa ul.detailsGrid ul").delegate(".checkbox",clickEvent,function(){var a=$(this).attr("itemId"),c=0<$(this).parents(".skills").length?!0:!1,d=$(this).hasClass("check")?!0:!1,e=this;$(e).parent().addClass("loading");var g={id:$("#st_fa_cu").val()};c?d?g.removeskill=a:g.addskill=a:d?g.removeschedule=a:g.addschedule=a;spModel.staff.update("employee",
g,function(a){d?$(e).removeClass("check"):$(e).addClass("check");$(e).parent().removeClass("loading");sp.settings.updateUser($("#st_fa_cu").val(),a,!1)})})};ShiftPlanningStaff.prototype.listSubEvents=function(){$("#st_tp_menu").show();$("#st_li_ga").html($.tmpl($("#te_st_list"),spModel.staff.allStaff()));$("#st_li_ga li").show();$("#st_li_se_te").val("").trigger("blur")};ShiftPlanningStaff.prototype.addStaffSubEvents=function(){this.resetAddEmployee()};
ShiftPlanningStaff.prototype.fastAssignmentSubEvents=function(){$("#st_fa_el").html(spView.staffOption());$("#st_fa_po").hide();$("#st_fa_sk").hide()};
ShiftPlanningStaff.prototype.displayEmployee=function(a){sp.hashChange=!1;sp.hash("staff/details");$("#st_tp_menu").hide();$("#pages > div").hide();$("#pages #settings .main").hide();$("#pages #settings .mainSub").hide();$("#pages #settings").show();$("#da_se_overview").show();sp.settings.overviewSubEvents(spModel.staff.getEmployeeById(a));$("#settings .mainSub.settings .subNav li:first a").trigger(clickEvent);$(".subNavigation").hide();$("#pages #settings .mainSub.settings").show()};
ShiftPlanningStaff.prototype.loadFastAssignment=function(a){var b=spModel.staff.getEmployeeById(a);$("#st_fa_cu").val(a);$("#st_fa_po ul.detailsGrid ul").html(spView.editableSchedules(b));$("#st_fa_sk ul.detailsGrid ul").html(spView.editableSkills(b));$("#st_fa_po").show();$("#st_fa_sk").show();sp.fixCheckboxes()};
ShiftPlanningStaff.prototype.createEmployee=function(a){$(a).addClass("loading");var b=this,c={};c.name=$("#st_ae_i_n").val();c.nick_name=$("#st_ae_i_nn").val();c.email=$("#st_ae_i_e").val();c.eid=$("#st_ae_i_eid").val();c.username=$("#st_ae_i_un").val();c.wage=$("#st_ae_i_hw").val();c.notes=$("#st_ae_i_no").val();$("#st_ae_sa").hasClass("check")&&(c.send_activation=1);spModel.staff.create("employee",c,function(c){$(a).removeClass("loading");spModel.staff.addEmployee(c.data);b.displayEmployee(c.data.id);
sp.showSuccess(_s("Employee successfully created!"))},function(){$(a).removeClass("loading")})};ShiftPlanningStaff.prototype.resetAddEmployee=function(){$("#st_ae_i_n").val("");$("#st_ae_i_nn").val("");$("#st_ae_i_e").val("");$("#st_ae_i_eid").val("");$("#st_ae_i_un").val("");$("#st_ae_i_hw").val("");$("#st_ae_i_no").val("");$("#st_ae_sa").removeClass("check")};
ShiftPlanningStaff.prototype.login=function(){var a=$("#lo_u").val(),b=$("#lo_p").val(),c=this;$("#lo_b").addClass("loading");sp.api("staff.login","GET",{username:a,password:b},function(a){sp.staff.admin.info=a.data.employee;null==a.data.employee.language&&(a.data.employee.language=a.data.business.language);setCookie("shiftplanning_mobile_lang",a.data.employee.language,cookieExpire);"en_US"!=a.data.employee.language&&window.location.reload();sp.multiApi([["staff.employees","GET",{}],["schedule.schedules",
"GET",{perms:1}],["admin.settings","GET",{}],["staff.skills","GET",{}],["location.locations","GET",{}]],function(b){sp.api("api.config","GET",{},function(g){sp.api("admin.business","GET",{},function(i){$(".loginContainer").fadeOut(500,function(){$("#lo_b").removeClass("loading");user.loggedIn=1;user.name=a.data.employee.name;user.company=a.data.business.name;user.phone=a.data.business.phone;sp.staff.raw.employees=b[0].data;sp.staff.data.employees=sp.map(b[0].data);sp.schedule.raw.schedules=b[1].data;
sp.schedule.data.schedules=sp.map(b[1].data);sp.staff.admin.settings=b[2].data;sp.staff.raw.skills=b[3].data;sp.staff.data.skills=sp.map(b[3].data);sp.staff.raw.locations=b[4].data;sp.staff.data.locations=sp.map(b[4].data);sp.staff.admin.info.dfAvatar=sp.getAvatar(sp.staff.admin.info.id);sp.raw.config=g.data;sp.schedule.dateId=sp.raw.config.today.id;sp.staff.admin.business=i.data;$("body").removeClass("login");$(".notification").remove();$("html").css("height","auto");sp.hash("dashboard");c.prepareConfig();
sp.permissions.preparePermissions();spRanges.fixRanges();sp.staff.fixed.employees=sp.permissions.fixStaffListing();sp.raw.config.today.formatted=Date.parse(sp.raw.config.today.formatted).toString(cal.dformat);$("#lo_f .checkbox").hasClass("check")&&(setCookie("shiftplanning_mobile_rememberme",1,cookieExpire),setCookie("shiftplanning_mobile_usertoken",a.token,cookieExpire),setCookie("shiftplanning_mobile_userid",a.data.employee.id,cookieExpire),setCookie("shiftplanning_mobile_username",user.name,cookieExpire),
setCookie("shiftplanning_mobile_usercompany",user.company,cookieExpire),setCookie("shiftplanning_mobile_userphone",user.phone,cookieExpire))})})})})},function(a){$("#lo_b").removeClass("loading");$(".login .error").html(a.error);$(".login .error").slideDown(500);$(".login input:first").focus()})};
ShiftPlanningStaff.prototype.logout=function(){if(!confirm(_s("Are you sure you want to logout?"))){var a=$("#menu .mainNav .active").attr("id").split("_");sp.hash(a[1]);return!1}sp.api("staff.logout","GET",{},function(){setCookie("shiftplanning_mobile_rememberme",0,cookieExpire);window.location.reload()},function(a){sp.showError(a.error)})};
ShiftPlanningStaff.prototype.prepareConfig=function(){var a=new Date,b=a.getMonth(),c=a.getFullYear(),d=a.getDate();cal={startday:sp.staff.admin.settings.startday,currency:{1:"$",2:"&#163;",3:"&#8364;",4:"&#8360;",5:"&#165;",6:"&#8361;",7:"R",8:"kr",9:"&#8369;",10:"RM"}[sp.staff.admin.settings.currency],tmode:"1"==sp.staff.admin.settings["24hr"]?24:12,tstring:1==parseInt(sp.staff.admin.settings["24hr"])?"HH:mm":"h:mm tt",dformat:sp.strReplace(["M","d","m","Y","j"],["MMM","dd","MM","yyyy","d"],sp.staff.admin.settings.date),
dpformat:sp.strReplace(["d","m","Y","M","j"],["dd","mm","yy","M","d"],sp.staff.admin.settings.date),user:sp.staff.admin.info.id,view:"week",mode:"overview",schedule:"",lastlength:8,focus:"employee",today:a.getMonth()+"/"+a.getDate()+"/"+a.getFullYear(),month:b,year:c,day:d,firstday:"",lastday:"",cache:{},lastcall:"",firsttime:0,height:960,timeline:{},shifts:{},schedules:{},locations:{},skills:{},employees:{},total:{},conflicts:{},locked:0}};
ShiftPlanningDashboard.prototype.initialize=function(){var a=this;$(document).ready(function(){a.dashboardEvents();a.wallEvents();a.inboxEvents();a.settingsEvents();a.upcomingShiftsEvents();a.whosonnowEvents();a.filesEvents();a.fixes()})};
ShiftPlanningDashboard.prototype.loadSubPageEvents=function(a){switch(a){case "wall":this.wallSubEvents();break;case "upcomingShifts":this.upcomingShiftsSubEvents();break;case "files":this.filesSubEvents();break;case "inbox":this.inboxSubEvents();break;case "settings":this.settingsSubEvents();break;case "whosonnow":this.whosonnowSubEvents();break;case "dashboard":this.dashboardSubEvents();break;case "logout":sp.staff.logout();break;case "pingUser":this.pingUser()}};
ShiftPlanningDashboard.prototype.dashboardEvents=function(){$("#da_widgets").delegate(".timeClock a",clickEvent,function(a){a.preventDefault();sp.loadSubPage("","timeClock","overview")});$("#da_widgets").delegate(".tradePage",clickEvent,function(a){a.preventDefault();sp.loadSubPage("","requests","available")});$("#da_widgets").delegate("ul.shifts a",clickEvent,function(a){a.preventDefault();$(this).addClass("loading");spModel.schedule.get("shift",{id:$(this).attr("rel"),detailed:1},function(a){sp.schedule.fromDashboard=
!0;sp.schedule.shift=a.data;sp.loadSubPage("","schedule","shiftDisplay")})});$("#da_widgets").delegate(".schedule a",clickEvent,function(a){a.preventDefault();$("#menu_schedule a").trigger(clickEvent)});$("#da_widgets").delegate(".user a",clickEvent,function(a){a.preventDefault();$("#menu_settings a").trigger(clickEvent)})};
ShiftPlanningDashboard.prototype.wallEvents=function(){var a=this;$("#da_wa_nm_b").bind(clickEvent,function(a){a.preventDefault();$("#da_wa_nm_f").toggleClass("hidden");$("#da_wa_nm_ti").val("");$("#da_wa_nm_me").val("")});$("#da_wa_nm_st").bind(clickEvent,function(a){a.preventDefault();$(this).toggleClass("check")});$("#da_wa_nm_ca").bind(clickEvent,function(a){a.preventDefault();$("#da_wa_nm_b").trigger(clickEvent)});$("#da_wa_nm_sa").bind(clickEvent,function(b){b.preventDefault();var c=$(this);
c.addClass("loading");b={};b.title=sp.isL($("#da_wa_nm_ti").val())?$.trim($("#da_wa_nm_ti").val()):"";if(!sp.isL($("#da_wa_nm_me").val()))return sp.showError(_s("Message must be entered")),!1;b.post=$.trim($("#da_wa_nm_me").val());spModel.messaging.create("wall",b,function(){c.removeClass("loading");$("#da_wa_nm_f").toggleClass("hidden");$("#da_wa_nm_ti").val("");$("#da_wa_nm_me").val("");a.wallSubEvents()},function(){c.removeClass("loading")})});$("#da_wa_li").delegate(".msgRpl, .cmtCount",clickEvent,
function(a){a.preventDefault();a=$(this).attr("rel");$("#da_wa_msg_"+a).find(".cmts").is(":visible")?($(this).hasClass("msgRpl")&&$("#da_wa_msg_"+a).find("input[type=text]").val($("#da_wa_msg_"+a).find("input[type=text]").attr("origin")),$("#da_wa_msg_"+a).find(".cmtCount").show(),$("#da_wa_msg_"+a).find(".cmts").hide()):($("#da_wa_msg_"+a).find(".cmtCount").hide(),$("#da_wa_msg_"+a).find(".cmts").show(),$(this).hasClass("msgRpl")&&$("#da_wa_msg_"+a).find("input[type=text]").focus())});$("#da_wa_li").delegate(".msgDel",
clickEvent,function(a){a.preventDefault();var c=$(this);if(confirm(_s("Do you want to delete this message?"))){var a=$(this).attr("rel"),d="message";$(this).hasClass("comment")&&(d="comment");spModel.messaging.del("wall",{id:a,"delete":d},function(){c.parent().fadeOut("fast",function(){$(this).remove()})})}});$("#da_wa_li").delegate("input[type=text]","focus",function(){$(this).attr("origin",$(this).val());$(this).val("")});$("#da_wa_li").delegate("input[type=submit]",clickEvent,function(){var a=
$(this),c=$(this).attr("rel"),d=$.trim($("#da_wa_msg_"+c+" input[type=text]").val());if(0==d.length||"Write a comment..."==d)return alert(_s("Please write your message")),!1;spModel.messaging.create("wall",{post:d,id:c},function(){var e={avatar:sp.staff.admin.info.dfAvatar,id:c,userName:sp.staff.admin.info.name,comment:d,time:"Now",full:!1};a.parent().before($.tmpl($("#te_da_wa_me_co"),e));$("#da_wa_msg_"+c+" input[type=text]").val("Write a comment...")});return!0});$("#da_wa_li").delegate("input[type=text]",
"keyup",function(a){13==(a.keyCode?a.keyCode:a.which)&&$(this).parent().parent().find("input[type=submit]").trigger(clickEvent)})};ShiftPlanningDashboard.prototype.filesEvents=function(){};
ShiftPlanningDashboard.prototype.upcomingShiftsEvents=function(){$("#da_up .shifts a").bind(clickEvent,function(a){a.preventDefault();sp.loadSubPage("","schedule","today")});$("#da_up_li").delegate("li a",clickEvent,function(a){a.preventDefault();$(this).addClass("loading");spModel.schedule.get("shift",{id:$(this).attr("rel"),detailed:1},function(a){sp.schedule.fromDashboardUpcoming=!0;sp.schedule.shift=a.data;sp.loadSubPage("","schedule","shiftDisplay")})})};
ShiftPlanningDashboard.prototype.inboxEvents=function(){var a=this;$("#da_in_me").delegate(".msgHead",clickEvent,function(a){a.preventDefault();var a=$(this).attr("messageId"),c=$(this);c.hasClass("extended")?c.parent().toggleClass("extended"):($(c).addClass("loading"),spModel.messaging.update("message",{id:a,read:1},function(){c.parent().toggleClass("extended");c.parent().removeClass("unread");$(c).removeClass("loading")}))});$("#da_in_nm_b, #da_in_nm_ca").bind(clickEvent,function(a){a.preventDefault();
$("#da_in_nm_f").toggleClass("hidden");$("#da_in_nm_ti").val("");$("#da_in_nm_me").val("");$("#da_in_nm_to").val(0)});$("#da_in_nm_sa").bind(clickEvent,function(){a.sendMessage()});$("#da_in_me").delegate("a.butRpl",clickEvent,function(a){a.preventDefault();var c=$(this).attr("rel");$("#da_in_msg_"+c).find(".newMsg").show(function(){$(this).find("input[type=text]").val("re: "+$("#da_in_msg_"+c).find(".msgHead h5").html())})});$("#da_in_me").delegate("a.butDel",clickEvent,function(a){a.preventDefault();
if(!confirm(_s("Are you sure you want to delete this messaage?")))return!1;var c=$(this).attr("rel");spModel.messaging.del("message",{id:c},function(){$("#da_in_msg_"+c).fadeOut("fast",function(){$(this).remove()})})});$("#da_in_me").delegate(".msgBody .newMsg .title .fr",clickEvent,function(b){b.preventDefault();var b=$(this).parents(".newMsg"),c=$(this).find("a");c.addClass("loading");b={subject:b.find("input[type=text]").val(),message:b.find("textarea").val(),to:b.find("input[type=hidden]").val()};
spModel.messaging.create("message",b,function(){a.inboxSubEvents()},function(){c.removeClass("loading")})});$("#da_in_me").delegate(".msgBody .newMsg .title .fl",clickEvent,function(a){a.preventDefault();a=$(this).parents(".newMsg");a.find("input[type=text]").val("");a.find("textarea").val("");a.hide("fast")})};ShiftPlanningDashboard.prototype.settingsEvents=function(){};
ShiftPlanningDashboard.prototype.whosonnowEvents=function(){var a=this;$("#da_wo .timeSheet").delegate("a.fr",clickEvent,function(b){b.preventDefault();a.pingID=$(this).attr("userID");b=sp.staff.data.employees[a.pingID];0==b.cell_phone.length&&null==b.email||0==b.email.length?sp.showError("This user haven't set cell phone or email"):sp.loadSubPage("","dashboard","pingUser")});$("#pingUser .backMenu").bind(clickEvent,function(a){a.preventDefault();$("#da_who_tmpl div").unbind(clickEvent);$("#da_who_send").unbind(clickEvent);
$(".subNavigation .dashboard li.active a").trigger("click")})};ShiftPlanningDashboard.prototype.wallSubEvents=function(){0!=parseInt(sp.staff.admin.settings.message_wall_on)&&($("#da_wa_li").html(spView.ulLoader()),spModel.messaging.get("wall",{},function(a){0<a.data.length?$("#da_wa_li").html($.tmpl($("#te_da_wa_me"),a.data)):$("#da_wa_li").html(spView.emptyResult(_s("No wall messages"),"li"))},function(){$("#da_wa_li").html(spView.emptyResult(_s("Something went wrong"),"li"))}))};
ShiftPlanningDashboard.prototype.filesSubEvents=function(){$("#da_fi_list").html(spView.ulLoader());spModel.admin.get("files",{},function(a){$.each(a.data,function(){switch(this.extension){case "jpg":case "jpeg":case "png":case "bmp":this.extraclass="image";break;case "txt":case "doc":this.extraclass="txt";break;case "xls":case "csv":this.extraclass="doc";break;case "pdf":this.extraclass="pdf";break;default:this.extraclass="other"}this.file_size=spView.friendly_filesize(this.file_size)});0==a.data.length?
$("#da_fi_list").html(spView.emptyResult(_s("Currently no files for download"),"li")):$("#da_fi_list").html($.tmpl($("#te_da_fi_list"),a.data));$("#da_fi_list li:even").addClass("regular")})};
ShiftPlanningDashboard.prototype.upcomingShiftsSubEvents=function(){$("#da_up_li").html(spView.ulLoader());var a={start_date:"today",end_date:"today +2 months",mode:"employee"};a.employees=sp.staff.admin.info.id;spModel.schedule.get("shifts",a,function(a){var c=[];"undefined"!=typeof a.data&&0<a.data.length&&(c=a.data);0<c.length?$("#da_up_li").html($.tmpl($("#te_da_widget_shift"),c)):$("#da_up_li").html(spView.emptyResult(_s("No upcoming shifts"),"li"))})};
ShiftPlanningDashboard.prototype.inboxSubEvents=function(){$("#da_in_me").html(spView.ulLoader());spModel.messaging.get("messages",{mode:"to"},function(a){0<a.data.length?$("#da_in_me").html($.tmpl($("#te_da_wa_in"),a.data)):$("#da_in_me").html(spView.emptyResult(_s("No messages in your inbox"),"li"))},function(){$("#da_in_me").html(spView.emptyResult(_s("Something went wrong"),"li"))});$("#da_in_nm_to").html(spView.staffOption())};
ShiftPlanningDashboard.prototype.whosonnowSubEvents=function(){$("#wrapper > .subNavigation").show();this.getWhosOn()};
ShiftPlanningDashboard.prototype.dashboardSubEvents=function(){$("#da_widgets .widgets").html(spView.ulLoader());$("#da_widgets ul.shifts.listing").hide();sp.multiApi([["timeclock.status","GET",{details:1}],["schedule.shifts","GET",{mode:"open"}],["schedule.trades","GET",{}],["schedule.shifts","GET",{start_date:"today",end_date:"today +2 months",mode:"employee"}],["schedule.trades","get",{mode:"swap"}]],function(a){$("#da_widgets .widgets").html("");$("#da_widgets .widgets").append($.tmpl($("#te_da_widget_profile"),
{avatar:sp.getAvatar(),name:user.name,company:user.company}));0!=parseInt(sp.staff.admin.settings.timeclock)&&("out"!=a[0].data?$("#da_widgets .widgets").append($.tmpl($("#te_da_widget_timeclock_in"),{time:a[0].data.current_length.hours+_s("h")+" "+a[0].data.current_length.mins+_("mins")})):$("#da_widgets .widgets").append($.tmpl($("#te_da_widget_timeclock_out"))));$("#da_widgets .widgets").append($.tmpl($("#te_da_widget_tradePage"),{count:sp.countResponse(a[1].data)+sp.countResponse(a[2].data)+sp.countResponse(a[4].data)}));
var b=0;$.each(a[3].data,function(a,d){d.start_date.id==sp.raw.config.today.id&&b++;if(d.start_date.id>sp.raw.config.today)return!1});$("#da_widgets .widgets").append($.tmpl($("#te_da_widget_schedule"),{month:sp.raw.config.today.mname.toUpperCase(),day:sp.raw.config.today.day,count:b}));0<a[3].data.length?($("#da_widgets ul.shifts.listing").show(),$("#da_widgets ul.shifts.listing").html($.tmpl($("#te_da_widget_shift"),a[3].data))):$("#da_widgets ul.shifts.listing").hide();$(".applicationContainer").fadeIn(500)})};
ShiftPlanningDashboard.prototype.preparePasswordField=function(){$("#da_se_pa_np").val("");$("#da_se_pa_cp").val("")};
ShiftPlanningDashboard.prototype.getWhosOn=function(){var a=[];$("#da_wo_li").html(spView.ulLoader());spModel.schedule.get("shifts",{mode:"onnow"},function(b){var c=0;$.each(b.data,function(b,e){"undefined"!=typeof e.employees&&null!=e.employees&&$.each(e.employees,function(b,d){var h={userID:d.id,avatar:sp.getAvatar(d.id),name:d.name,position:e.schedule_name,start_time:e.start_time.time,end_time:e.end_time.time};c++;a.push(h)})});0==c?$("#da_wo_li").html(spView.emptyResult("No one is scheduled to work right now.",
"li")):$("#da_wo_li").html($.tmpl($("#te_da_onnow"),a))})};ShiftPlanningDashboard.prototype.pingUser=function(){var a=this,b=sp.staff.data.employees[a.pingID];b.company=user.company;b.company_phone=user.phone;$("#wrapper > .subNavigation").hide();$("#da_who_ping").html($.tmpl($("#te_da_ping"),b));$("#da_who_tmpl div.title1").bind(clickEvent,function(){$("#da_who_txt").val($(this).find("span").html())});$("#da_who_send").bind(clickEvent,function(b){b.preventDefault();a.sendPingMessage()})};
ShiftPlanningDashboard.prototype.sendPingMessage=function(){var a=$("#da_who_txt").val();spModel.staff.create("ping",{to:this.pingID,message:a},function(){sp.showSuccess("Ping sent to user");setTimeout(function(){$("#pingUser .backMenu").trigger("click")},3E3)})};
ShiftPlanningDashboard.prototype.sendMessage=function(){var a=this,b={subject:$("#da_in_nm_ti").val(),message:$("#da_in_nm_me").val(),to:$("#da_in_nm_to").val()};spModel.messaging.create("message",b,function(){$("#da_in_nm_b").trigger(clickEvent);a.inboxSubEvents()})};ShiftPlanningDashboard.prototype.fixes=function(){$("#dashboard .mainSub ul li a[subpage]").shorten();$(".mainNav a[page]").shorten()};
ShiftPlanningStaff.prototype.getStaff=function(a){sp.api("staff.employees","get",{},function(b){sp.staff.raw.employees=b.data;sp.staff.data.employees=sp.map(b.data);"undefined"!=typeof a&&a()},function(a){sp.showError(a.error)})};ShiftPlanningDashboard.prototype.loadPage=function(){};ShiftPlanningTimeClock.prototype.initialize=function(){var a=this;$(document).ready(function(){a.overviewEvents();a.addClockTimeEvents();a.manageTimeSheetsEvents();a.displayTimeSheetsEvents()})};
ShiftPlanningTimeClock.prototype.loadSubPageEvents=function(a){$(".subNavigation").show();"displayTimeClock"==a&&$(".subNavigation").hide();this[a+"SubEvents"]()};
ShiftPlanningTimeClock.prototype.overviewEvents=function(){var a=this;$("#tc_ov_ci").bind(clickEvent,function(a){a.preventDefault();var c={},d=!1,e=function(){spModel.timeclock.get("clockin",c,function(a){$("#tc_ov_cb span.fr a").hide();$("#tc_ov_way_msg").hide();$("#tc_ov_cf").show();$("#tc_ov_co").show();$("#tc_ov_ca").attr("rel",a.data.id);$("#tc_ov_no").val("");$("#tc_ov_ss").val(0)})},g=function(){d=!0;sp.showError(_s("Coordinates not available"));setTimeout(e,2E3)};"1"==sp.staff.admin.business.pref_tc_gps&&
navigator.geolocation?(setTimeout(function(){d||g()},1E4),sp.showSuccess(_s("Getting Coordinates")),navigator.geolocation.getCurrentPosition(function(a){"function"!=typeof a&&(d=!0,c.latitude=a.coords.latitude,c.longitude=a.coords.longitude,setTimeout(e,2E3))},g)):e()});$("#tc_ov_way").bind(clickEvent,function(a){a.preventDefault();spModel.timeclock.create("preclockin",{employee:sp.staff.admin.info.id},function(a){$("#tc_ov_way_msg .sc_way_time_since").html(a.data.formatted);$("#tc_ov_way_msg").show();
$("#tc_ov_way").hide();$("#tc_ov_ci").show()})});$("#tc_ov_co").bind(clickEvent,function(a){a.preventDefault();var c={},a=$.trim($("#tc_ov_no").val());0!=$("#tc_ov_ss").val()&&(c.schedule=$("#tc_ov_ss").val());var d=!1,e=function(){spModel.timeclock.get("clockout",c,function(){$("#tc_ov_cb span.fr a").hide();$("#tc_ov_cf").hide();"1"==sp.staff.admin.business.pref_pre_time_clock&&($("#tc_ov_way").show(),$("#tc_ov_ci").show());"1"==sp.staff.admin.business.pref_mandatory_pre_time_clock&&($("#tc_ov_way").show(),
$("#tc_ov_ci").hide())})},g=function(){d=!0;sp.showError(_s("Coordinates not available"));setTimeout(function(){e()},2E3)};if(sp.staff.admin.business.pref_tc_require_pos&&0==$("#tc_ov_ss").val())return sp.showError(_s("Please choose schedule first")),!1;0!=a.length&&(c.notes=$("#tc_ov_no").val());if(sp.staff.admin.business.pref_tc_require_notes&&0==a.length)return sp.showError(_s("Please provide some notes")),!1;"1"==sp.staff.admin.business.pref_tc_gps&&navigator.geolocation?(setTimeout(function(){d||
g()},1E4),sp.showSuccess(_s("Getting Coordinates")),navigator.geolocation.getCurrentPosition(function(a){"function"!=typeof a&&(d=!0,c.latitude=a.coords.latitude,c.longitude=a.coords.longitude,setTimeout(e,2E3))},g)):e()});$("#tc_ov_ss").bind("change",function(){a.saveClockInChanges()});$("#tc_ov_sa").bind(clickEvent,function(b){b.preventDefault();a.saveClockInChanges()});$("#tc_ov_ca").bind(clickEvent,function(a){a.preventDefault();spModel.timeclock.dtc($(this).attr("rel"),function(){$("#tc_ov_cb span.fr a").hide();
$("#tc_ov_cf").hide();"1"==sp.staff.admin.business.pref_pre_time_clock&&($("#tc_ov_way").show(),$("#tc_ov_ci").show());"1"==sp.staff.admin.business.pref_mandatory_pre_time_clock&&($("#tc_ov_way").show(),$("#tc_ov_ci").hide())})})};
ShiftPlanningTimeClock.prototype.manageTimeSheetsEvents=function(){var a=this;$("#tc_mts_adv").bind(clickEvent,function(a){a.preventDefault();$("#tc_mts_hiin").hasClass("hidden")?$(this).html("Simple"):$(this).html("Advanced");$("#tc_mts_hiin").toggleClass("hidden")});$("#tc_mts_tr").bind("change",function(){"-1"!=$(this).val()&&a.getTimeSheets()});$("#tc_mts_sh").delegate("li",clickEvent,function(b){"tPending"!=b.target.className&&($(this).addClass("loading"),spModel.timeclock.get("timeclock",{id:$(this).attr("timeclockId")},
function(b){a.current=b.data;sp.loadSubPage("","timeClock","displayTimeClock")}))});$("#timeClock .displayTimeClock .backMenu").bind(clickEvent,function(a){a.preventDefault();$(".subNavigation .timeClock li.active a").trigger(clickEvent)});$("#tc_mts_hiin select, #tc_mts_au").bind("change",function(){a.showHideTimeSheets()});$("#tc_dtc_buttons a").bind(clickEvent,function(b){b.preventDefault();b=$(this).attr("rel");switch($(this).attr("class")){case "approve":spModel.timeclock.update("timeclock",
{id:b,approved:1},function(){sp.showSuccess(_s("Timeclock updated"));$(".subNavigation .timeClock li.active a").trigger(clickEvent)});break;case "unapprove":spModel.timeclock.update("timeclock",{id:b,approved:0},function(){sp.showSuccess(_s("Timeclock updated"));$(".subNavigation .timeClock li.active a").trigger(clickEvent)});break;case "edit":a.edit=!0;$("#tc_act_onci").hide();sp.loadSubPage("","timeClock","addClockTime");break;case "delete":confirm(_s("Are you sure?"))&&spModel.timeclock.del("timeclock",
{id:b},function(){$(".subNavigation .timeClock li.active a").trigger(clickEvent)})}});$("#tc_mts_sh").delegate("li span.tPending",clickEvent,function(){$(this).parent("li").addClass("loading");spModel.timeclock.get("clockout",{employee:$(this).attr("user")},function(){sp.showSuccess(_s("User clocked out"));a.getTimeSheets()})})};
ShiftPlanningTimeClock.prototype.addClockTimeEvents=function(){var a=this;$("#tc_act_onci").bind(clickEvent,function(){$(this).toggleClass("check");$("#tc_act .detailsGrid .odd").toggleClass("nonVisible")});$("#tc_act_sa_b").bind(clickEvent,function(b){b.preventDefault();a.saveClockTime(!1)})};
ShiftPlanningTimeClock.prototype.displayTimeSheetsEvents=function(){var a=this;$("#tc_dts_au").bind("change",function(){a.showHideTimeSheetsPro()});$("#tc_dts_tr").bind("change",function(){"-1"!=$(this).val()&&a.getMyTimeSheets()})};ShiftPlanningTimeClock.prototype.displayTimeSheetsSubEvents=function(){$("#tc_dts_tr").html(spView.timeRanges());$("#tc_dts_tr").val(3);this.getMyTimeSheets()};
ShiftPlanningTimeClock.prototype.overviewSubEvents=function(){$("#tc_ov_cf").hide();$("#tc_ov_cb span.fr a").hide();$("#tc_ov_ss").html(spView.optionSchedules(sp.staff.admin.info.id));$("#tc_ov_cb .icoClock").html('<time style="height:35px;display:block;">'+sp.raw.config.today.formatted+"</time>");$.ajax({url:"index.php?timezone=false&id="+sp.staff.admin.info.id,type:"get",success:function(a){$("#tc_ov_cb .icoClock").html(a)}});0==parseInt(sp.staff.admin.settings.tc_terminal_lock)?($("#tc_ov_cb").show(),
$("#tc_ov_ad").hide(),spModel.timeclock.get("status",{details:1},function(a){$("#tc_ov_cb span.fr a").hide();"out"!=a.data?($("#tc_ov_cf").show(),$("#tc_ov_co").show(),$("#tc_ov_ca").attr("rel",a.data.id),null!=a.data.schedule&&$("#tc_ov_ss").val(a.data.schedule.id),null!=a.data.notes&&$("#tc_ov_no").val(a.data.notes)):($("#tc_ov_cf").hide(),spModel.timeclock.get("preclockin",{employee:sp.staff.admin.info.id},function(a){"0"==a.data.status?($("#tc_ov_way_msg .sc_way_time_since").html(a.data.formatted),
$("#tc_ov_way_msg").show(),$("#tc_ov_ci").show()):("1"==sp.staff.admin.business.pref_pre_time_clock&&($("#tc_ov_way").show(),$("#tc_ov_ci").show()),"1"==sp.staff.admin.business.pref_mandatory_pre_time_clock&&($("#tc_ov_way").show(),$("#tc_ov_ci").hide()))}))})):($("#tc_ov_cb").hide(),$("#tc_ov_cf").hide(),$("#tc_ov_ad").show());$("#tc_ov_cb .icoClock time").html(sp.raw.config.today.formatted);$("#tc_ov_cb .icoClock span").html(formatted("nowT"))};
ShiftPlanningTimeClock.prototype.manageTimeSheetsSubEvents=function(){var a=this,b=Date.parse("today at 9am"),c=Date.parse("today at 5pm");$("#tc_mts_sd_i").scroller("destroy");$("#tc_mts_sd_i").val(b.toString(cal.dformat));$("#tc_mts_sd_i").scroller({preset:"date",dateFormat:"mmM d, yy"==sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat)?sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).substr(2,sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).length):sp.strReplace(["MM","yyyy"],["mm","yy"],
cal.dformat),dateOrder:sp.strReplace(["MM","yyyy"," ","-","/"],["mm","yy","","",""],cal.dformat),onSelect:function(){$("#tc_mts_tr").val(-1);a.getTimeSheets()}});$("#tc_mts_ed_i").scroller("destroy");$("#tc_mts_ed_i").val(c.toString(cal.dformat));$("#tc_mts_ed_i").scroller({preset:"date",dateFormat:"mmM d, yy"==sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat)?sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).substr(2,sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).length):sp.strReplace(["MM",
"yyyy"],["mm","yy"],cal.dformat),dateOrder:sp.strReplace(["MM","yyyy"," ","-","/"],["mm","yy","","",""],cal.dformat),onSelect:function(){$("#tc_mts_tr").val(-1);a.getTimeSheets()}});$("#tc_mts_tr").html(spView.timeRanges());$("#tc_mts_tr").val(3);$("#tc_mts_scl").html(spView.scheduleFilter(0,!0));$("#tc_mts_eml").html(spView.staffFilter());a.getTimeSheets()};
ShiftPlanningTimeClock.prototype.addClockTimeSubEvents=function(){var a={};!1!=this.edit?(a=this.current,$("#tc_act .title h3").html(_s("Edit Clock Time")),$("#tc_act_tc_id").removeClass("editOn").addClass("editOn"),$("#tc_act_tc_id").val(a.id),$(".addClockTime .odd").removeClass("nonVisible"),$("#tc_act_onci").removeClass("check"),a.in_time.time=sp.strReplace(["am","pm"],[" AM"," PM"],a.in_time.time),a.out_time.time=sp.strReplace(["am","pm"],[" AM"," PM"],a.out_time.time),a.in_time.day=Date.parse(a.in_time.day).toString(cal.dformat),
a.out_time.day=Date.parse(a.out_time.day).toString(cal.dformat)):($("#tc_act .title h3").html(_s("Add Clock Time")),$("#tc_act_tc_id").removeClass("editOn"),$("#tc_act_onci").show(),a.in_timestamp=Date.parse("today at 9am").getTime()/1E3,a.out_timestamp=Date.parse("today at 5pm").getTime()/1E3);$("#tc_act_sc").html(spView.optionSchedules(4<sp.staff.admin.info.group?sp.staff.admin.info.id:0));$("#tc_act_em").html(spView.staffOption(4<sp.staff.admin.info.group?!0:!1));var b=new Date(1E3*a.in_timestamp),
c=new Date(1E3*a.out_timestamp),d=24==cal.tmode?"HH:mm":"hh:mm tt";$("#tc_act_tclin").scroller("destroy");$("#tc_act_tclin").val(this.edit?a.in_time.time:b.toString(d));$("#tc_act_tclin").scroller({preset:"time",ampm:24==cal.tmode?!1:!0,stepMinute:15,timeFormat:sp.strReplace(["tt","mm"],["A","ii"],cal.tstring)});$("#tc_act_tclou").scroller("destroy");$("#tc_act_tclou").val(this.edit?a.out_time.time:c.toString(d));$("#tc_act_tclou").scroller({preset:"time",ampm:24==cal.tmode?!1:!0,stepMinute:15,timeFormat:sp.strReplace(["tt",
"mm"],["A","ii"],cal.tstring)});$("#tc_act_c_cl_dp_i").scroller("destroy");$("#tc_act_c_cl_dp_i").val(this.edit?a.in_time.day:b.toString(cal.dformat));$("#tc_act_c_cl_dp_i").scroller({preset:"date",dateFormat:"mmM d, yy"==sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat)?sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).substr(2,sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).length):sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat),dateOrder:sp.strReplace(["MM","yyyy"," ","-","/"],
["mm","yy","","",""],cal.dformat)});$("#tc_act_c_co_dp_i").scroller("destroy");$("#tc_act_c_co_dp_i").val(this.edit?a.out_time.day:c.toString(cal.dformat));$("#tc_act_c_co_dp_i").scroller({preset:"date",dateFormat:"mmM d, yy"==sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat)?sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).substr(2,sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).length):sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat),dateOrder:sp.strReplace(["MM","yyyy"," ","-",
"/"],["mm","yy","","",""],cal.dformat)});$("#tc_act_no").val(this.edit?a.notes:"");$("#tc_act_em").val(this.edit?a.employee.id:0);$("#tc_act_sc").val(this.edit?null!=a.schedule?a.schedule.id:0:0);this.edit=!1};
ShiftPlanningTimeClock.prototype.displayTimeClockSubEvents=function(){this.current.employee.avatar=sp.getAvatar(this.current.employee.id);$("#tc_dtc").html($.tmpl($("#te_tc_dtc"),this.current));$("#tc_dtc_buttons a").attr("rel",this.current.id);0!=parseInt(this.current.approved_by)?$("#tc_dtc_buttons a#tc_dtc_ap").removeClass("approve").removeClass("unapprove").addClass("unapprove"):$("#tc_dtc_buttons a#tc_dtc_ap").removeClass("approve").removeClass("unapprove").addClass("approve")};
ShiftPlanningTimeClock.prototype.getTimeSheets=function(){$("#tc_mts_sh").html(spView.divLoader());var a=this,b={},c=$("#tc_mts_tr").val(),d={},d="-1"!=c?spRanges.getRange("times",c):{start_time:Date.parse($("#tc_mts_sd_i").val()).getTime(),end_time:Date.parse($("#tc_mts_ed_i").val()).getTime()},c=new Date(d.start_time),d=new Date(d.end_time);$("#tc_mts_sd_i").val(c.toString(cal.dformat));$("#tc_mts_ed_i").val(d.toString(cal.dformat));b.start_date=c.toString(cal.dformat);b.end_date=d.toString(cal.dformat);
spModel.timeclock.get("timeclocks",b,function(b){a.renderManageTimeSheets(b.data)})};
ShiftPlanningTimeClock.prototype.getMyTimeSheets=function(){$("#tc_dts_ul").html(spView.ulLoader());var a=this,b=$("#tc_dts_tr").val(),c={},d={},c=spRanges.getRange("times",b),b=new Date(c.end_time);d.start_date=(new Date(c.start_time)).toString(cal.dformat);d.end_date=b.toString(cal.dformat);d.employee=sp.staff.admin.info.id;spModel.timeclock.get("timeclocks",d,function(b){$("#tc_dts_ul").html($.tmpl($("#te_tc_dts_li"),b.data));a.showHideTimeSheetsPro()})};
ShiftPlanningTimeClock.prototype.renderManageTimeSheets=function(a){for(var b=a.length,c={};b--;){var d=a[b],e=Date.parse(d.in_time.day).getTime()/1E3+"";"undefined"==typeof c[e]&&(c[e]={month:d.in_time.day,rest:[],ident:parseInt(e)});d=this.rItem(d);c[e].rest.push(d)}$.each(c,function(a){c[a].rest.reverse()});var g=[],i=0;$.each(c,function(a,b){g[i]=b;i++});g.objSort("ident");g.reverse();$("#tc_mts_sh").html("");$("#tc_mts_sh").html($.tmpl($("#te_tc_mts_li"),g));this.showHideTimeSheets()};
ShiftPlanningTimeClock.prototype.rItem=function(a){var b={},b=2;0<parseInt(a.approved_by)&&(b=1);return b={id:a.id,name:a.employee.name,user:a.employee.id,st:a.in_time,out:a.out_time,dl:a.in_location==a.out_location?"0":"1",length:a.length,schedule:null!=a.schedule&&"undefined"!=typeof a.schedule.id?a.schedule.id:a.schedule,scn:null!=a.schedule&&"undefined"!=typeof a.schedule.name?a.schedule.name:"",status:b,approved_by:a.approved_by}};
ShiftPlanningTimeClock.prototype.showHideTimeSheetsPro=function(){switch($("#tc_dts_au").val()){case "2":$("#tc_dts_ul li").hide();$("#tc_dts_ul").find("li.app_0").show();break;case "1":$("#tc_dts_ul li").show();$("#tc_dts_ul").find("li.app_0").hide();break;case "0":$("#tc_dts_ul li").show()}0==$("#tc_dts_ul li:visible").length?$("#tc_dts_ul_msg").html(spView.emptyResult("No timesheets for selected filters")):$("#tc_dts_ul_msg").html("")};
ShiftPlanningTimeClock.prototype.showHideTimeSheets=function(){var a=parseInt($("#tc_mts_au").val()),b=parseInt($("#tc_mts_eml").val()),c=parseInt($("#tc_mts_scl").val()),d="";0!=a&&(d+=".s_"+a);0!=b&&(d+=".e_"+b);0!=c&&(d+=".sc_"+c);$("#tc_mts_sh").find("li").hide();$("#tc_mts_sh").find("li"+d).show();$("#tc_mts_sh div.title").hide();$("#tc_mts_sh ul li:visible").parents(".timeSheet").prev().show();0<$("#tc_mts_sh ul li:visible").length?$("#tc_mts_sh").next().hide():$("#tc_mts_sh").next().show()};
ShiftPlanningTimeClock.prototype.saveClockInChanges=function(){var a={id:$("#tc_ov_ca").attr("rel")};0!=$("#tc_ov_ss").val()&&(a.schedule=$("#tc_ov_ss").val());0!=$("#tc_ov_no").val()&&(a.notes=$("#tc_ov_no").val());spModel.timeclock.update("timeclock",a,function(){sp.showSuccess(_s("Timeclock updated"))})};
ShiftPlanningTimeClock.prototype.saveClockTime=function(){var a={},b="get",c="timeclock.addclocktime",d=_s("Clock Time added");!0==$("#tc_act_tc_id").hasClass("editOn")?(b="update",c="timeclock.timeclock",a.id=$("#tc_act_tc_id").val(),d=_s("Clock time edited"),a.start_date=$("#tc_act_c_cl_dp_i").val()+" "+$("#tc_act_tclin").val(),a.start_time=$("#tc_act_c_cl_dp_i").val()+" "+$("#tc_act_tclin").val(),a.end_date=$("#tc_act_c_co_dp_i").val()+" "+$("#tc_act_tclou").val(),a.end_time=$("#tc_act_c_co_dp_i").val()+
" "+$("#tc_act_tclou").val()):(a.datein=$("#tc_act_c_cl_dp_i").val()+" "+$("#tc_act_tclin").val(),a.dateout=$("#tc_act_c_co_dp_i").val()+" "+$("#tc_act_tclou").val());a.schedule=$("#tc_act_sc").val();a.employee=$("#tc_act_em").val();$("#tc_act_onci").hasClass("check")&&(a.onlyin=1);a.notes=$("#tc_act_no").val();sp.api(c,b,a,function(){sp.showSuccess(d);setTimeout(function(){var a="displayTimeSheets";2>=sp.staff.admin.info.group&&(a="manageTimeSheets");$(".subNavigation div.timeClock ul.timeClock a[subpage="+
a+"]").trigger(clickEvent)},400)},function(a){sp.showError(a.error)})};ShiftPlanningTimeClock.prototype.loadPage=function(){};ShiftPlanningReports.prototype.initialize=function(){var a=this;this.reports=[];$(document).ready(function(){a.allReportsEvents();user.loggedIn&&a.allReportsSubEvents()})};
ShiftPlanningReports.prototype.allReportsEvents=function(){var a=this;$("#reports .advancedButton").bind(clickEvent,function(a){a.preventDefault();$(this).hasClass("advancedOpened")?($(this).removeClass("advancedOpened"),$(this).html("Advanced")):($(this).addClass("advancedOpened"),$(this).html("Simple"));$(this).parents(".main").find("li.advancedMenu").toggleClass("hidden")});$("#reports .timeSelector").bind("change",function(){var b=$(this).val();if("-1"!=b&&"99"!=b){var c=spRanges.getRange("times",
b),b=new Date(c.start_time),c=new Date(c.end_time);$("#reports ."+a.page+" .timeFromSelector").val(b.toString(cal.dformat));$("#reports ."+a.page+" .timeToSelector").val(c.toString(cal.dformat));a.displayReports()}});$("#reports .checkbox").bind(clickEvent,function(){$(this).toggleClass("check");a.displayReports()});$("#reports .employeeSelector, #reports .advancedMenu select").bind("change",function(){a.displayReports()});$("#reports .listReports").delegate("a.fr",clickEvent,function(b){b.preventDefault();
a.cId=$(this).attr("rel");sp.loadSubPage("","reports","singleViewDisplay")});$("#re_si_inf").bind(clickEvent,function(a){a.preventDefault();$("#wrapper > .subNavigation").show();$("#wrapper > .subNavigation .reports li.active a").trigger(clickEvent)})};
ShiftPlanningReports.prototype.allReportsSubEvents=function(){var a=this;spView.fixCurrency(sp.staff.admin.settings.currency);$("#reports .timeSelector").html(spView.timeRanges());$("#reports .timeSelector").val(3);$("#reports .employeeSelector").html(spView.staffFilter());$("#reports .positionsSelector").html(spView.scheduleFilter());$("#reports .skillsSelector").html(spView.skillsFilter());var b=spRanges.getRange("times",$("#reports .timeSelector").first().val()),c=new Date(b.start_time),b=new Date(b.end_time);
$("#reports .timeFromSelector").scroller("destroy");$("#reports .timeFromSelector").val(c.toString(cal.dformat));$("#reports .timeFromSelector").scroller({preset:"date",dateFormat:"mmM d, yy"==sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat)?sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).substr(2,sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).length):sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat),dateOrder:sp.strReplace(["MM","yyyy"," ","-","/"],["mm","yy","","",""],cal.dformat),
onSelect:function(){$("#reports ."+a.page+" .timeSelector").val(-1);a.displayReports()}});$("#reports .timeToSelector").scroller("destroy");$("#reports .timeToSelector").val(b.toString(cal.dformat));$("#reports .timeToSelector").scroller({preset:"date",dateFormat:"mmM d, yy"==sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat)?sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).substr(2,sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).length):sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat),
dateOrder:sp.strReplace(["MM","yyyy"," ","-","/"],["mm","yy","","",""],cal.dformat),onSelect:function(){$("#reports ."+a.page+" .timeSelector").val(-1);a.displayReports()}})};
ShiftPlanningReports.prototype.displayReports=function(){if("singleViewDisplay"==this.page)return!1;sp.globalLoader();var a=this,b=this.page,c=this.page;$("#reports ."+c+" .totals").hide();$("#reports ."+c+" .noResults").hide();$("#reports ."+c+" .notif").hide();$("#reports ."+c+" .listReports").html(spView.ulLoader());var d={type:b.toLowerCase()};"confirmedTimeSheets"==b&&(d.type="timesheets");d.start_date=$("#reports ."+c+" .timeFromSelector").val();d.end_date=$("#reports ."+c+" .timeToSelector").val();
$("#reports ."+c+" time.from").html($("#reports ."+c+" .timeFromSelector").val());$("#reports ."+c+" time.to").html($("#reports ."+c+" .timeToSelector").val());d.schedule=$("#reports ."+c+" .positionsSelector").val();d.employee=$("#reports ."+c+" .employeeSelector").val();d.skill=$("#reports ."+c+" .skillsSelector").val();d.deduct_breaks=$("#reports ."+c+" .re_deductBreaks").hasClass("check")?1:0;d.group_results=$("#reports ."+c+" .re_groupResults").hasClass("check")?1:0;d.show_empty=$("#reports ."+
c+" .re_showEmpty").hasClass("check")?1:0;spModel.payroll.get("report",d,function(b){0==b.data.length?($("#reports ."+c+" .totals").hide(),$("#reports ."+c+" .notif").show()):$("#reports ."+c+" .totals").show();var d=0,i=0,h=0,k=0,m=0,n=[];$.each(b.data,function(a,b){d+=Number(b.hours.regular);i+=Number(b.hours.special);h+=Number(b.hours.overtime);k+=Number(b.hours.total);m+=Number(b.hours.cost);n[a]=b;n[a].avatar="undefined"!=typeof sp.staff.data.employees[b.userid]&&"undefined"!=typeof sp.staff.data.employees[b.userid].avatar&&
""!=sp.staff.data.employees[b.userid].avatar&&"undefined"!=typeof sp.staff.data.employees[b.userid].avatar.small?sp.staff.data.employees[b.userid].avatar.small:"images/no-avatar.png";n[a].rId=a});a.reports=n;$("#reports ."+c+" .listReports").html($.tmpl($("#te_re_info"),n));$("#reports ."+c+" .TSregular > span > span").html(d.toFixed(2));$("#reports ."+c+" .TSspecial > span > span").html(i.toFixed(2));$("#reports ."+c+" .TSovertime > span > span").html(h.toFixed(2));$("#reports ."+c+" .TStotal > span > span").html(k.toFixed(2)+
" Hours");$("#reports ."+c+" .TScost > span > span:not(.currency)").html(m.toFixed(2))})};ShiftPlanningReports.prototype.singleViewDisplay=function(a){$("#wrapper > .subNavigation").hide();try{var b=this.reports[a];$("#re_di_item").html($.tmpl($("#te_re_"+this.page+"_"+($("#reports ."+this.page+" .re_groupResults").hasClass("check")?"1":"0")),b));spView.fixCurrency(sp.staff.admin.settings.currency)}catch(c){console.log("Greska"),console.log(c)}};
ShiftPlanningReports.prototype.loadSubPageEvents=function(a){if("singleViewDisplay"==a)this.singleViewDisplay(this.cId);else{this.allReportsSubEvents();var b=this,a=this.page=a;$("#reports ."+a+" .totals").hide();$("#reports ."+a+" .noResults").hide();$("#reports ."+a+" .notif").hide();$("#reports ."+a+" .listReports").html(spView.ulLoader());setTimeout(function(){b.displayReports()},100)}};ShiftPlanningReports.prototype.loadPage=function(){};
ShiftPlanningRequests.prototype.initialize=function(){var a=this;$(document).ready(function(){a.overviewEvents();a.vacationEvents();a.availableEvents();a.openShiftsEvents();a.shiftTradesEvents();a.shiftApprovalsEvents()})};
ShiftPlanningRequests.prototype.loadSubPageEvents=function(a){$(".subNavigation").show();switch(a){case "overview":this.overviewSubEvents();break;case "vacation":this.vacationSubEvents();break;case "available":this.availableSubEvents();break;case "shiftTrades":this.shiftTradesSubEvents();break;case "shiftApprovals":this.shiftApprovalsSubEvents();break;case "openShifts":this.openShiftsSubEvents();break;case "vacationRequestManage":$(".subNavigation").hide();this.displayVacationRequest();break;case "shiftTradeManager":$(".subNavigation").hide();
this.displayShiftTradeManager();break;case "shiftTradeManagerAP":$(".subNavigation").hide();this.displayShiftTradeManagerAP();break;case "shiftSwapRequest":$(".subNavigation").hide();this.shiftSwapRequestSubEvents();break;case "shiftTradeManagerIM":$(".subNavigation").hide();this.displayShiftTradeManagerIM();break;case "openShiftsOpen":$(".subNavigation").hide();this.displayOpenShifts();break;case "openShiftsRequest":$(".subNavigation").hide();this.displayOpenRequests();break;case "shiftApprovalsSingle":$(".subNavigation").hide(),
this.shiftApprovalsSingle()}};ShiftPlanningRequests.prototype.overviewEvents=function(){$("#requests #rq_ov a").bind(clickEvent,function(a){a.preventDefault();$(".subNavigation .requests li a[subpage="+$(this).attr("subpage")+"]").trigger(clickEvent)});$("#requests .backMenu").bind(clickEvent,function(a){a.preventDefault();$(".subNavigation .requests li a[subpage="+$(this).attr("subpage")+"]").trigger(clickEvent)})};
ShiftPlanningRequests.prototype.vacationEvents=function(){var a=this;$("#requests #rq_va");$("#rq_va table");$("#rq_va_sr").bind(clickEvent,function(b){b.preventDefault();$(this).addClass("loading");a.addVacationRequest($(this))});$("#rq_va_fr").scroller();$("#rq_va_to").scroller();$("#rq_va_rq").delegate("a",clickEvent,function(b){b.preventDefault();a.current=a.vacations[$(this).attr("rel")];sp.loadSubPage("","requests","vacationRequestManage")});$("#rq_va_ma_acp").bind(clickEvent,function(b){b.preventDefault();
$(this).addClass("loading");a.approveVacationRequest($(this))});$("#rq_va_ma_dec").bind(clickEvent,function(b){b.preventDefault();$(this).addClass("loading");a.declineVacationRequest($(this))});$("#rq_va_spd").bind(clickEvent,function(a){a.preventDefault();$("#rq_va_up .pastDate").toggleClass("hidden");"Show past dates"==$("#rq_va_spd").html()?$("#rq_va_spd").html("Hide past dates"):"Hide past dates"==$("#rq_va_spd").html()&&$("#rq_va_spd").html("Show past dates")});$("#rq_va").delegate("a.deleteVacation",
clickEvent,function(b){b.preventDefault();a.cancelVacationRequest($(this).attr("rel"))})};
ShiftPlanningRequests.prototype.availableEvents=function(){var a=this;$("#rq_av_pu").bind(clickEvent,function(a){a.preventDefault();sp.loadSubPage("","requests","openShifts")});$("#rq_av_sw, #rq_av_tr").bind(clickEvent,function(a){a.preventDefault();sp.loadSubPage("","requests","shiftTrades")});$("#rq_av_pu_li").delegate("a",clickEvent,function(b){b.preventDefault();a.current=a.available.pickup[$(this).attr("rel")];sp.loadSubPage("","requests","openShiftsOpen")});$("#rq_av_sw_li").delegate("a",clickEvent,
function(b){b.preventDefault();a.current=a.available.swap[$(this).attr("rel")];sp.loadSubPage("","requests","shiftSwapRequest")});$("#rq_av_tr_li").delegate("a",clickEvent,function(b){b.preventDefault();a.current=a.available.trade[$(this).attr("rel")];sp.loadSubPage("","requests","shiftTradeManagerAP")})};
ShiftPlanningRequests.prototype.openShiftsEvents=function(){var a=this;$("#rq_os_os").delegate("a",clickEvent,function(b){b.preventDefault();a.current=a.shifts[$(this).attr("rel")];sp.loadSubPage("","requests","openShiftsOpen")});$("#rq_os_spr").delegate("a",clickEvent,function(b){b.preventDefault();a.current=a.shiftsR[$(this).attr("rel")];sp.loadSubPage("","requests","openShiftsRequest")});$("#rq_os_os_s").delegate("#rq_os_rtw.green",clickEvent,function(a){a.preventDefault();var c=$(this);c.addClass("loading");
spModel.schedule.create("shiftrequests",{shift:$(this).attr("rel")},function(){c.removeClass("loading").removeClass("green").addClass("grey").html(_s("<span>Cancel pending request</span>"))})});$("#rq_os_os_s").delegate("#rq_os_rtw.grey",clickEvent,function(a){a.preventDefault();var c=$(this);c.addClass("loading");spModel.schedule.update("shift",{id:$(this).attr("rel"),remove:sp.staff.admin.info.id},function(){c.removeClass("loading").removeClass("grey").removeClass("green").html(_s("Request Removed"))})});
$("#rq_os_spr_s").delegate(".step a",clickEvent,function(a){a.preventDefault();var c=$(this);c.addClass("loading");a={id:$(this).attr("rel"),type:"openshifts"};a.mode=$(this).hasClass("accept")?"approve":"reject";spModel.schedule.update("requests",a,function(){c.removeClass("loading");$(".subNavigation .requests li a[subpage=openShifts]").trigger(clickEvent)},function(){c.removeClass("loading")})})};
ShiftPlanningRequests.prototype.shiftTradesEvents=function(){var a=this;$("#rq_st_mst").delegate("a",clickEvent,function(b){b.preventDefault();a.current=a.trades.manage[$(this).attr("rel")];sp.loadSubPage("","requests","shiftTradeManager")});$("#rq_st_ap").delegate("a",clickEvent,function(b){b.preventDefault();a.current=a.trades.avaiting[$(this).attr("rel")];sp.loadSubPage("","requests","shiftTradeManagerAP")});$("#rq_st_im").delegate("a",clickEvent,function(b){b.preventDefault();a.current=a.trades.requested[$(this).attr("rel")];
sp.loadSubPage("","requests","shiftTradeManagerIM")});$("#rq_st_swap").delegate("a",clickEvent,function(b){b.preventDefault();a.current=a.swaps[$(this).attr("rel")];sp.loadSubPage("","requests","shiftSwapRequest")});$("#rq_st_sh_swap").delegate(".traders a",clickEvent,function(){var a=$(this).attr("swapId"),c=$(this).attr("shiftId"),d=$(this).attr("class"),e=$(this);e.addClass("loading");var g="accept"==d?"You have accepted this shift trade.":"You have rejected this shift trade.";spModel.schedule.update("tradeswap",
{shift_for_swap:c,trade:a,action:d},function(){e.removeClass("loading");sp.showSuccess(g);$(".subNavigation .requests li a[subpage=shiftTrades]").trigger(clickEvent)})});$("#rq_st_mst_s").delegate(".traders a",clickEvent,function(a){var c=$(this);c.addClass("loading");a.preventDefault();var a=$(this).attr("tradeId"),d=$(this).attr("userId"),a={trade:a,user:d};a.action=$(this).hasClass("accept")?"accept":"reject";spModel.schedule.update("trade",a,function(){c.removeClass("loading");$(".subNavigation .requests li a[subpage=shiftTrades]").trigger(clickEvent)},
function(a){sp.showError(a.error)})});$("#rq_st_mts_sub ul a").bind(clickEvent,function(a){a.preventDefault();var c=$(this),d={trade:$(this).attr("rel")};$(this).hasClass("activate")&&(d.action="activate");if($(this).hasClass("cancel")&&(d.action="cancel",!confirm(_s("Are you sure you want to cancel this request?"))))return c.removeClass("loading"),!1;$(this).hasClass("deactivate")&&(d.action="deactivate");c.addClass("loading");spModel.schedule.update("trade",d,function(){c.removeClass("loading");
"activate"==d.action?sp.showSuccess(_s("Shift trade accepted, waiting for potentional acceptors to accept.")):"deactivate"==d.action?sp.showSuccess(_s("Shift trade rejected.")):sp.showSuccess(_s("Shift trade canceled."));$(".subNavigation .requests li a[subpage=shiftTrades]").trigger(clickEvent)},function(a){sp.showError(a.error)})});$("#rq_st_ap_sub ul a").bind(clickEvent,function(a){var c=$(this);c.addClass("loading");a.preventDefault();var d={trade:$(this).attr("rel")};d.action=$(this).hasClass("accept")?
"accept":"reject";spModel.schedule.update("trade",d,function(){c.removeClass("loading");sp.showSuccess(i18n.format(_s("Shift trade pick up {action}"),{action:d.action}));$(".subNavigation .requests li a[subpage=shiftTrades]").trigger(clickEvent)},function(a){sp.showError(a.error)})});$("#rq_st_im_sm a").bind(clickEvent,function(a){a.preventDefault();var c=$(this);c.addClass("loading");a={trade:$(this).attr("rel")};if($(this).hasClass("cancel")){if(!confirm(_s("Are you sure you want to cancel this request?")))return c.removeClass("loading"),
!1;a.action="cancel"}spModel.schedule.update("trade",a,function(){c.removeClass("loading");$(".subNavigation .requests li a[subpage=shiftTrades]").trigger(clickEvent)})})};
ShiftPlanningRequests.prototype.shiftApprovalsEvents=function(){var a=this;$("#rq_sa select").bind("change",function(){a.shiftApproveList()});$("#rq_sa_ho").delegate(".checkbox",clickEvent,function(){var b=$(this);if(!b.hasClass("check")){var c=b.attr("shiftId");spModel.schedule.update("shiftapprove",{id:c},function(d){b.addClass("check");a.addShift(c,d.data)},function(a){sp.showError(a.error)})}});$("#rq_sa_ho").delegate("span.names, span.time",clickEvent,function(){var b=$(this).parent();b.addClass("loading");
var c=b.find(".checkbox").attr("shiftId");b.find(".checkbox").hasClass("check")?spModel.schedule.get("shiftapprove",{id:c},function(b){var e=a.getShift(c);null!=e.employees&&$.each(b.data,function(a,b){$.each(e.employees,function(a,c){c.id==b.employee&&(e.employees[a].shift=b)})});a.current=a.fixShiftsApproval(e);sp.loadSubPage("","requests","shiftApprovalsSingle")},function(a){b.removeClass("loading");sp.showError(a.data)}):spModel.schedule.update("shiftapprove",{id:c},function(d){b.find(".checkbox").addClass("check");
a.addShift(c,d.data);a.current=a.fixShiftsApproval(d.data);sp.loadSubPage("","requests","shiftApprovalsSingle")},function(a){b.removeClass("loading");sp.showError(a.data)})});$("#rq_sa_s").delegate(".checkbox",clickEvent,function(){$(this).toggleClass("check")});$("#rq_sa_sub .approve").bind(clickEvent,function(b){b.preventDefault();a.saveShiftApprove()})};
ShiftPlanningRequests.prototype.overviewSubEvents=function(){$("#rq_ov_loader").show();$("#rq_ov_widgets").hide();$("#rq_ov_hd").hide();$("#rq_ov_loader").html(spView.ulLoader());spModel.admin.get("nrequests",{},function(a){"undefined"==typeof a.data.vacation&&(a.data.vacation=0);"undefined"==typeof a.data.shift_approval&&(a.data.shift_approval=0);"undefined"==typeof a.data.shift_request_waiting&&(a.data.shift_request_waiting=0);"undefined"==typeof a.data.trade_approval&&(a.data.trade_approval=0);
"undefined"==typeof a.data.trade_approval&&(a.data.trade_approval=0);"undefined"==typeof a.data.shift_available&&(a.data.shift_available=0);0==a.data.vacation?$("#rq_rl_va").hide():$("#rq_rl_va").show();0==a.data.shift_approval?$("#rq_rl_sp").hide():$("#rq_rl_sp").show();0==a.data.shift_request_waiting?$("#rq_rl_sr").hide():$("#rq_rl_sr").show();0==a.data.trade_approval?$("#rq_rl_ast").hide():$("#rq_rl_ast").show();0==a.data.shift_available?$("#rq_rl_sv").hide():$("#rq_rl_sv").show();$("#rq_rl_va .icon b").html(a.data.vacation);
$("#rq_rl_sp .icon b").html(a.data.shift_approval);$("#rq_rl_sr .icon b").html(a.data.shift_request_waiting);$("#rq_rl_ast .icon b").html(a.data.trade_approval);$("#rq_rl_sv .icon b").html(a.data.shift_available);$("#rq_ov_widgets").show();$("#rq_ov .widgets li:visible").attr("style","");$("#rq_ov .widgets li:visible:first").css("border-top","none");0==$("#rq_ov .widgets li:visible").length?($("#rq_ov_hd").show(),$("#rq_ov_widgets").hide()):$("#rq_ov_hd").hide();$("#rq_ov_loader").hide()},function(a){sp.showError(a.error)})};
ShiftPlanningRequests.prototype.vacationSubEvents=function(){var a=this;$("#rq_va_wc").val("");$("#rq_va_fr").val("");$("#rq_va_to").val("");1==sp.staff.admin.settings.book_days_off?($("#rq_va .newMsg").show(),$("#rq_va .newMsg").next().show()):($("#rq_va .newMsg").hide(),$("#rq_va .newMsg").next().hide());$("#rq_va_en").html(spView.staffOption(4>=sp.staff.admin.info.group?!1:!0));$("#rq_va_spd").hide();$("#rq_va_rq").html(spView.ulLoader());$("#rq_va_aa").html(spView.ulLoader());$("#rq_va_up").html(spView.ulLoader());
$("#rq_va_rq").show();$("#rq_va_aa").show();$("#rq_va_up").show();$("#rq_va_rq").next().hide();$("#rq_va_aa").next().hide();$("#rq_va_up").next().hide();$("#rq_va_ma_acp, #rq_va_ma_dec").removeClass("loading");4>=sp.staff.admin.info.group?spModel.schedule.get("vacations",{mode:"manage"},function(b){if(0==b.data.length)$("#rq_va_rq").hide(),$("#rq_va_rq").next().show();else{$("#rq_va_rq").show();$("#rq_va_rq").next().hide();var c=[];$.each(b.data,function(a,b){c[a]=b;c[a].avatar="undefined"!=typeof sp.staff.data.employees[b.userid]&&
"undefined"!=typeof sp.staff.data.employees[b.userid].avatar&&""!=sp.staff.data.employees[b.userid].avatar&&"undefined"!=typeof sp.staff.data.employees[b.userid].avatar.small?sp.staff.data.employees[b.userid].avatar.small:"images/no-avatar.png";c[a].rId=a});a.vacations=c;$("#rq_va_rq").html($.tmpl($("#te_rq_va_ma"),c))}}):($("#rq_va_rq").hide(),$("#rq_va_rq").next().show());spModel.schedule.get("vacations",{mode:"requested"},function(a){0==a.data.length?($("#rq_va_aa").hide(),$("#rq_va_aa").next().show()):
($("#rq_va_aa").show(),$("#rq_va_aa").next().hide(),$("#rq_va_aa").html($.tmpl($("#te_rq_va_aa"),a.data)))},function(a){sp.showError(a.error)});spModel.schedule.get("vacations",{start_date:"last year",end_date:"next year"},function(b){b.data=a.clearVacations(b.data);0==b.data.length?($("#rq_va_up").hide(),$("#rq_va_up").next().show()):($("#rq_va_up").show(),$("#rq_va_up").next().hide(),$("#rq_va_up").html($.tmpl($("#te_rq_va_up"),b.data)),0<$("#rq_va_up .pastDate").length?$("#rq_va_spd").show():$("#rq_va_spd").hide())},
function(a){sp.showError(a.error)})};
ShiftPlanningRequests.prototype.availableSubEvents=function(){$("#rq_av_pu .icon b").html("");$("#rq_av_sw .icon b").html("");$("#rq_av_tr .icon b").html("");$("#rq_av_pu_li").html(spView.ulLoader());$("#rq_av_sw_li").html(spView.ulLoader());$("#rq_av_tr_li").html(spView.ulLoader());var a=this;sp.multiApi([["schedule.shifts","GET",{mode:"open"}],["schedule.trades","GET",{}],["schedule.trades","get",{mode:"swap"}]],function(b){a.available.pickup=sp.map(b[0].data);a.available.swap=sp.map(b[2].data);
a.available.trade=sp.map(b[1].data);$("#rq_av_pu .icon b").html(sp.countResponse(b[0].data));$("#rq_av_pu_li").html($.tmpl($("#te_da_all_shiftV2"),sp.objToArray(b[0].data)));0<sp.countResponse(b[0].data)?$("#rq_av_pu_li").show():$("#rq_av_pu_li").hide();$("#rq_av_sw .icon b").html(sp.countResponse(b[2].data));var c=[];$.each(b[2].data,function(a,b){b.avatar=sp.getAvatar(b.user);c.push(b)});0<sp.countResponse(b[2].data)?$("#rq_av_sw_li").show():$("#rq_av_sw_li").hide();$("#rq_av_sw_li").html($.tmpl($("#te_da_all_shiftV2"),
c));$("#rq_av_tr .icon b").html(sp.countResponse(b[1].data));0<sp.countResponse(b[1].data)?$("#rq_av_tr_li").show():$("#rq_av_tr_li").hide();$("#rq_av_tr_li").html($.tmpl($("#te_da_all_shiftV2"),sp.objToArray(b[1].data)))})};
ShiftPlanningRequests.prototype.openShiftsSubEvents=function(){var a=this;$("#rq_os_os").html(spView.ulLoader());$("#rq_os_os").next().hide();$("#rq_os_spr").prev().show();$("#rq_os_spr").html(spView.ulLoader());$("#rq_os_spr").next().hide();spModel.schedule.get("shifts",{mode:"open",detailed:1},function(b){if(0==b.data.length)$("#rq_os_os").hide(),$("#rq_os_os").next().show();else{$("#rq_os_os").show();$("#rq_os_os").next().hide();var c=[];$.each(b.data,function(a,b){c[a]=b;c[a].rId=a});a.shifts=
c;$("#rq_os_os").html($.tmpl($("#te_da_all_shift"),b.data))}},function(a){sp.showError(a.error)});4>sp.staff.admin.info.group?spModel.schedule.get("shifts",{mode:"openapproval"},function(b){if(0==b.data.length)$("#rq_os_spr").hide(),$("#rq_os_spr").next().show();else{$("#rq_os_spr").show();$("#rq_os_spr").next().hide();b.data=a.prepareOpenShiftsNA(b.data);var c=[];$.each(b.data,function(a,b){c[a]=b;c[a].avatar="undefined"!=typeof sp.staff.data.employees[b.userid]&&"undefined"!=typeof sp.staff.data.employees[b.userid].avatar&&
""!=sp.staff.data.employees[b.userid].avatar&&"undefined"!=typeof sp.staff.data.employees[b.userid].avatar.small?sp.staff.data.employees[b.userid].avatar.small:"images/no-avatar.png";c[a].rId=a});a.shiftsR=c;$("#rq_os_spr").html($.tmpl($("#te_da_all_shift"),b.data))}},function(a){sp.showError(a.error)}):($("#rq_os_spr").prev().hide(),$("#rq_os_spr").hide(),$("#rq_os_spr").next().hide())};
ShiftPlanningRequests.prototype.shiftTradesSubEvents=function(){var a=this;$("#rq_st_mst").html(spView.ulLoader());$("#rq_st_ap").html(spView.ulLoader());$("#rq_st_swap").html(spView.ulLoader());$("#rq_st_im").html(spView.ulLoader());$("#rq_st_mst").show();$("#rq_st_ap").show();$("#rq_st_im").show();$("#rq_st_mst").next().hide();$("#rq_st_ap").next().hide();$("#rq_st_im").next().hide();$("#rq_st_swap").next().hide();4>=sp.staff.admin.info.group?spModel.schedule.get("trades",{mode:"manage"},function(b){if(0==
b.data.length)$("#rq_st_mst").hide(),$("#rq_st_mst").next().show();else{$("#rq_st_mst").show();$("#rq_st_mst").next().hide();var c=[];$.each(b.data,function(a,b){c[a]=b;c[a].avatar="undefined"!=typeof sp.staff.data.employees[b.userid]&&"undefined"!=typeof sp.staff.data.employees[b.userid].avatar&&""!=sp.staff.data.employees[b.userid].avatar&&"undefined"!=typeof sp.staff.data.employees[b.userid].avatar.small?sp.staff.data.employees[b.userid].avatar.small:"images/no-avatar.png";c[a].rId=a});a.trades.manage=
c;$("#rq_st_mst").html($.tmpl($("#te_rq_st_mst"),c))}},function(a){sp.showError(a.error)}):($("#rq_st_mst").hide(),$("#rq_st_mst").next().show());spModel.schedule.get("trades",{},function(b){if(0==b.data.length)$("#rq_st_ap").hide(),$("#rq_st_ap").next().show();else{$("#rq_st_ap").show();$("#rq_st_ap").next().hide();var c=[];$.each(b.data,function(a,b){c[a]=b;c[a].avatar="undefined"!=typeof sp.staff.data.employees[b.userid]&&"undefined"!=typeof sp.staff.data.employees[b.userid].avatar&&""!=sp.staff.data.employees[b.userid].avatar&&
"undefined"!=typeof sp.staff.data.employees[b.userid].avatar.small?sp.staff.data.employees[b.userid].avatar.small:"images/no-avatar.png";c[a].rId=a});a.trades.avaiting=c;$("#rq_st_ap").html($.tmpl($("#te_rq_st_ap"),c))}},function(a){sp.showError(a.error)});spModel.schedule.get("trades",{mode:"requested"},function(b){if(0==b.data.length)$("#rq_st_im").hide(),$("#rq_st_im").next().show();else{$("#rq_st_im").show();$("#rq_st_im").next().hide();var c=[];$.each(b.data,function(a,b){c[a]=b;c[a].avatar=
"undefined"!=typeof sp.staff.data.employees[b.userid]&&"undefined"!=typeof sp.staff.data.employees[b.userid].avatar&&""!=sp.staff.data.employees[b.userid].avatar&&"undefined"!=typeof sp.staff.data.employees[b.userid].avatar.small?sp.staff.data.employees[b.userid].avatar.small:"images/no-avatar.png";c[a].rId=a});a.trades.requested=c;$("#rq_st_im").html($.tmpl($("#te_rq_st_ap"),c))}},function(a){sp.showError(a.error)});spModel.schedule.get("trades",{mode:"swap"},function(b){if(""!=b.data){a.swaps=b.data;
var c=[];$("#rq_st_swap").show();$.each(b.data,function(a,b){b.avatar=sp.getAvatar(b.user);c.push(b)});$("#rq_st_swap").html($.tmpl($("#te_rq_swap_single"),c))}else $("#rq_st_swap").hide(),$("#rq_st_swap_empty").show()})};ShiftPlanningRequests.prototype.clearVacations=function(a){var b=[];if(0==a.length)return b;$.each(a,function(a,d){d.employee==sp.staff.admin.info.id&&b.push(d)});return b};
ShiftPlanningRequests.prototype.shiftApprovalsSubEvents=function(){$("#rq_sa_po").html(spView.scheduleFilter());$("#rq_sa_em").html(spView.staffFilter());$("#rq_sa_ho").html(spView.divLoader());this.shiftApproveList()};
ShiftPlanningRequests.prototype.shiftApproveList=function(){this.shifts=[];$("#rq_sa_ho").html(spView.divLoader());var a=this,b={mode:"confirm"};0!=$("#rq_sa_po").val()&&(b.schedule=$("#rq_sa_po").val());0!=$("#rq_sa_em").val()&&(b.employees=$("#rq_sa_em").val());spModel.schedule.get("shifts",b,function(b){0<b.data.length?$("#rq_sa_ho").html($.tmpl($("#te_rq_sa"),a.prepareShiftApprovals(b.data))):$("#rq_sa_ho").html(spView.emptyResult())},function(a){sp.showError(a.error)})};
ShiftPlanningRequests.prototype.prepareShiftApprovals=function(a){var b={};$.each(a,function(a,c){var g=c.start_date.formatted+"";"undefined"==typeof b[g]?b[g]={shiftDate:c.start_date.formatted,shifts:[c]}:b[g].shifts.push(c)});var c=[];$.each(b,function(a,b){c.push(b)});return c};
ShiftPlanningRequests.prototype.addVacationRequest=function(a){var b=this;if(0==$.trim($("#rq_va_fr").val()).length)return sp.showError(_s("Please select FROM time")),a.removeClass("loading"),!1;if(0==$.trim($("#rq_va_to").val()).length)return sp.showError(_s("Please select TO time")),a.removeClass("loading"),!1;var c={start_date:$("#rq_va_fr").val(),end_date:$("#rq_va_to").val(),employee:$("#rq_va_en").val(),comments:$("#rq_va_wc").val()};spModel.schedule.create("vacation",c,function(){b.vacationSubEvents();
a.removeClass("loading");$("#rq_va_wc").val("");$("#rq_va_fr").val("");$("#rq_va_to").val("")})};ShiftPlanningRequests.prototype.displayVacationRequest=function(){$("#rq_va_ma_s").html($.tmpl($("#te_rq_va_ma_s"),this.current))};
ShiftPlanningRequests.prototype.displayShiftTradeManager=function(){$("#rq_st_mst_s").html($.tmpl($("#te_rq_st_mst_s"),this.prepareSingleViewTrade(this.current)));$("#rq_st_mts_sub ul a").attr("rel",this.current.id);0==parseInt(this.current.confirm_before)?($("#rq_st_mts_fm").show(),$("#rq_st_mts_sm").hide()):($("#rq_st_mts_sm").show(),$("#rq_st_mts_fm").hide())};
ShiftPlanningRequests.prototype.displayShiftTradeManagerIM=function(){$("#rq_st_im_s").html($.tmpl($("#te_rq_st_im_s"),this.current));$("#rq_st_im_sm a").attr("rel",this.current.id)};ShiftPlanningRequests.prototype.shiftSwapRequestSubEvents=function(){$("#rq_st_sh_swap").html($.tmpl($("#te_rq_st_swap_single"),this.current))};
ShiftPlanningRequests.prototype.displayShiftTradeManagerAP=function(){$("#rq_st_ap_s").html($.tmpl($("#te_rq_st_ap_s"),this.current));$("#rq_st_ap_sub ul a").attr("rel",this.current.trade_id);1==parseInt(this.current.confirmed)?$("#rq_st_ap_sub ul").hide():$("#rq_st_ap_sub ul").show()};
ShiftPlanningRequests.prototype.displayOpenShifts=function(){$("#rq_os_os_s").html($.tmpl($("#te_rq_os_os_s"),this.current));var a="",b="<p>"+_s("You are un-available")+"</p>",c=this.current.status;"undefined"==typeof sp.staff.admin.settings.open_overtime&&(sp.staff.admin.settings.open_overtime=!1);switch(c){case 0:a='<a class="grey" href="#" id="rq_os_rtw" rel="'+this.current.id+_s('"><span>Cancel pending request</span>');this.current.available||(a+=b);break;case 1:a="<p>"+_s("Management rejected your request for this shift")+
"</p>";break;case 2:a="<p>"+_s("Already on this shift")+"</p>";break;case 3:a="<p>"+_s("Booked Off")+"</p>";break;case 5:case 6:a=sp.staff.admin.settings.open_overtime?'<a class="green" href="#" id="rq_os_rtw" rel="'+this.current.id+_s('"><span>Request to work</span>')+"</a>":5==c?"<p>"+_s("Will put you into weekly overtime")+"</p>":"<p>"+_s("Will put you into daily overtime")+"</p>";break;case 7:a="<p>"+_s("Max Days in a Row Breached")+"</p>";break;case 8:a="<p>"+_s("Scheduled during this time")+
"</p>";break;case 9:a="<p>"+_s("Invalid time between shifts")+"</p>";break;case 10:a='<a class="green" href="#" id="rq_os_rtw" rel="'+this.current.id+_s('"><span>Request to work</span>')+"</a>",this.current.available||(a+=b)}$("#rq_os_pickup_req_button").html(a)};ShiftPlanningRequests.prototype.displayOpenRequests=function(){"undefined"==typeof this.current.full&&(this.current.full=this.current);$("#rq_os_spr_s").html($.tmpl($("#te_rq_os_spr_s"),this.current));$("#rq_os_spr_sub a").attr("rel",this.current.full.request_id)};
ShiftPlanningRequests.prototype.shiftApprovalsSingle=function(){$("#rq_sa_s").html($.tmpl($("#te_rq_sa_s"),this.current));$("#rq_sa_s .shiftStartInput").scroller("destroy");$("#rq_sa_s .shiftEndInput").scroller("destroy");$("#rq_sa_s .shiftStartInput").scroller({preset:"time",ampm:24==cal.tmode?!1:!0,stepMinute:15,timeFormat:sp.strReplace(["tt","mm"],["A","ii"],cal.tstring)});$("#rq_sa_s .shiftEndInput").scroller({preset:"time",ampm:24==cal.tmode?!1:!0,stepMinute:15,timeFormat:sp.strReplace(["tt",
"mm"],["A","ii"],cal.tstring)})};ShiftPlanningRequests.prototype.approveVacationRequest=function(){spModel.schedule.update("vacation",{id:this.current.id,status:1},function(){$(".subNavigation .requests li a[subpage=vacation]").trigger(clickEvent)})};ShiftPlanningRequests.prototype.declineVacationRequest=function(){spModel.schedule.update("vacation",{id:this.current.id,status:-1},function(){$(".subNavigation .requests li a[subpage=vacation]").trigger(clickEvent)})};
ShiftPlanningRequests.prototype.cancelVacationRequest=function(a){spModel.schedule.update("vacation",{id:a,status:-2},function(){$(".subNavigation .requests li a[subpage=vacation]").trigger(clickEvent)})};
ShiftPlanningRequests.prototype.prepareSingleViewTrade=function(a){0==a.traders.count&&(a.traders.data=[]);var b=[];$.each(a.traders.data,function(a,d){d.avatar="undefined"!=typeof sp.staff.data.employees[d.user]&&"undefined"!=typeof sp.staff.data.employees[d.user].avatar&&""!=sp.staff.data.employees[d.user].avatar&&"undefined"!=typeof sp.staff.data.employees[d.user].avatar.small?sp.staff.data.employees[d.user].avatar.small:"images/no-avatar.png";b.push(d)});a.traders.data=b;return a};
ShiftPlanningRequests.prototype.prepareSingleViewSwap=function(){};
ShiftPlanningRequests.prototype.prepareOpenShiftsNA=function(a){var b={};$.each(a,function(a,c){$.each(c.requests,function(a,d){c.user_name=d.name;c.user_id=d.id;c.avatar=sp.getAvatar(d.id);b[c.user_id+c.start_date.formatted+c.start_time.time+c.end_time.time+c.schedule_name]={user_name:d.name,user_id:d.id,start_date:{formatted:c.start_date.formatted},start_time:{time:c.start_time.time},end_time:{time:c.end_time.time},schedule_name:c.schedule_name,notes:c.notes,id:c.id,rId:c.request_id,full:c}})});
var c=[];$.each(b,function(a,b){c.push(b)});return c};ShiftPlanningRequests.prototype.saveShiftApprove=function(){var a=[];$.each($("#rq_sa_s .save"),function(){var b={employee:$(this).attr("userId"),id:$(this).attr("shiftId"),start_time:$(this).find(".shiftStartInput").val(),end_time:$(this).find(".shiftEndInput").val()};$(this).find(".checkbox").hasClass("check")||(b.absent=1);a.push(["schedule.shiftapprove","update",b])});sp.multiApi(a,function(){$(".subNavigation .requests li a[subpage=shiftApprovals]").trigger(clickEvent)})};
ShiftPlanningRequests.prototype.addShift=function(a,b,c){"undefined"!=typeof c?this.shifts[parseInt(a)+""][c]=b:this.shifts[parseInt(a)+""]=b};ShiftPlanningRequests.prototype.getShift=function(a){return this.shifts[a]};ShiftPlanningRequests.prototype.fixShiftsApproval=function(a){null!=a.employees&&$.each(a.employees,function(b){"undefined"==typeof a.employees[b].shift&&(a.employees[b].shift=a,a.employees[b].shift.absent=0)});return a};ShiftPlanningRequests.prototype.loadPage=function(){};
ShiftPlanningSchedule.prototype.initialize=function(){var a=this;$(document).ready(function(){a.allPageEvents()})};
ShiftPlanningSchedule.prototype.allPageEvents=function(){var a=this;$("#sc_fl").bind("change",function(){var b=$(this).val();parseInt(b)!=b?a.settings.mode=b:(a.settings.mode="schedule",a.settings.schedule=b);a.displayShifts()});$("#sc_prev_day").bind(clickEvent,function(b){b.preventDefault();$("#sc_to_sub").html(Date.parseExact($.trim($("#sc_to_sub").html()),cal.dformat).add(-1).day().toString(cal.dformat));a.nextPrevPrepare("prev")});$("#sc_next_day").bind(clickEvent,function(b){b.preventDefault();
$("#sc_to_sub").html(Date.parseExact($.trim($("#sc_to_sub").html()),cal.dformat).add(1).day().toString(cal.dformat));a.nextPrevPrepare("next")});$("#sc_prev_month").bind(clickEvent,function(b){b.preventDefault();$("#sc_mo_di").html(Date.parse($.trim($("#sc_mo_di").html())).addMonths(-1).toString("MMMM yyyy"));$("#sc_days_m").hide();a.displayShifts()});$("#sc_next_month").bind(clickEvent,function(b){b.preventDefault();$("#sc_mo_di").html(Date.parse($.trim($("#sc_mo_di").html())).addMonths(1).toString("MMMM yyyy"));
$("#sc_days_m").hide();a.displayShifts()});$("#sc_ca_bo").delegate("td:not(.notM)",clickEvent,function(){$("#sc_ca_bo td").removeClass("today");$(this).addClass("today");var b=$(this).attr("time");"undefined"!=typeof a.shifts[b]?($("#sc_td_list").show(),$("#sc_td .loading").hide(),$("#sc_td .additional").hide(),$("#sc_td_list").html('<ul class="shifts moved"></ul>'),$("#sc_td_list ul").html($.tmpl($("#te_sc_shifts_new"),a.shifts[b].shifts)),$("#sc_td_list .isShift > p").each(function(){$(this).html($(this).html().substring(0,
$(this).html().length-1))})):($("#sc_td_list").hide(),$("#sc_td .loading").hide(),$("#sc_td .additional").show());$("#sc_to_sub").html(Date.parse(b+" "+$.trim($("#sc_mo_di").html())).toString(cal.dformat));$("#sc_days_m").show()});$("#sc_td_list").delegate("a",clickEvent,function(b){b.preventDefault();if(!$(this).hasClass("isShift"))return!1;$(this).parent().addClass("loading");spModel.schedule.get("shift",{id:$(this).attr("rel"),detailed:1},function(b){a.shift=b.data;sp.loadSubPage("","schedule",
"shiftDisplay")})});$("#schedule .shiftDisplay .backMenu").bind(clickEvent,function(b){b.preventDefault();b.stopPropagation();a.fromUpcoming?(a.fromUpcoming=!1,$(".subNavigation").show(),a.fromStaff?(a.fromStaff=!1,$(".subNavigation .schedule").hide(),$(".staff .subWrapp ul li a[subpage=list]").trigger(clickEvent),sp.staff.displayEmployee($("#da_se_cur_us_id").val()),$("#settings .search.settings.mainSub li a[subpage=upcomingShifts]").trigger(clickEvent)):$(".subNavigation .settings li a[subpage=upcomingShifts]").trigger(clickEvent)):
a.fromRecent?(a.fromRecent=!1,$(".subNavigation").show(),a.fromStaff?(a.fromStaff=!1,$(".subNavigation .schedule").hide(),$(".staff .subWrapp ul li a[subpage=list]").trigger(clickEvent),sp.staff.displayEmployee($("#da_se_cur_us_id").val()),$("#settings .search.settings.mainSub li a[subpage=recentShifts]").trigger(clickEvent)):$(".subNavigation .settings li a[subpage=recentShifts]").trigger(clickEvent)):(a.fromDashboard&&(a.fromDashboard=!1,$(".subNavigation").show(),$(".subNavigation .dashboard li a[subpage=dashboard]").trigger(clickEvent)),
a.fromDashboardUpcoming?(a.fromDashboardUpcoming=!1,$(".subNavigation").show(),$(".subNavigation .dashboard li a[subpage=upcomingShifts]").trigger(clickEvent)):"false"==$("#sc_sub_shift_display ul a.publish").attr("first")?a.resetPublishFields(!0):$(".subNavigation .schedule .schedule li.active a").trigger(clickEvent))});$(".shiftDisplay ").delegate("#get_directions",clickEvent,function(b){var c=this,d=_s("There is no default address in your profile.Enter starting point address.");if(null==a.shift.user_location){var e=
!1,g=function(){e=!0;d=_s("Application didn't get GPS coordinates.Enter starting point address.");i()},i=function(){var e=prompt(d,"");a.shift.user_location=e;var g="http://"+googleIp+"/maps/?f=d&hl=en&geocode=&saddr="+e+"&daddr="+a.shift.location.address+"&ie=UTF8&z=7&output=embed";$(c).attr("href",g);null!=e?window.open(g,"_blank"):b.preventDefault()};"undefined"!=typeof navigator.geolocation?(b.preventDefault(),setTimeout(function(){e||g()},1E4),sp.showSuccess("Getting coordinates . . ."),navigator.geolocation.getCurrentPosition(function(b){"function"!=
typeof b&&(a.shift.user_location=""+b.coords.latitude+","+b.coords.longitude+"",b="http://"+googleIp+"/maps/?f=d&hl=en&geocode=&saddr="+a.shift.user_location+"&daddr="+a.shift.location.address+"&ie=UTF8&z=7&output=embed",$(c).attr("href",b),e=!0,window.open(b,"_blank"))},g)):i()}});$("#schedule .addShift .backMenu").bind(clickEvent,function(b){b.preventDefault();"edit"==$(this).attr("bck")?spModel.schedule.get("shift",{id:$("#sc_edit_id").val(),detailed:1},function(b){a.shift=b.data;sp.loadSubPage("",
"schedule","shiftDisplay")}):$(".subNavigation .schedule .schedule li.active a").trigger(clickEvent)});$("#sc_sub_shift_display ul a.edit").bind(clickEvent,function(b){b.preventDefault();var c=$(this);c.addClass("loading");spModel.schedule.get("shift",{id:$(this).attr("rel"),detailed:1},function(b){c.removeClass("loading");a.shift=b.data;a.edit=!0;sp.loadSubPage("","schedule","addShift")},function(){c.removeClass("loading")})});$("#sc_sub_shift_display ul a.delete").bind(clickEvent,function(b){b.preventDefault();
var c=$(this).attr("rel"),d=$(this);"true"==$(this).attr("first")?(spModel.schedule.del("shift",{id:c,rule:$("#te_sc_shift_display_delete .radio.check").attr("value")},function(a){sp.showSuccess(a.data);setTimeout(function(){$("#schedule .shiftDisplay .backMenu").trigger(clickEvent)},3E3)}),d.attr("first","false")):spModel.schedule.get("shift",{id:c,detailed:1},function(b){a.shift=b.data;"undefined"==typeof a.shift.repeats||0==a.shift.repeats?spModel.schedule.del("shift",{id:c},function(a){sp.showSuccess(a.data);
setTimeout(function(){$("#schedule .shiftDisplay .backMenu").trigger(clickEvent)},3E3)}):($("#te_sc_shift_display_info").hide(),$("#te_sc_shift_display_delete").show(),d.attr("first","true"))})});$("#sc_sub_trade a.backMenu").bind(clickEvent,function(b){b.preventDefault();sp.loadSubPage("","schedule","shiftDisplay");a.state=1});$("#cs_sh_trade").delegate(".chk",clickEvent,function(a){a.preventDefault();$(this).hasClass("all")?$(this).hasClass("check")?$("#empList0 .chk").removeClass("check"):$("#empList0 .chk").addClass("check"):
$(this).toggleClass("check")});$("#empList1").delegate(".checkbox",clickEvent,function(a){a.preventDefault();var c=this,a=$(this).attr("rel");$(this).parent().addClass("loading");!$(this).hasClass("check")&&!$(this).hasClass("disabled")?spModel.schedule.get("shift",{id:a,detailed:1},function(a){var b=!1;a.data.length&&0<a.data.staff.available.length&&$.each(a.data.staff.available,function(a,c){b=c[0]==sp.staff.admin.info.id?!0:b});"1"==sp.staff.admin.business.pref_same_day_trades&&(a.data.length&&
0<a.data.staff.sameday.length)&&$.each(a.data.staff.sameday,function(a,c){b=c[0]==sp.staff.admin.info.id?!0:b});b?($(c).addClass("check"),$(c).parent().removeClass("loading")):($(c).addClass("disabled"),$(c).parent().removeClass("loading"),sp.showError("You aren't available for this shift!"))}):($(this).removeClass("check"),$(this).parent().removeClass("loading"))});$("#sc_sub_shift_display ul a.trade").bind(clickEvent,function(a){a.preventDefault();sp.loadSubPage("","schedule","trade")});$("#schedule .trade").delegate(".tradepick a",
clickEvent,function(b){b.preventDefault();var c=$(this).attr("id"),d=this;$(this).addClass("loading");setTimeout(function(){$("#cs_sh_trade .steps").show();$("#schedule .trade>div").hide();$("#te_sc_shift_display_trade_"+c).show();$('#schedule .trade>div [step^="step"]').hide();$("#schedule .trade>div [step=step_"+a.state+"]").show();$("span[rel=self_state]").html(a.state);$(d).removeClass("loading")},400)});$("#te_sc_shift_display_trade_swap,#te_sc_shift_display_trade_release").delegate(".steps a",
clickEvent,function(b){b.preventDefault();var b=$(this).attr("id"),c=$(this).attr("swap"),d=this;$(this).addClass("loading");"_back"==b?a.state-=1:"_next"==b&&(a.state+=1);switch(a.state){case 0:case -1:setTimeout(function(){$("#schedule .trade>div").hide();$("#schedule .trade>div:first").show();a.state=1;$("span[rel=self_state]").html(a.state);$(d).removeClass("loading")},400);break;case 2:spModel.schedule.get("tradelist",{id:a.shift.id,swap:c},function(b){var e=[];$.each(b.data,function(a,b){var d=
{};d.id=a;d.avatar=sp.getAvatar(a);d.name=b.name;"undefined"!=typeof b.shifts?(d.shifts=[],$.each(b.shifts,function(a,b){var c={};c.id=a;c.user_shift_id=b.user_shift_id;c.start=b.start;d.shifts.push(c)}),e.push(d)):0==c&&e.push(d)});$("#empList"+c).html("");0==c&&0<e.length&&$("#empList"+c).append('<li><span class="chk all"></span> <span class="name">'+_s("Select All")+"</span></li>");1==c&&0==e.length&&$("#empList"+c).append("<li>"+_s("There are no available shifts to trade")+"</li>");$("#empList"+
c).append($.tmpl($("#te_sc_shift_release"+c),e));$('#schedule .trade>div [step^="step"]').hide();$("#schedule .trade>div [step=step_"+a.state+"]").show();$("span[rel=self_state]").html(a.state);$(d).removeClass("loading")});break;case 3:var e=$("#empList"+c+" .check:not(.all)"),b="0"==c?"trade":"tradeswap",g="0"==c?"tradewith":"swap";if(!e.length)return sp.showError(_s("You need to select at least one item")),$(d).removeClass("loading"),a.state-=1,!1;var i=[];e.each(function(a,b){"swap"==g?i.push($(b).attr("user_shift_id")):
i.push($(b).attr("rel"))});e={};e[g]=i.join(",");e.shift=a.shift.id;e.reason=$("textarea[name=reason_trade"+c+"]").val();spModel.schedule.create(b,e,function(){a.state=3;$('#schedule .trade>div [step^="step"]').hide();$("#schedule .trade>div [step=step_"+a.state+"]").show();$("span[rel=self_state]").html(a.state);$(d).removeClass("loading");$("#cs_sh_trade .steps").hide();$("#sc_sub_shift_display a.trade").hide();a.state=1});a.state=2;break;default:setTimeout(function(){a.state=3<a.state?3:a.state;
a.state=0>a.state?1:a.state;$('#schedule .trade>div [step^="step"]').hide();$("#schedule .trade>div [step=step_"+a.state+"]").show();$("span[rel=self_state]").html(a.state);$(d).removeClass("loading")},400)}});$("#sc_sub_shift_display ul a.publish").bind(clickEvent,function(b){b.preventDefault();if("true"==$(this).attr("first"))return $("#te_sc_shift_display_info").hide(),$("#te_sc_shift_display_publish").show(),$(this).attr("first","false"),!1;var c=$(this);c.addClass("loading");"undefined"!=typeof a.conflicts[c.attr("rel")]?
confirm(a.conflicts[c.attr("rel")].title)?spModel.schedule.get("publish",{shifts:c.attr("rel"),notify:$("#te_sc_shift_display_publish .radio.check").attr("value"),message:$("#tc_sc_shift_display_publish_textarea textarea").val()},function(b){sp.showSuccess(b.data);c.removeClass("loading");c.hide();a.resetPublishFields(!0)}):c.removeClass("loading"):spModel.schedule.get("conflicts",{schedule:$(this).attr("rel")},function(b){a.setConflicts(b.data);"undefined"!=typeof a.conflicts[c.attr("rel")]?confirm(_s("This shift has conflicts, but you can't fix them from mobile app. Force publish?"))?
spModel.schedule.get("publish",{shifts:c.attr("rel"),notify:$("#te_sc_shift_display_publish .radio.check").attr("value"),message:$("#tc_sc_shift_display_publish_textarea textarea").val()},function(b){sp.showSuccess(b.data);c.removeClass("loading");c.hide();a.resetPublishFields(!0)}):c.removeClass("loading"):spModel.schedule.get("publish",{shifts:c.attr("rel"),notify:$("#te_sc_shift_display_publish .radio.check").attr("value"),message:$("#tc_sc_shift_display_publish_textarea textarea").val()},function(b){sp.showSuccess(b.data);
c.removeClass("loading");c.hide();a.resetPublishFields(!0)})})});$("#sc_shift_display").delegate("#te_sc_shift_display_publish .radio",clickEvent,function(){$("#te_sc_shift_display_publish .radio").removeClass("check");$(this).addClass("check")});$("#sc_shift_display").delegate("#te_sc_shift_display_delete .radio",clickEvent,function(){$("#te_sc_shift_display_delete .radio").removeClass("check");$(this).addClass("check")});$("#sc_shift_display").delegate("#te_sc_shift_display_publish .checkbox",clickEvent,
function(){$(this).toggleClass("check");$("#tc_sc_shift_display_publish_textarea").toggle()});$("#sc_refresh").bind(clickEvent,function(b){$(this).parent().removeClass("active");b.preventDefault();a.displayShifts()});$("#sc_add").bind(clickEvent,function(a){a.preventDefault();sp.loadSubPage("","schedule","addShift")});$("#sc_add_add").bind(clickEvent,function(b){b.preventDefault();var c=$(this),d=0!=$("#sc_edit_id").val()?!0:!1;c.addClass("loading");var b={schedule:$("#sc_add_sc").val(),location:$("#sc_add_lo").val(),
title:$("#sc_add_ti").val(),start_time:$("#sc_date_st").val(),end_time:$("#sc_date_et").val(),start_date:$("#sc_date_sd").val(),end_date:$("#sc_date_ed").val(),notes:$("#sc_add_no").val()},e="create";d&&(e="update",b.id=$("#sc_edit_id").val());spModel.schedule[e]("shift",b,function(b){spModel.schedule.get("shift",{id:b.data.id,detailed:1},function(b){d?spModel.schedule.get("shift",{id:$("#sc_edit_id").val(),detailed:1},function(b){a.shift=b.data;sp.loadSubPage("","schedule","shiftDisplay");sp.showSuccess(_s("Shift Updated"))}):
(c.removeClass("loading"),a.shift=b.data,a.edit=!0,sp.loadSubPage("","schedule","addShift"))})},function(){c.removeClass("loading")})});$("#sc_add_user").delegate(".checkbox",clickEvent,function(){var b={id:$("#sc_edit_id").val()},c=$(this);c.parent().addClass("loading");c.hasClass("check")?b.remove=c.attr("user"):b.add=c.attr("user");spModel.schedule.update("shift",b,function(b){spModel.schedule.get("shift",{id:b.data.id,detailed:1},function(b){c.parent().removeClass("loading");a.shift=b.data;a.edit=
!0;sp.loadSubPage("","schedule","addShift")},function(){c.parent().removeClass("loading")})},function(){c.parent().removeClass("loading")})});$("#sc_edit_submenu .subNav a").bind(clickEvent,function(a){var c=$(this);a.preventDefault();c.addClass("loading");spModel.schedule.update("shiftapprove",{id:$("#sc_edit_id").val()},function(){sp.showSuccess(_s("Shift approved"));c.removeClass("loading");c.hide()},function(){c.removeClass("loading")})})};
ShiftPlanningSchedule.prototype.loadSubPageEvents=function(a){$("#sc_edit_id").val(0);$(".subNavigation").show();$("#sc_additional_menu").show();$("#sc_to_sub").html(sp.raw.config.today.formatted);var b;b=""+_s('<option value="employee">My Schedules</option>');if(1==parseInt(sp.staff.admin.settings.visible_overview)||5>parseInt(sp.staff.admin.info.group))b+=_s('<option value="overview">Schedule Overview</option>');b+=spView.schedulerFilter();$("#sc_fl").html(b);("shiftDisplay"==a||"addShift"==a||
"trade"==a)&&$(".subNavigation").hide();"addShift"==a&&$("#sc_additional_menu").hide();this[a+"SubEvents"]()};ShiftPlanningSchedule.prototype.todaySubEvents=function(){$("#sc_to_sub").prev().html("Today");this.page="today";this.displayShifts()};
ShiftPlanningSchedule.prototype.tradeSubEvents=function(){$("#schedule .trade>div").hide();$("#schedule .trade>div:first").show();$("#cs_sh_trade ul.shifts").html($.tmpl($("#te_cs_sh"),this.shift));$(".tradepick li").show();"1"!=sp.staff.admin.settings.trade_shifts&&$("#release").parent().parent().hide();"1"!=sp.staff.admin.business.pref_swap_shifts&&$("#swap").parent().parent().hide()};
ShiftPlanningSchedule.prototype.daySubEvents=function(){this.page="day";$("#sc_to_sub").prev().html("Current Day");this.displayShifts()};ShiftPlanningSchedule.prototype.monthSubEvents=function(){this.page="month";$("#sc_to_sub").prev().html("Selected Day");$("#sc_mo_di").html(Date.parseExact($.trim($("#sc_to_sub").html()),cal.dformat).add(1).day().toString("MMMM yyyy"));this.displayShifts()};
ShiftPlanningSchedule.prototype.shiftDisplaySubEvents=function(){this.shift=this.cleanPerm(this.shift);$("#sc_sub_shift_display a.trade").hide();this.fromDashboard||this.fromRecent||this.fromUpcoming?($("#sc_sub_shift_display a.delete").hide(),$("#sc_sub_shift_display a.edit").hide(),$("#sc_sub_shift_display a.publish").hide()):(0==this.shift.perms?($("#sc_sub_shift_display a.delete").hide(),$("#sc_sub_shift_display a.edit").hide(),$("#sc_sub_shift_display a.publish").hide(),$("#sc_sub_shift_display a.trade").hide()):
1==this.shift.perms?($("#sc_sub_shift_display a.delete").hide(),$("#sc_sub_shift_display a.edit").hide(),$("#sc_sub_shift_display a.publish").hide(),$("#sc_sub_shift_display a.trade").hide()):(0==this.shift.published?($("#sc_sub_shift_display a.publish").show(),$("#sc_sub_shift_display a.publish span").html('<img width="16" height="17" src="images/approve.png">')):this.shift.published<this.shift.edited&&0!=this.shift.published?($("#sc_sub_shift_display a.publish").show(),$("#sc_sub_shift_display a.publish span").html()):
$("#sc_sub_shift_display a.publish").hide(),0==sp.staff.admin.settings.draft&&$("#sc_sub_shift_display a.publish").hide(),$("#sc_sub_shift_display a.delete").show(),$("#sc_sub_shift_display a.edit").show()),$("#sc_sub_shift_display a.publish").attr("first","true"));var a=[];"undefined"!=typeof this.shift.employees&&null!=this.shift.employees?($.each(this.shift.employees,function(b,c){a[b]=c;a[b].avatar="undefined"!=typeof sp.staff.data.employees[c.userid]&&"undefined"!=typeof sp.staff.data.employees[c.userid].avatar&&
""!=sp.staff.data.employees[c.userid].avatar&&"undefined"!=typeof sp.staff.data.employees[c.userid].avatar.small?sp.staff.data.employees[c.userid].avatar.small:"images/no-avatar.png"}),this.shift.employees=a):this.shift.employees=[];this.shift.user_location=this.getLocation();$("#sc_shift_display").html($.tmpl($("#te_sc_shift_display"),this.shift));this.resetPublishFields(!0);null!=this.shift.trades&&""!=this.shift.trades||"1"!=sp.staff.admin.settings.trade_shifts&&"1"!=sp.staff.admin.business.pref_swap_shifts?
$("#sc_sub_shift_display a.trade").hide():$.each(this.shift.employees,function(a,c){c.id==sp.staff.admin.info.id&&$("#sc_sub_shift_display a.trade").show()});$("#sc_sub_shift_display ul a").attr("rel",this.shift.id);0!=this.shift.location&&$("#sc_location_iframe").html('<iframe  id="map" width="100%" height="220" frameborder="0" scrolling="no" src="http://'+googleIp+"/maps/?f=d&source=s_d&saddr="+this.shift.location.address+'&hl=en&z=15&output=embed"></iframe>')};
ShiftPlanningSchedule.prototype.resetPublishFields=function(a){"undefined"==typeof a&&(a=!1);a&&($("#te_sc_shift_display_publish").hide(),$("#te_sc_shift_display_info").show());$("#te_sc_shift_display_publish .radio").removeClass("check");$("#te_sc_shift_display_publish .checkbox").removeClass("check");$("#te_sc_shift_display_publish .radio[value=1]").addClass("check");$("#tc_sc_shift_display_publish_textarea").hide();$("#tc_sc_shift_display_publish_textarea textarea").val("");$("#sc_sub_shift_display ul a.publish").attr("first",
"true")};
ShiftPlanningSchedule.prototype.addShiftSubEvents=function(){var a=this;$("#sc_add_user").hide();$("#sc_add_sc").html(spView.schedulerFilter(0,!0));$("#sc_add_lo").html(spView.locationSelector());$("#sc_add_add").removeClass("loading");var b={};!1!=this.edit?(b=this.shift,b.start_date.formatted=Date.parse(b.start_date.formatted+" "+b.start_time.time).getTime()/1E3,b.end_date.formatted=Date.parse(b.end_date.formatted+" "+b.end_time.time).getTime()/1E3,null!=b.schedule&&$("#sc_add_sc").val(b.schedule),null!=
b.schedule&&$("#sc_add_sc").val(b.schedule)):(b.start_date={},b.end_date={},b.start_date.formatted=Date.parse("today at 9am").getTime()/1E3,b.end_date.formatted=Date.parse("today at 5pm").getTime()/1E3);var c=new Date(1E3*b.start_date.formatted),d=new Date(1E3*b.end_date.formatted),e=24==cal.tmode?"HH:mm":"hh:mm tt";$("#sc_date_st").scroller("destroy");$("#sc_date_st").val(c.toString(e));$("#sc_date_st").scroller({preset:"time",ampm:24==cal.tmode?!1:!0,stepMinute:15,timeFormat:sp.strReplace(["tt",
"mm"],["A","ii"],cal.tstring)});$("#sc_date_et").scroller("destroy");$("#sc_date_et").val(d.toString(e));$("#sc_date_et").scroller({preset:"time",ampm:24==cal.tmode?!1:!0,stepMinute:15,timeFormat:sp.strReplace(["tt","mm"],["A","ii"],cal.tstring)});$("#sc_date_sd").scroller("destroy");$("#sc_date_sd").val(c.toString(cal.dformat));$("#sc_date_sd").scroller({preset:"date",dateFormat:"mmM d, yy"==sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat)?sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).substr(2,
sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).length):sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat),dateOrder:sp.strReplace(["MM","yyyy"," ","-","/"],["mm","yy","","",""],cal.dformat)});$("#sc_date_ed").scroller("destroy");$("#sc_date_ed").val(d.toString(cal.dformat));$("#sc_date_ed").scroller({preset:"date",dateFormat:"mmM d, yy"==sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat)?sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat).substr(2,sp.strReplace(["MM","yyyy"],["mm","yy"],
cal.dformat).length):sp.strReplace(["MM","yyyy"],["mm","yy"],cal.dformat),dateOrder:sp.strReplace(["MM","yyyy"," ","-","/"],["mm","yy","","",""],cal.dformat)});$("#sc_add_no").val(this.edit?b.notes:"");$("#sc_add_ti").val(this.edit?b.title:"");$("#sc_add_lo").val(this.edit?0!=b.location?b.location.id:0:0);this.edit?($("#sc_add_add span").html(_s("Save Shift")),$("#sc_edit_id").val(b.id),$("#sc_edit_submenu .backMenu").attr("bck","edit"),0==b.confirmed&&b.end_date.id<sp.raw.config.today.id&&1==sp.staff.admin.settings.shift_confirm?
$("#sc_edit_submenu .subNav").show():$("#sc_edit_submenu .subNav").hide()):($("#sc_edit_submenu .subNav").hide(),$("#sc_edit_submenu .backMenu").attr("bck","add"),$("#sc_add_add span").html(_s("Add Shift And Set Users")));this.edit&&($("#sc_add_user .working ul").html(null==b.staff.scheduled?spView.emptyResult(_s("No scheduled employees for selected shift"),"li"):$.tmpl($("#te_sc_usersW"),this.prepareStaff(b.staff.scheduled))),delete b.staff.scheduled,$.each(b.staff,function(b,c){null==c||0==c.length?
$("#sc_add_user div[type="+b+"]").hide():($("#sc_add_user div[type="+b+"] ul.detailsGrid li ul").html($.tmpl($("#te_sc_users"),a.prepareStaff(c))),$("#sc_add_user div[type="+b+"]").show())}),$.each($("#sc_add_user .detailsGrid ul"),function(a,b){$.each($(b).find("li"),function(a){0==a%2?$(this).addClass("even"):$(this).addClass("odd")})}),$("#sc_add_user").show());this.edit=!1};
ShiftPlanningSchedule.prototype.getLocation=function(){var a=[],b=["city","state","address"];return sp.staff.admin.info.city||sp.staff.admin.info.state||sp.staff.admin.info.address?($.each(b,function(b,d){""!=sp.staff.admin.info[d]&&a.push(sp.staff.admin.info[d])}),a.join(",")):null};ShiftPlanningSchedule.prototype.prepareStaff=function(a){for(var b=a.length,c=[];b--;)c.push(sp.staff.data.employees[a[b][0]]);return c};
ShiftPlanningSchedule.prototype.nextPrevPrepare=function(a){$("#sc_mo_di").html(Date.parseExact($.trim($("#sc_to_sub").html()),cal.dformat).toString("MMMM yyyy"));if("today"==this.page)$(".subNavigation .schedule li a[subpage=day]").trigger(clickEvent);else if("day"==this.page)this.displayShifts();else if("month"==this.page){var b=parseInt($("#sc_ca_bo .today").attr("time")),c=$.trim($("#sc_mo_di").html());Date.parse(c).moveToFirstDayOfMonth().getDate();c=Date.parse(c).moveToLastDayOfMonth().getDate();
"prev"==a?1==b?this.displayShifts(c):(b--,$("#sc_ca_fi_"+b).trigger(clickEvent)):(b++,0==$("#sc_ca_fi_"+b).length?this.displayShifts(1):$("#sc_ca_fi_"+b).trigger(clickEvent))}};
ShiftPlanningSchedule.prototype.displayShifts=function(a){var b=this;"month"==this.page&&this.generateCalendar();$("#sc_td_list").hide();$("#sc_td .loading").show();$("#sc_td .additional").hide();$("#sc_ca_bo").parent().addClass("loading");$("#schedule").show();$(".subNavigation .schedule").show();var c=this.getSettings();spModel.schedule.get("shifts",c,function(c){$("#sc_ca_bo").parent().removeClass("loading");0<c.data.length?(c.data=b.cleanPerms(c.data),"month"==b.page?(b.fillCalendar(c.data),$("#sc_td_list").html($.tmpl($("#te_sc_shifts_months"),
b.shifts)),"undefined"!=typeof a&&$("#sc_ca_fi_"+a).trigger(clickEvent)):($("#sc_td_list").html('<ul class="shifts moved"></ul>'),$("#sc_td_list ul").html($.tmpl($("#te_sc_shifts_new"),c.data))),$("#sc_td_list").show(),$("#sc_td .loading").hide(),$("#sc_td_list .dTitle  span").each(function(){var a=$(this).find("t:last");null!=$(a).html()&&$(a).html($(a).html().substr(0,$(a).html().length-2))})):("month"==b.page&&"undefined"!=typeof a&&$("#sc_ca_fi_"+a).trigger(clickEvent),$("#sc_td_list").hide(),
$("#sc_td .loading").hide(),$("#sc_td .additional").show());$("#sc_td_list .isShift > p").each(function(){$(this).html($(this).html().substring(0,$(this).html().length-1))})})};ShiftPlanningSchedule.prototype.cleanPerms=function(a){var b=this;$.each(a,function(c,d){a[c]=b.cleanPerm(d)});return a};
ShiftPlanningSchedule.prototype.cleanPerm=function(a){if(null!=a.employees&&2>a.perms&&0==sp.staff.admin.settings.visible_coworkers){var b=[];$.each(a.employees,function(a,d){d.id==sp.staff.admin.info.id&&b.push(d)});a.employees=b}return a};ShiftPlanningSchedule.prototype.clearSchedules=function(){var a={};$.each(sp.schedule.data.schedules,function(b,c){spView.checkPerm(c,!0)&&(a[b+""]=c)});return a};
ShiftPlanningSchedule.prototype.checkSchedulePerm=function(a){return"undefined"==typeof sp.schedule.data.schedules[a]?0:sp.schedule.data.schedules[a].perms};
ShiftPlanningSchedule.prototype.fillCalendar=function(a){var b={};$.each(a,function(a,c){"undefined"==typeof b[c.start_date.day+""]&&(b[c.start_date.day+""]={dateToday:c.start_date.formatted,shifts:[]});b[c.start_date.day+""].shifts.push(c)});$("#sc_ca_bo td").removeClass("hasAny");var c=[];$.each(b,function(a,b){c[a]=b;$("#sc_ca_fi_"+a).addClass("hasAny")});this.shifts=c};
ShiftPlanningSchedule.prototype.getColorsBySchedule=function(a,b){return"undefined"!=typeof sp.schedule.data.schedules[a]?"undefined"!=typeof b?sp.raw.config.newcolorsets[sp.schedule.data.schedules[a].color][b]:sp.raw.config.newcolorsets[sp.schedule.data.schedules[a].color]:["000","aaa","fff","fff","000"]};
ShiftPlanningSchedule.prototype.getSettings=function(){"month"!=this.page?(this.settings.start_date=Date.parseExact($.trim($("#sc_to_sub").html()),cal.dformat).toString(cal.dformat),this.settings.end_date=Date.parseExact($.trim($("#sc_to_sub").html()),cal.dformat).toString(cal.dformat)):(this.settings.start_date=Date.parse($.trim($("#sc_mo_di").html())).moveToFirstDayOfMonth().toString(cal.dformat),this.settings.end_date=Date.parse($.trim($("#sc_mo_di").html())).moveToLastDayOfMonth().toString(cal.dformat));
return this.settings};ShiftPlanningSchedule.prototype.setSettings=function(){$("#sc_start_day").val(this.settings.start_date);$("#sc_end_day").val(this.settings.end_day);$("#sc_mode").val(this.settings.end_day);$("#sc_schedule").val(this.settings.end_day)};ShiftPlanningSchedule.prototype.generateCalendar=function(){$("#sc_ca_he").html(this.generateTop());$("#sc_ca_bo").html(this.generateMiddle())};
ShiftPlanningSchedule.prototype.generateTop=function(){var a=cal.startday-1,b="";if(0<a){for(var c=a;7>c;c++)b+="<th>"+daysOfWeekS[c]+"</th>";for(c=0;c<a;c++)b+="<th>"+daysOfWeekS[c]+"</th>"}else for(c=0;7>c;c++)b+="<th>"+daysOfWeekS[c]+"</th>";return b};
ShiftPlanningSchedule.prototype.generateMiddle=function(a){for(var a="undefined"==typeof a?$.trim($("#sc_mo_di").html()):a,b=Date.parse(a).moveToFirstDayOfMonth().getDate(),c=Date.parse(a).moveToLastDayOfMonth().getDate(),d=Date.parse(a).moveToFirstDayOfMonth().getDay()-(cal.startday-1),e=Date.parse($.trim($("#sc_to_sub").html())).addMonths(-1).moveToLastDayOfMonth().getDate(),a="",g=[],d=e-(0<=d?d:7+d)+1;d<=e;d++)g.push('<td class="notM">'+d+"</td>");for(d=b;d<=c;d++)g.push('<td id="sc_ca_fi_'+d+
'" time="'+d+'">'+d+"</td>");b=7-g.length%7;for(d=1;d<=b;d++)g.push('<td class="notM">'+d+"</td>");for(b=0;b<g.length/7;b++)a+="<tr>"+g.slice(7*b,7*(b+1)).join("")+"</tr>";return a};ShiftPlanningSchedule.prototype.loadPage=function(){var a=!1;$.each(this.data.schedules,function(b,c){if(2==c.perms)return a=!0});a||$("#sc_add").parent().hide();this.generateCalendar()};ShiftPlanningPermissions.prototype.initialize=function(){var a=this;$(document).ready(function(){1==user.loggedIn&&a.preparePermissions()})};
ShiftPlanningPermissions.prototype.preparePermissions=function(){var a=sp.staff.admin.settings,b=sp.staff.admin.info.group;0==parseInt(a.message_wall_on)&&($("#da_wa_nm_b").remove(),$("#da_wa_nm_f").remove(),$("#da_wa_li").html(spView.emptyResult(_s("Message wall is off. Please contact your manager for more info."),"li")));b>this.supervisor&&0==parseInt(a.message_wall_emp)&&($("#da_wa_nm_b").remove(),$("#da_wa_nm_f").remove());0==parseInt(a.message_wall_comments)&&$("#da_wa_li").addClass("permMsgCommentOff");
b>=this.scheduler&&0==parseInt(a.pm)&&($("#da_in_nm_b").unbind(clickEvent),$("#da_in_nm_b").remove());0==a.shift_confirm&&$(".subNavigation .reports a[subpage=confirmedHours]").remove();b>=this.employee&&($("#da_se_ov_no, #da_se_ed_no").parents(".detailsGrid").remove(),$("#tc_mts_sub_button").remove(),$("#tc_mts").remove(),$(".subNavigation .requests a[subpage=shiftApprovals]").remove(),$("#rq_sa").remove());b>=this.scheduler&&($("#menu_reports").remove(),$("#reports").remove(),$("#settings .aPerm").remove(),
$(".subNavigation .staff a[subpage=addStaff]").remove(),$(".subNavigation .staff a[subpage=fastAssignment]").remove(),$("#staff .addStaff").remove(),$("#st_fa").remove());b>=this.scheduler&&0==parseInt(a.tc_empl_addtime)&&$("#tc_act_sub_button").remove();0==parseInt(a.timeclock)&&($("#menu #menu_timeClock").unbind(clickEvent),$("#da_widgets .timeClock").remove(),$("#menu #menu_timeClock").remove(),$("#timeClock").remove(),$(".subNavigation div.timeClock").remove(),$(".subNavigation .reports a[subpage=confirmedTimeSheets]").remove());
b>=this.employee&&0==parseInt(a.visible_staff)&&($("#menu #menu_staff").unbind(clickEvent),$("#menu #menu_staff").remove(),$("#staff").remove(),$(".subNavigation div.staff").remove());b>=this.scheduler&&0==parseInt(a.edit_profile)&&$(".subNavigation .settings .subNav a[subpage=edit]").hide()};
ShiftPlanningPermissions.prototype.hasPermission=function(a){var b=sp.staff.admin.settings,c=sp.staff.admin.info.group;switch(a){case "visible_staff_details":if(c>=this.employee&&0==parseInt(b.visible_staff_details))return!1;break;case "edit_profile":if(c>this.scheduler&&0==parseInt(b.edit_profile))return!1;break;case "message_wall_comments":if(c>this.manager&&0==parseInt(b.message_wall_comments))return!1}return!0};
ShiftPlanningPermissions.prototype.fixStaffListing=function(){var a=sp.staff.data.employees,b=sp.schedule.clearSchedules(),c={};$.each(b,function(b,e){$.each(a,function(a,b){null!=b.schedules&&"undefined"!=typeof b.schedules[e.id]&&(c[b.id+""]=b)})});return c};ShiftPlanningTraining.prototype.initialize=function(){var a=this;$(document).ready(function(){a.overviewEvents()})};ShiftPlanningTraining.prototype.loadSubPageEvents=function(a){this[a+"SubEvents"]()};
ShiftPlanningTraining.prototype.overviewEvents=function(){$("#training .training .filters li a").bind(clickEvent,function(a){a.preventDefault();a.stopPropagation();a=$(this).attr("subpage");$("#training .training .filters li").removeClass("active");$(this).parent().addClass("active");sp.loadSubPage("","training",a)});$("#training .training_sections").delegate("div[rel]",clickEvent,function(){sp.training.tmp_section=$(this).attr("rel");sp.loadSubPage("","training","singleSection")});$("#training .training_singleSection").delegate("div[rel]",
clickEvent,function(){sp.training.tmp_module=$(this).attr("rel");sp.loadSubPage("","training","singleModule")});$(".training_module").delegate("a.confirm",clickEvent,function(){var a=$(this).attr("rel");spModel.training.update("complete",{id:a},function(){sp.showSuccess("Finished");setTimeout(function(){$(".singleSection .backMenu").trigger(clickEvent)},2500)})});$(".training_module").delegate("a#tr_send_signature",clickEvent,function(){var a=$(this).attr("rel"),b=$("#digi_text").val();$(this).addClass("loading");
var c=$(this);spModel.training.update("complete",{id:a,signature:b},function(a){sp.showSuccess(a.data);"Signed"===a.data?setTimeout(function(){$(".singleSection .backMenu").trigger(clickEvent)},2500):c.removeClass("loading")})});$(".training_module").delegate("#show_all",clickEvent,function(){$(".training_module div[sign=sign]").show();$("#show_all").parent().remove()});$(".singleSection .backMenu").bind(clickEvent,function(a){a.preventDefault();a.stopPropagation();$(".subNavigation .training li.active a").trigger(clickEvent)});
$(".singleModule .backMenu").bind(clickEvent,function(a){a.preventDefault();a.stopPropagation();sp.loadSubPage("","training","singleSection")});$(".topicstatistic .backMenu").bind(clickEvent,function(a){a.preventDefault();a.stopPropagation();sp.loadSubPage("","training","singleModule")});$(".singleModule .subMenu .topic_stat").bind(clickEvent,function(a){a.preventDefault();a.stopPropagation();sp.loadSubPage("","training","topicstatistic")});$(".singleModule").delegate("#tr_send_comment",clickEvent,
function(a){a.preventDefault();a.stopPropagation();a=$.trim($("#tr_comment").val());0<a.length?($(this).addClass("loading"),spModel.training.update("comments",{module_id:sp.training.tmp_module,text:a,type:1},function(){sp.showSuccess("Comment added");setTimeout(function(){$(".singleModule .backMenu").trigger(clickEvent)},2500)})):sp.showError("Empty comment")})};
ShiftPlanningTraining.prototype.overviewSubEvents=function(){$(".subNavigation").show();$(".training").show();2>=sp.staff.admin.info.group&&$(".training  a[subpage=statistic]").parent().removeClass("hidden")};
ShiftPlanningTraining.prototype.sectionsSubEvents=function(){$(".subNavigation").show();$(".training").show();2>=sp.staff.admin.info.group&&($(".training  a[subpage=statistic]").parent().removeClass("hidden"),$(".training .singleModule .subMenu").removeClass("hidden"));$(".training_sections").html(spView.ulLoader());var a=[],b=[];spModel.training.get("progress",{},function(c){if("undefined"!=typeof c.data[sp.staff.admin.info.id]){var d=Math.round(100*(c.data[sp.staff.admin.info.id].completed/c.data[sp.staff.admin.info.id].total));
$("#user_progress").html(d);$(".progress").css("width",d+"%")}sp.training.statistic=c.data;spModel.training.get("sections",{},function(c){a=c.data;spModel.training.get("modules",{detailed:1},function(c){b=c.data;for(var c=[],d=0;d<a.length;d++){for(var e=[],k=a[d].notfinished_count=0;k<b.length;k++)a[d].id==b[k].section&&(2!=b[k].comment_type&&e.push(b[k]),"undefined"!=typeof b[k].employees&&"undefined"!=typeof b[k].employees[sp.staff.admin.info.id]&&(b[k].finished_flag=b[k].employees[sp.staff.admin.info.id].finished?
"1":"0","0"==b[k].finished_flag&&a[d].notfinished_count++,"undefined"!=typeof b[k].employees[sp.staff.admin.info.id].outdated&&(b[k].finished_flag="99",a[d].notfinished_count++)));a[d].modules=e;0<a[d].modules.length&&(c.push(a[d]),sp.training.trainings[a[d].id]=a[d])}$(".training_sections").html($.tmpl($("#te_tr_sections"),c));$(".training div.oneLine b").shorten();0==$(".training_sections > *").length&&$(".training_sections").html(spView.emptyResult(_s("No training topics."),"li"))})})})};
ShiftPlanningTraining.prototype.statisticSubEvents=function(){$(".subNavigation").show();$(".training").show();$(".training_statistic").html(spView.divLoader());if(2<sp.staff.admin.info.group)return sp.showError("You have no permission"),setTimeout(function(){sp.loadSubPage("","training","sections")},1500),!1;setTimeout(function(){var a=[];$.each(sp.training.statistic,function(){this.stat=0==this.completed?0:Math.round(100*(this.completed/this.total));this.avatar=sp.getAvatar(this.id);a.push(this)});
$(".training_statistic").html($.tmpl($("#te_tr_statistic"),a))},500)};
ShiftPlanningTraining.prototype.singleSectionSubEvents=function(){$(".training_singleSection").html(spView.ulLoader());$("#section_name").html(sp.training.trainings[sp.training.tmp_section].title);setTimeout(function(){for(var a=0;a<sp.training.trainings[sp.training.tmp_section].modules.length;a++)if("undefined"==typeof sp.training.trainings[sp.training.tmp_section].modules[a].finished_flag&&(sp.training.trainings[sp.training.tmp_section].modules[a].finished_flag=-99),0!=sp.training.trainings[sp.training.tmp_section].modules[a].duedate){var b=
new Date,c=new Date(1E3*sp.training.trainings[sp.training.tmp_section].modules[a].duedate),d=9<c.getMonth()?c.getMonth()+1:"0"+(c.getMonth()+1);sp.training.trainings[sp.training.tmp_section].modules[a].color=b>c?"#8C1919":"green";sp.training.trainings[sp.training.tmp_section].modules[a].duedate_formated=c.getDate()+"-"+d+"-"+c.getFullYear()}$(".training_singleSection").html($.tmpl($("#te_tr_singleSection"),sp.training.trainings[sp.training.tmp_section].modules));$(".training div.oneLine b").shorten()},
500)};
ShiftPlanningTraining.prototype.singleModuleSubEvents=function(){$(".training .training_module").html(spView.divLoader());setTimeout(function(){for(var a={},b=0;b<sp.training.trainings[sp.training.tmp_section].modules.length;b++)sp.training.tmp_module==sp.training.trainings[sp.training.tmp_section].modules[b].id&&(a=sp.training.trainings[sp.training.tmp_section].modules[b]);null!=a.contents?(a.contents=a.contents.replace(/\n/g,"</p><br/><p>"),a.contents=spView.bbc2HTML(a.contents)):a.contents="";
0<a.files.length&&$.each(a.files,function(){this.file_size=spView.friendly_filesize(this.file_size)});1==a.comment_type||1==a.digital_signature?(1==a.comment_type&&spModel.training.get("comments",{module_id:sp.training.tmp_module,type:1},function(b){var d=[];$.each(b.data,function(){sp.staff.admin.info.group<=a.can_see_comment&&(this.avatar=sp.getAvatar(this.user),d.push(this))});a.comments=d;1==a.digital_signature?spModel.training.get("digital_signature",{module_id:a.id},function(b){var c=[];$.each(b.data,
function(){2>=sp.staff.admin.info.group?(this.avatar=sp.getAvatar(this.user),c.push(this)):this.user==sp.staff.admin.info.id&&(this.avatar=sp.getAvatar(this.user),c.push(this))});a.signatures=c;$(".training_module").html($.tmpl($("#te_tr_module"),a));b=$(".training_module .wys");b.html(b.text());$.each(b.find("p"),function(){0==$(this).html().length&&$(this).remove()});$(".confirm").remove();$("div[sign=sign]:gt(5)").hide();$("<div>",{"class":"title1 wide"}).html($("<a>",{text:"show more",id:"show_all",
onclick:"void(0)"})).insertAfter($("div[sign=sign]:eq(5)"))}):($(".training_module").html($.tmpl($("#te_tr_module"),a)),b=$(".training_module .wys"),b.html(b.text()),$.each(b.find("p"),function(){0==$(this).html().length&&$(this).remove()}))}),1==a.digital_signature&&0==a.comment_type&&spModel.training.get("digital_signature",{module_id:a.id},function(b){var d=[];$.each(b.data,function(){2>=sp.staff.admin.info.group?(this.avatar=sp.getAvatar(this.user),d.push(this)):this.user==sp.staff.admin.info.id&&
(this.avatar=sp.getAvatar(this.user),d.push(this))});a.signatures=d;$(".training_module").html($.tmpl($("#te_tr_module"),a));b=$(".training_module .wys");b.html(b.text());$.each(b.find("p"),function(){0==$(this).html().length&&$(this).remove()});$(".confirm").remove();$("div[sign=sign]:gt(5)").hide();$("<div>",{"class":"title1 wide"}).html($("<a>",{text:"show more",id:"show_all",onclick:"void(0)"})).insertAfter($("div[sign=sign]:eq(5)"))})):($(".training_module").html($.tmpl($("#te_tr_module"),a)),
b=$(".training_module .wys"),b.html(b.text()),$.each(b.find("p"),function(){0==$(this).html().length&&$(this).remove()}))},500)};
ShiftPlanningTraining.prototype.topicstatisticSubEvents=function(){$(".training_topic_stat").html(spView.divLoader());if(2<sp.staff.admin.info.group)return sp.showError("You have no permission"),setTimeout(function(){sp.loadSubPage("","training","sections")},1500),!1;setTimeout(function(){for(var a={},b=0;b<sp.training.trainings[sp.training.tmp_section].modules.length;b++)sp.training.tmp_module==sp.training.trainings[sp.training.tmp_section].modules[b].id&&(a=sp.training.trainings[sp.training.tmp_section].modules[b]);
if("undefined"!=typeof a.employees&&null!=typeof a.employees){var c=[];$.each(a.employees,function(){this.avatar=sp.getAvatar(this.id);c.push(this)});$(".training_topic_stat").html($.tmpl($("#te_tr_topic_statistic"),c))}else $(".training_topic_stat").html("No employees on assigned on this topic")},500)};ShiftPlanningTraining.prototype.loadPage=function(){};ShiftPlanningSettings.prototype.initialize=function(){var a=this;$(document).ready(function(){a.overviewEvents()})};
ShiftPlanningSettings.prototype.loadSubPageEvents=function(a){if("recentShifts"==a||"upcomingShifts"==a)this.displayShifts(sp.staff.data.employees[$("#da_se_cur_us_id").val()],a);else this[a+"SubEvents"]()};ShiftPlanningSettings.prototype.loadPage=function(){};
ShiftPlanningSettings.prototype.overviewEvents=function(){var a=this;$("#da_se_ed_cu").delegate(".checkbox",clickEvent,function(){$(this).hasClass("check")?$(this).removeClass("check"):$(this).addClass("check")});$("#da_se_ed_po, #da_se_ov_po, #da_se_ed_sk, #da_se_ov_sk").delegate(".checkbox",clickEvent,function(){var b=$(this).attr("itemId"),c=0<$(this).parents(".skills").length?!0:!1,d=$(this).hasClass("check")?!0:!1,e=this;$(e).parent().addClass("loading");var g={id:$("#da_se_cur_us_id").val()};
c?d?g.removeskill=b:g.addskill=b:d?g.removeschedule=b:g.addschedule=b;spModel.staff.update("employee",g,function(b){d?$(e).removeClass("check"):$(e).addClass("check");$(e).parent().removeClass("loading");a.updateUser($("#da_se_cur_us_id").val(),b,!1)})});$("#da_se_ed_ue").bind(clickEvent,function(b){$(this).addClass("loading");b.preventDefault();a.saveEditForm($(this))});$("textarea#da_se_ov_no, textarea#da_se_ed_no").bind("blur",function(){a.updateNotes($(this).val())});$("#da_se_pa_up").bind(clickEvent,
function(b){b.preventDefault();a.changePassword()});$("#da_se_ov_aa a").bind(clickEvent,function(b){b.preventDefault();confirm(_s("Are you sure?"))&&a.adminActions(this)});$("#da_se_rs_li").delegate(".fr",clickEvent,function(a){a.preventDefault();switch($("#menu .mainNav .active").attr("id")){case "menu_staff":sp.schedule.fromStaff=!0;break;case "menu_dashboard":sp.schedule.fromStaff=!1}spModel.schedule.get("shift",{id:$(this).attr("shiftId"),detailed:1},function(a){sp.schedule.fromRecent=!0;sp.schedule.shift=
a.data;sp.loadSubPage("","schedule","shiftDisplay")})});$("#da_se_us_li").delegate(".fr",clickEvent,function(a){a.preventDefault();switch($("#menu .mainNav .active").attr("id")){case "menu_staff":sp.schedule.fromStaff=!0;break;case "menu_dashboard":sp.schedule.fromStaff=!1}spModel.schedule.get("shift",{id:$(this).attr("shiftId"),detailed:1},function(a){sp.schedule.fromUpcoming=!0;sp.schedule.shift=a.data;sp.loadSubPage("","schedule","shiftDisplay")})});$(".settings .backMenu").bind(clickEvent,function(a){a.preventDefault();
sp.hashChange=!1;sp.loadPage("staff");$(".subNavigation").show()});$("#settings .mainSub.settings .subNav").delegate("a",clickEvent,function(b){b.preventDefault();var b=$(this).attr("subpage"),c=$("#da_se_cur_us_id").val();"overview"==b?a.overviewSubEvents(sp.staff.data.employees[c]):a.loadSubPageEvents(b);$("#settings .mainSub.settings .subNav li").removeClass("active");$("#settings .mainSub.settings .subNav a[subpage="+b+"]").parent().addClass("active");$("#settings .main").hide();$("#settings .main."+
b).show();$("#settings .mainSub.settings").show();sp.fixCheckboxes()})};
ShiftPlanningSettings.prototype.overviewSubEvents=function(a){"undefined"==typeof a&&(a=sp.staff.admin.info);a.id==sp.staff.admin.info.id?($("#settings .search").show(),sp.permissions.hasPermission("edit_profile")?$("#settings .subNav a[subpage=edit]").show():$("#settings .subNav a[subpage=edit]").hide()):(4<sp.staff.admin.info.group?$("#settings .search").hide():($("#settings .subNav a[subpage=edit]").show(),$("#settings .search").show()),4<=sp.staff.admin.info.group&&$(".settings .subNav .hideEm").hide());
2>=a.group?$("#da_se_ov_aa .button").hide():$("#da_se_ov_aa .button").show();3<sp.staff.admin.info.group?$("#da_se_ov_wa").parent().hide():$("#da_se_ov_wa").parent().show();this.prefillOverview(a);this.prepareEditDetails(a);this.preparePasswordField(a);$("#settings .search.settings.mainSub ").hide();sp.fixCheckboxes()};ShiftPlanningSettings.prototype.editSubEvents=function(){};ShiftPlanningSettings.prototype.upcomingShiftsSubEvents=function(){};
ShiftPlanningSettings.prototype.recentShiftsSubEvents=function(){};ShiftPlanningSettings.prototype.passwordSubEvents=function(){};
ShiftPlanningSettings.prototype.prefillOverview=function(a){var b={};$.each(a,function(a,c){if(null==c||0==c.length)c="&nbsp;";b[a]=c});a=b;$("#da_se_cur_us_id").val(a.id);$("#da_se_ov_fn").html(a.name);$("#da_se_ov_id").html(a.eid);$("#da_se_ov_un").html(a.username);$("#da_se_ov_mo").html(a.cell_phone);$("#da_se_ov_ho").html(a.home_phone);$("#da_se_ov_em").html(a.email);0!=$.trim(a.wage).length&&$("#da_se_ov_wa").html(spView.fixCurrency(sp.staff.admin.settings.currency,!0)+a.wage);var c=_s("Administrative accounts cannot be de-activated."),
d=_s("User has actived his/her account.");1==parseInt(a.status)&&2<parseInt(a.group)?c=_s("User Account is Enabled."):0==parseInt(a.status)&&2<parseInt(a.group)&&(c=_s("User Account is Enabled."),d=_s("User account is not activated."));3<sp.staff.admin.info.group?($("#da_se_ov_aa").hide(),$("#da_se_ov_aa").prev().hide()):($("#da_se_ov_aa").prev().show(),$("#da_se_ov_aa").show());0==a.status?($("#da_se_ov_aa a[type=activate]").show(),$("#da_se_ov_aa a[type=manualyActivate]").show()):($("#da_se_ov_aa a[type=activate]").hide(),
$("#da_se_ov_aa a[type=manualyActivate]").hide());$("#da_se_ov_st").html(d);$("#da_se_ov_ac").html(c);0!=a.birth_month&&0!=a.birth_day?$("#da_se_ov_bd").html(months[a.birth_month-1]+" "+a.birth_day):$("#da_se_ov_bd").html("&nbsp;");$("#da_se_ov_cu").html(spView.customFields(a));$("#da_se_ov_po").html(spView.editableSchedules(a));$("#da_se_ov_sk").html(spView.editableSkills(a));$("#da_se_ov_no").html(0<a.notes.length?a.notes:"");$("#da_se_ov_pos").html("");if("undefined"!=typeof a.schedules){var e=
"";$.each(a.schedules,function(a,b){e+=b+", "});$("#da_se_ov_pos").html(e.substr(0,e.length-2))}};
ShiftPlanningSettings.prototype.prepareEditDetails=function(a){var b={};$.each(a,function(a,c){if(null==c||0==c.length)c="";b[a]=c});a=b;this.listLanguages();$("#da_se_ed_na").val(a.name);$("#da_se_ed_em").val(a.email);$("#da_se_ed_nn").val(a.nick_name);$("#da_se_ed_us").val(a.username);var c=null==a.cell_phone?["","","",""]:a.cell_phone.split("-");$("#da_se_ed_mph_0").val(c[0]);$("#da_se_ed_mph_1").val(c[1]);$("#da_se_ed_mph_2").val(c[2]);c=null==a.home_phone?["","","",""]:a.home_phone.split("-");
$("#da_se_ed_hph_0").val(c[0]);$("#da_se_ed_hph_1").val(c[1]);$("#da_se_ed_hph_2").val(c[2]);$("#da_se_ed_ad").val(a.address);$("#da_se_ed_ci").val(a.city);$("#da_se_ed_sp").val(a.state);$("#da_se_ed_pz").val(a.zip);$("#da_se_ed_bday_m").val(a.birth_month);$("#da_se_ed_bday_d").val(a.birth_day);$("#da_se_ed_no").val(a.notes);$("#da_se_ed_cu").html(spView.editableCustomFields(a));$("#da_se_ed_po").html(spView.editableSchedules(a));$("#da_se_ed_sk").html(spView.editableSkills(a));$("#da_se_ed_no").html(null!=
a.notes&&0<a.notes.length?a.notes:"");$("#da_se_ed_lang").val(a.language)};ShiftPlanningSettings.prototype.listLanguages=function(){var a='<option  value="none">'+_s("Company default")+"</option>";$.each(sp.raw.config.languages,function(b,c){a+='<option value="'+c.code+'">'+c.name+" "+(1==c.machine?"(machine)":"")+"</option>"});$("#da_se_ed_lang").html(a)};ShiftPlanningSettings.prototype.preparePasswordField=function(){$("#da_se_pa_np").val("");$("#da_se_pa_cp").val("")};
ShiftPlanningSettings.prototype.displayShifts=function(a,b){var c,d,e=!1;switch(b){case "recentShifts":$("#da_se_rs_li").html(spView.ulLoader());var g={start_date:"today -2 months",end_date:"yesterday",mode:"employee",employees:a.id},e=!0;c=$("#da_se_rs_li");d="No recent shifts";break;case "upcomingShifts":$("#da_se_us_li").html(spView.ulLoader()),g={start_date:"today ",end_date:"today +2 months",mode:"employee",employees:a.id},c=$("#da_se_us_li"),d="No upcoming shifts"}spModel.schedule.get("shifts",
g,function(a){if(""==a.data)$(c).html(spView.emptyResult(d));else if(e){e=!1;for(var b=[],g=a.data.length-1,m=0;m<a.data.length;m++)b.push(a.data[g--]);$(c).html($.tmpl($("#te_da_se_rs"),b))}else $(c).html($.tmpl($("#te_da_se_rs"),a.data))})};
ShiftPlanningSettings.prototype.updateUser=function(a,b,c){"undefined"==typeof c&&(c=!0);a==sp.staff.admin.info.id&&(sp.staff.admin.info=b.data);sp.staff.data.employees[""+a]=b.data;c&&this.overviewSubEvents(sp.staff.data.employees[""+a]);"staff"==sp.hash()&&$("#pages #settings .mainSub.settings").show();sp.showSuccess(_s("Selected user updated."))};
ShiftPlanningSettings.prototype.updateNotes=function(a){if(sp.hasPermission(4)||parseInt($("#da_se_cur_us_id").val())==sp.staff.admin.info.id){var b=this,c=$("#da_se_cur_us_id").val();spModel.staff.update("employee",{id:c,notes:a},function(a){b.updateUser(c,a)})}};
ShiftPlanningSettings.prototype.saveEditForm=function(a){var b=$("#da_se_cur_us_id").val(),c=this,d={},e=spModel.staff.getEmployeeById($("#da_se_cur_us_id").val());d.id=b;d.name=$("#da_se_ed_na").val();d.email=$("#da_se_ed_em").val();0<$("#da_se_ed_nn").val().length&&(d.nick_name=$("#da_se_ed_nn").val());3<$("#da_se_ed_us").val().length&&(d.username=$("#da_se_ed_us").val());0<$("#da_se_ed_ad").val().length&&(d.address=$("#da_se_ed_ad").val());0<$("#da_se_ed_ci").val().length&&(d.city=$("#da_se_ed_ci").val());
0<$("#da_se_ed_sp").val().length&&(d.state=$("#da_se_ed_sp").val());0<$("#da_se_ed_pz").val().length&&(d.zip=$("#da_se_ed_pz").val());d.language="none"==$("#da_se_ed_lang").val()?"":$("#da_se_ed_lang").val();d.birth_day=$("#da_se_ed_bday_d").val();d.birth_month=$("#da_se_ed_bday_m").val();0<$("#da_se_ed_mph_0").val().length&&(0<$("#da_se_ed_mph_1").val().length&&0<$("#da_se_ed_mph_2").val().length)&&(d.cell_phone=$("#da_se_ed_mph_0").val()+"-"+$("#da_se_ed_mph_1").val()+"-"+$("#da_se_ed_mph_2").val());
0<$("#da_se_ed_hph_0").val().length&&(0<$("#da_se_ed_hph_1").val().length&&0<$("#da_se_ed_hph_2").val().length)&&(d.home_phone=$("#da_se_ed_hph_0").val()+"-"+$("#da_se_ed_hph_1").val()+"-"+$("#da_se_ed_hph_2").val());var g={},i="";$('#da_se_ed_cu li [item="edit"]').each(function(a,b){i=$(b).val();0==i.lenght&&(i="");$(b).hasClass("checkbox check")?i=1:$(b).hasClass("checkbox")&&(i=0);g[$(b).attr("id")]=i});g=JSON.stringify(g);d.custom=g;spModel.staff.update("employee",d,function(d){e.id==sp.staff.admin.info.id&&
e.language!=d.data.language&&(setCookie("shiftplanning_mobile_lang",d.data.language,cookieExpire),window.location.reload());a.removeClass("loading");c.updateUser(b,d)},function(){a.removeClass("loading")})};ShiftPlanningSettings.prototype.changePassword=function(){var a=this,b=$("#da_se_cur_us_id").val();6<=$("#da_se_pa_np").val().length&&$("#da_se_pa_np").val()==$("#da_se_pa_cp").val()?spModel.staff.update("employee",{id:b,password:$("#da_se_pa_np").val()},function(c){a.updateUser(b,c)}):sp.showError(_s("Password length must 6 or more chars and passwords must match."))};
ShiftPlanningSettings.prototype.adminActions=function(a){var b=$("#da_se_cur_us_id").val(),c=$(a).attr("type"),d="update",b={id:b};"deactivate"==c?b.status=-1:"delete"==c?d="delete":"activate"==c?b.send_activation=1:b.status=1;sp.api("staff.employee",d,b,function(){sp.staff.getStaff(function(){"deactivate"==c?(sp.showSuccess(_s("User deactivated!")),$(".search.settings.mainSub .backMenu").trigger(clickEvent)):"delete"==c?(sp.showSuccess(_s("User deleted!")),$(".search.settings.mainSub .backMenu").trigger(clickEvent)):
"activate"==c?(sp.showSuccess(_s("Activation successfully sent.")),$(a).hide()):(sp.showSuccess(_s("Employee activated successfully.")),$("#da_se_ov_aa a[type=activate]").hide(),$(a).hide(),$("#da_se_ov_st").html(_s("User Account is Enabled.")))})},function(a){sp.showError(a.error)})};var cal,lastTouch,clickEvent="click",deviceAgent=navigator.userAgent.toLowerCase(),agentID=deviceAgent.match(/(iphone|ipod|ipad)/),ua=navigator.userAgent.toLowerCase(),isAndroid=-1<ua.indexOf("android");
agentID&&(clickEvent="click");
jQuery.event.special.touch={setup:function(){var a=jQuery(this);window.Touch?(a.bind("touchstart",jQuery.event.special.touch.onTouchStart),a.bind("touchmove",jQuery.event.special.touch.onTouchMove),a.bind("touchend",jQuery.event.special.touch.onTouchEnd)):a.bind("click",jQuery.event.special.touch.click)},click:function(a){a.type="touch";jQuery.event.handle.apply(this,arguments)},teardown:function(){var a=jQuery(this);window.Touch?(a.unbind("touchstart",jQuery.event.special.touch.onTouchStart),a.unbind("touchmove",
jQuery.event.special.touch.onTouchMove),a.unbind("touchend",jQuery.event.special.touch.onTouchEnd)):a.unbind("click",jQuery.event.special.touch.click)},onTouchStart:function(a){this.moved=!1;lastTouch=a.originalEvent.targetTouches[0]},onTouchMove:function(){this.moved=!0},onTouchEnd:function(a){this.moved||(a.type="touch",jQuery.event.handle.apply(this,arguments))}};
ShiftPlanning.prototype.toggleMenu=function(){$("#menu").toggleClass("hidden");$("#wrapper").toggleClass("extended");$("#wrapper").hasClass("extended")?($("#wrapper").css("margin-left",190),$("#menu").css("margin-left",0),$(".blackMask").css("display","block"),$(".blackMask").css("opacity","0.5")):($("#wrapper").css("margin-left",0),$("#menu").css("margin-left",-190),$(".blackMask").css("display","none"),$(".blackMask").css("opacity","0"))};
ShiftPlanning.prototype.loadSubPage=function(a,b,c){if("logout"==c)return this.staff.logout(),!1;$(".subNavigation").show();""==$.trim(c)&&(c=$(".subNav[page="+b+"] li:first a").attr("subpage"));"staff"==b&&"details"==c&&(c="list");""!=a&&(a.parent().parent().find("li").removeClass("active"),a.parent().addClass("active"));$(".subNavigation > div").hide();$(".subNavigation > div."+b).show();$("#pages > div").hide();$("#pages #"+b+" .main").hide();$("#pages #"+b+" .mainSub").hide();$("#pages #"+b).show();
$("#pages #"+b+" .main."+c).show();$("#pages #"+b+" .mainSub."+c).show();$("#menu .mainNav > li").removeClass("active");$("#menu_"+b).addClass("active");0<$(".subNav[page="+b+"] li a[subpage="+c+"]").length&&($(".subNav[page="+b+"] li").removeClass("active"),$(".subNav[page="+b+"] li a[subpage="+c+"]").parent().addClass("active"),sp.hash(b+"/"+c));"undefined"!=typeof this[b]&&"loadSubPageEvents"in this[b]&&this[b].loadSubPageEvents(c);sp.fixCheckboxes();"schedule"==b&&"addShift"==c||$(window).scrollTop(0)};
ShiftPlanning.prototype.initialize=function(){var a=this;$(window).hashchange(function(){if(!1==sp.hashChange)return sp.hashChange=!0,!1;if(0<sp.hash().length){var b=sp.hash(),c=!1,d=sp.hash().search("/");0<=d&&(b=sp.hash().substring(0,d),c=sp.hash().substring(d+1));if("logout"==b)return a.staff.logout(),!1;0<$("#menu [page="+b+"]").length?($("#pages > div").hide(),setTimeout(function(){$("#menu [page="+b+"]").parent().parent().find("li").removeClass("active");$("#menu [page="+b+"]").parent().addClass("active");
c?a.loadSubPage("",b,c):a.loadPage(b)},50)):"login"!=b&&"logout"!=b?user.loggedIn?a.hash("dashboard"):a.hash("login"):("logout"==a.hash()&&user.loggedIn&&a.staff.logout(),"login"==a.hash()&&user.loggedIn&&a.hash("dashboard"))}});$(document).ready(function(){init();$(".toggleMenu").bind(clickEvent,function(b){b.stopPropagation();b.preventDefault();a.toggleMenu()});user.loggedIn?($(".loginContainer").hide(),$("body").removeClass("login"),$("html").css("height","auto"),$(".applicationContainer").show(),
(0==sp.hash().length||"login"==sp.hash())&&sp.hash("dashboard")):($(".loginContainer").show(),$("body").addClass("login"),sp.hash("login"),$("#lo_u").focus());$("#wrapper .subNavigation .subNav:not(.notMain) a").bind(clickEvent,function(b){b.preventDefault();a.loadSubPage($(this),$(this).parent().parent().attr("page"),$(this).attr("subpage"))});$("#menu .mainNav > li > a").bind(clickEvent,function(b){if($(this).hasClass("exit"))return!0;b.preventDefault();var b=sp.hash(),c=sp.hash().search("/");0<=
c&&(b=sp.hash().substring(0,c));if($(this).attr("page")==b)return a.toggleMenu(),!1;$("#wrapper").hasClass("extended")&&a.toggleMenu();sp.hashChange=!0;b=$(this).attr("page");c=$(".subNav[page="+b+"] li:first a").attr("subpage");sp.hash(b+"/"+c)});$(window).hashchange();setInterval(function(){$("#menu").css("height",a.calculateMenuHeight());var b=a.calculateMenuHeight();$("#wrapper").css("min-height",b>a.calculateWrapperHeight()?b:a.calculateWrapperHeight());"0"==$(".blackMask").css("opacity")&&$(".blackMask").hide()},
1E3);$("#wrapper").width($(window).width());$("body").width($(window).width());$(".userName").bind(clickEvent,function(){sp.loadSubPage("","settings","overview")});isAndroid&&$("#da_up_fi_hide").hide()});$(window).bind("resize",function(){$("#wrapper").width($(window).width());$("body").width($(window).width())})};ShiftPlanning.prototype.calculateWrapperHeight=function(){var a=$("#pages").height()+$(".subNavigation").height()+20;return $(window).height()>a?$(window).height():a};
ShiftPlanning.prototype.calculateMenuHeight=function(){var a=this.calculateWrapperHeight();return $("#menu .mainNav").height()+150>a?$("#menu .mainNav").height()+150:a};ShiftPlanning.prototype.globalLoader=function(){};ShiftPlanning.prototype.fixCheckboxes=function(){$("#pages .checkbox:visible").removeClass("failsafe");$("#pages .checkbox:visible").each(function(){45<$(this).outerHeight(!0)&&$(this).addClass("failsafe")})};
ShiftPlanning.prototype.showSuccess=function(a){$("body").append('<div class="notification success hidden">'+a+"</div>");$("body > .notification").css("top",$(document).scrollTop());$("body > .notification").fadeIn("fast",function(){setTimeout(function(){$("body > .notification").fadeOut("fast",function(){$("body > .notification").remove()})},2E3)})};
ShiftPlanning.prototype.showError=function(a){$("body").append('<div class="notification error hidden">'+a+"</div>");$("body > .notification").css("top",$(document).scrollTop());$("body > .notification").fadeIn("fast",function(){setTimeout(function(){$("body > .notification").fadeOut("fast",function(){$("body > .notification").remove()})},2E3)})};
function callAndroid(a,b){return"undefined"!=typeof Android?("undefined"!=typeof a&&(a="showToast"),Android[a](function(a){if("undefined"!=typeof b)b(a);else return a})):!1}var sp=new ShiftPlanning;ShiftPlanning.prototype.staff=new ShiftPlanningStaff;ShiftPlanning.prototype.schedule=new ShiftPlanningSchedule;ShiftPlanning.prototype.dashboard=new ShiftPlanningDashboard;ShiftPlanning.prototype.timeClock=new ShiftPlanningTimeClock;ShiftPlanning.prototype.reports=new ShiftPlanningReports;
ShiftPlanning.prototype.requests=new ShiftPlanningRequests;ShiftPlanning.prototype.location=new ShiftPlanningLocation;ShiftPlanning.prototype.permissions=new ShiftPlanningPermissions;ShiftPlanning.prototype.training=new ShiftPlanningTraining;ShiftPlanning.prototype.settings=new ShiftPlanningSettings;
